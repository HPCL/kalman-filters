/*
 * linear_algebra.c
 * simple code for matrix funcitons
 * many of the functions in this "library" are in the various subdirs for tuning purposes
 
 * Brian J Gravelle
 * ix.cs.uoregon.edu/~gravelle
 * gravelle@cs.uoregon.edu

 * See LICENSE file for licensing information and boring legal stuff

 * If by some miricale you find this software useful, thanks are accepted in
 * the form of chocolate, coffee, or introductions to potential employers.

*/

#include "../linear_algebra.h"
#include <math.h>


void print_matrix(TYPE* mat_a, int rows_a, int cols_a) {

  int i, j;

  for (i = 0; i < rows_a; i++) {
    for (j = 0; j < cols_a; j++) {
      printf("%.4f ", mat_a[i * cols_a + j]);
    }
    printf("\n\n");
  }
}


//get inverse matrix
//pre matrix a has been created and filled with data
//     matrices must be square and the same size
//params mat_a - matrix to invert
//        n -  the matrix side size
//post mat_c has the inverse matrix of mat_a
//TODO clean up and use a better algo
void invert_matrix(TYPE* mat_a, int n, TYPE* mat_c) {

  TYPE cofactor[n*n];
  TYPE adjoint[n*n];
  TYPE det;

  if (n == 1) {
    mat_c[0] = 1 / mat_a[0];

  } else {
    det = determinant_matrix(mat_a, n);
    det = 1 / det;
    // if( isnan(det) )
    // {
    //   printf("\n\nERROR NAN\n");
    //   print_matrix(mat_a, n, n);
    //   printf("\n\n");
    // }
    cofactor_matrix(mat_a, n, cofactor);
    transpose_matrix(cofactor, n, n, adjoint);
    multiply_matrix_by_scalar(adjoint, n, n, det, mat_c);
  }
}

//get matrix determinant recursively
//pre matrix a has been created and filled with data
//     matrix must be square
//params mat_a - matrix to invert
//        n -  the matrix side size
//returms determinant of matrix a
TYPE determinant_matrix_recur(TYPE* mat_a, int n) {

  TYPE det = 0;
  int i, j, k, skip;
  int n_b = n-1;
  int size_b = (n-1) * (n-1);
  int size_a = n * n;
  int sign = 1;
  TYPE mat_b[size_b];

  if(n == 2) {
    det = (mat_a[0] * mat_a[3]) - (mat_a[1] * mat_a[2]);

  } else {

    for (i = 0; i < n; i++) {

      if(mat_a[i] != 0){
        k = 0;
        skip = i + n;

        for(j = n; j < size_a; j++) {
          if(j != skip)
            mat_b[k++] = mat_a[j];
          else
            skip += n;
        }

        det += sign * mat_a[i] * determinant_matrix(mat_b, n_b);
      } // if mat_a[i] != 0
      
      sign = sign * -1;
    } // for loop

  } //else 

  return det;
}

//set a matrix to zero
//pre matrix_a has been allocated to rows_a x cols_a
//post mat_a is all zeros
void set_zero(TYPE* mat_a, int rows_a, int cols_a) {
  int i, j;
  int a_row;

  for (i = 0; i < rows_a; i++) {
    a_row = cols_a * i;
    for (j = 0; j < cols_a; j++) {
      mat_a[a_row + j] = 0;
    }
  }
}

//set a matrix to the identity
//pre matrix_a has been allocated to rows_a x cols_a
//post mat_a has ones in the diagonal and zeros elsewhere
void set_identity(TYPE* mat_a, int rows_a, int cols_a) {
  int i, j;
  int a_row;

  for (i = 0; i < rows_a; i++) {
    a_row = cols_a * i;
    for (j = 0; j < cols_a; j++) {
      mat_a[a_row + j] = (double)(i == j);
    }
  }
}


//deep copy of a to b
void copy_mat(TYPE* mat_a, TYPE* mat_c, int total_elms) {
  int i;
  for (i = 0; i < total_elms; i++)
    mat_c[i] = mat_a[i];
}

//returns abs(a)
//TODO make a macro?
TYPE get_abs(TYPE a) {
  return (((a < 0) * -2) + 1) * a;
  
  // return (a < 0) ? -a : a;

}
void add_matrix(TYPE* mat_a, int rows, int cols, TYPE* mat_b, TYPE* mat_c)  {

/*@ begin PerfTuning (

 def build {
   arg build_command = 'icc';
   #arg libs = '-lrt';  # Only needed on linux
 } 

 def performance_counter {
   arg repetitions = 5;
 }

 def performance_params {  
  param U_I[] = range(1,6);
  param U_J[] = range(1,6);

  param RT1_I[] = [1,2,6];
  param RT1_J[] = [1,2,6];

  param VEC[] = [False,True];

  param CFLAGS[] = ['-O1', '-O2', '-O3'];
  constraint unroll_limit = ((U_I == 1) or (U_J == 1));

  constraint reg_capacity_1 = (RT1_I*RT1_J <= 150);
 }
 
 def input_params {
  let N = [6];
  param rows[] = N;
  param cols[] = N;
 }
 
 def input_vars {
   decl dynamic double mat_a[rows*cols] = random;
   decl dynamic double mat_b[rows*cols] = random;
   decl dynamic double mat_c[rows*cols] = 0;
 }
 
 def search {
   arg algorithm = 'Exhaustive';
 }

) @*/
/**-- (Generated by Orio) 
Best performance cost: 
  [8.76e-07, 2.59e-07, 1.88e-07, 1.85e-07, 1.85e-07] 
Tuned for specific problem sizes: 
  cols = 6 
  rows = 6 
Best performance parameters: 
  CFLAGS = -O2 
  RT1_I = 6 
  RT1_J = 1 
  U_I = 5 
  U_J = 1 
  VEC = True 
--**/


int i, j;
int it, jt;

/*@ begin Loop (  
  transform Composite(
    unrolljam = (['i','j'],[U_I,U_J]),
    vector = (VEC, ['ivdep','vector always']),
    regtile = (['i','j'],[RT1_I,RT1_J])
)
  for (i = 0; i <= rows-1; i++) {
    for (j = 0; j <= cols-1; j++) {
      mat_c[ cols * i + j] = mat_a[ cols * i + j] + mat_b[ cols * i + j];
    }
  }
) @*/
{
  for (it=0; it<=rows-6; it=it+6) {
    register int cbv_1;
    cbv_1=cols-1;
#pragma ivdep
#pragma vector always
    for (j=0; j<=cbv_1; j++ ) {
      mat_c[cols*it+j]=mat_a[cols*it+j]+mat_b[cols*it+j];
      mat_c[cols*(it+1)+j]=mat_a[cols*(it+1)+j]+mat_b[cols*(it+1)+j];
      mat_c[cols*(it+2)+j]=mat_a[cols*(it+2)+j]+mat_b[cols*(it+2)+j];
      mat_c[cols*(it+3)+j]=mat_a[cols*(it+3)+j]+mat_b[cols*(it+3)+j];
      mat_c[cols*(it+4)+j]=mat_a[cols*(it+4)+j]+mat_b[cols*(it+4)+j];
      mat_c[cols*(it+5)+j]=mat_a[cols*(it+5)+j]+mat_b[cols*(it+5)+j];
    }
  }
  {
    int i;
    for (i=it; i<=rows-5; i=i+5) {
      register int cbv_2;
      cbv_2=cols-1;
#pragma ivdep
#pragma vector always
      for (j=0; j<=cbv_2; j++ ) {
        mat_c[cols*i+j]=mat_a[cols*i+j]+mat_b[cols*i+j];
        mat_c[cols*(i+1)+j]=mat_a[cols*(i+1)+j]+mat_b[cols*(i+1)+j];
        mat_c[cols*(i+2)+j]=mat_a[cols*(i+2)+j]+mat_b[cols*(i+2)+j];
        mat_c[cols*(i+3)+j]=mat_a[cols*(i+3)+j]+mat_b[cols*(i+3)+j];
        mat_c[cols*(i+4)+j]=mat_a[cols*(i+4)+j]+mat_b[cols*(i+4)+j];
      }
    }
    for (i=rows-((rows-(it))%5); i<=rows-1; i=i+1) {
      register int cbv_3;
      cbv_3=cols-1;
#pragma ivdep
#pragma vector always
      for (j=0; j<=cbv_3; j++ ) {
        mat_c[cols*i+j]=mat_a[cols*i+j]+mat_b[cols*i+j];
      }
    }
  }
}
/*@ end @*/
/*@ end @*/

}
// not tuned yet

void cofactor_matrix(TYPE* mat_a, int n, TYPE* mat_c) {


  /* begin PerfTuning (

    def build {
      arg build_command = 'gcc';
      #arg libs = '-lrt';  # Only needed on linux
    } 

    def performance_counter {
      arg repetitions = 5;
    }

    def performance_params {  
      param U_I[] = range(1,31);
      param U_J[] = range(1,31);
      param U_R[] = range(1,31);

      param VEC[] = [False,True];

      param CFLAGS[] = ['-O0', '-O1', '-O2', '-O3'];

    }

    def input_params {
      let N = [10, 20];
      param n[] = N;
    }

    def input_vars {
      decl dynamic double mat_a[n*n] = random;
      decl dynamic double mat_c[n*n] = 0;
    }

    def search {
      arg algorithm = 'Exhaustive';
    }

  ) */

  TYPE det = 0;
  int i, j, r, c, k, row, rr;
  int n_b = n-1;
  int size_b = (n-1) * (n-1);
  int size_a = n * n;
  int sign = 1;
  TYPE mat_b[size_b];



  /* begin Loop (  
  transform Composite(
    unrolljam = (['i','j','r'],[U_I,U_J,U_R]),
    vector = (VEC, ['ivdep','vector always'])
  )
  for (i = 0; i <= n-1; i++) {
    row = n * i;
    for (j = 0; j <= n-1; j++) {

        k = 0;
        for (r = 0; r <= n-1; r++) {
          if(r != i){
            rr = n * r;
            for (c = 0; c <= n-1; c++) {
              if(c != j) mat_b[k++] = mat_a[rr + c];
            }
          }
        }

      det = determinant_matrix(mat_b, n_b);
      mat_c[row + j] = sign * det;
      sign = sign * -1;
    }
    sign = sign * -1;
  }
  ) */

  for (i = 0; i <= n-1; i++) {
    row = n * i;
    for (j = 0; j <= n-1; j++) {

        k = 0;
        for (r = 0; r <= n-1; r++) {
          if(r != i){
            rr = n * r;
            for (c = 0; c <= n-1; c++) {
              if(c != j) mat_b[k++] = mat_a[rr + c];
            }
          }
        }

      det = determinant_matrix(mat_b, n_b);
      mat_c[row + j] = sign * det;
      sign = sign * -1;
    }
    sign = sign * -1;
  }


/* end @*/
/* end @*/

}



int compute_LUP(TYPE* mat_a, TYPE* L, TYPE* U, TYPE* P, int n) {
 

  /*@ begin PerfTuning (

    def build {
      arg build_command = 'icc';
      #arg libs = '-lrt';  # Only needed on linux
    } 

    def performance_counter {
      arg repetitions = 5;
    }

    def performance_params {  
      param U_I[] = range(1,6);
      param U_J[] = range(1,6);
      param U_K[] = range(1,6);

      param U_I2[] = range(1,6);

      param U_I3[] = range(1,6);
      param U_J3[] = range(1,6);

      param U_I5[] = range(1,6);
      param U_J5[] = range(1,6);

      param RT1_I[] = [1,2,6];
      param RT1_J[] = [1,2,6];
      param RT1_K[] = [1,2,6];

      param RT2_I[] = [1,2,6];

      param RT3_I[] = [1,2,6];
      param RT3_J[] = [1,2,6];

      param RT4_I[] = [1,2,6];
      param RT4_J[] = [1,2,6];

      param RT5_I[] = [1,2,6];
      param RT5_J[] = [1,2,6];

      param VEC[] = [False,True];

      param CFLAGS[] = ['-O1', '-O2', '-O3'];

      constraint unroll_limit = ((U_I == 1) or (U_J == 1));
      constraint unroll_limit_3 = ((U_I3 == 1) or (U_J3 == 1));
      constraint unroll_limit_5 = ((U_I5 == 1) or (U_J5 == 1));

      constraint reg_capacity_1 = (RT1_I*RT1_J*RT1_K <= 150);
      constraint reg_capacity_3 = (RT3_I*RT3_J <= 150);
      constraint reg_capacity_5 = (RT5_I*RT5_J <= 150);

    }

    def input_params {
      let N = [6];
      param n[] = N;
    }

    def input_vars {
      decl dynamic double mat_a[n*n] = random;
      decl dynamic double L[n*n] = 0;
      decl dynamic double U[n*n] = 0;
      decl dynamic double P[n*n] = 0;
    }

    def search {
      arg algorithm = 'Randomsearch';
      arg total_runs  = 100000;
    }

  ) @*/
/**-- (Generated by Orio) 
Best performance cost: 
  [1.836e-06, 7.95e-07, 4.76e-07, 4.6e-07, 4.54e-07] 
Tuned for specific problem sizes: 
  n = 6 
Best performance parameters: 
  CFLAGS = -O2 
  RT1_I = 1 
  RT1_J = 6 
  RT1_K = 6 
  RT2_I = 2 
  RT3_I = 6 
  RT3_J = 1 
  RT4_I = 6 
  RT4_J = 6 
  RT5_I = 6 
  RT5_J = 2 
  U_I = 4 
  U_I2 = 3 
  U_I3 = 4 
  U_I5 = 1 
  U_J = 1 
  U_J3 = 1 
  U_J5 = 2 
  U_K = 4 
  VEC = True 
--**/



  int i2, j2, k2;
  int i, j, k, ind_max;
  int it, i2t, jt, j2t, kt, k2t;
  int ii, jj, kk;
  int iii, jjj, kkk;

  int cnt_pivots = 0;
  int size_a = n*n;
  double tolerance = 5E-300;
  double max_a, abs_a, coeff;
  // double temp_row[n];
  double scalar_1, scalar_2;

  
  /*@ begin Loop ( 

  transform Composite(
    unrolljam = (['i2','j2'],[U_I3,U_J3]),
    regtile = (['i2','j2'],[RT3_I,RT3_J])
  )
  for (i2 = 0; i2 <= n-1; i2++) {
    for (j2 = 0; j2 <= n-1; j2++) {
      if(i2 == j2) {
        P[n * i2 + j2] = 1;
        L[n * i2 + j2] = 1;
      } else {
        P[n * i2 + j2] = 0;
        L[n * i2 + j2] = 0;
      }
    }
  }

  transform Composite(
    unrolljam = (['i2'],[U_I2]),
    regtile = (['i2'],[RT2_I])
  )
  for (i2 = 0; i2 <= size_a-1; i2++) {
    U[i2] = mat_a[i2];
  }



  for (i = 0; i <= n-1; i++) {
    if(U[i * n + i] > 0) max_a = U[i * n + i]; 
    else max_a = 0 - U[i * n + i];
    ind_max = i;

    transform Composite(
      unrolljam = (['j'],[U_J]),
      regtile = (['j'],[RT1_J])
    )
    for (j = i+1; j <= n-1; j++) {
      if(U[j * n + i] > 0) abs_a = U[j * n + i]; 
      else abs_a = 0 - U[j * n + i];
      if (abs_a > max_a) {
        max_a = abs_a;
        ind_max = j;
      }
    }
    
    if (max_a <= tolerance) {
      cnt_pivots = 0 - 1;
      break;
    }


    if (ind_max == i){}
    else {
      cnt_pivots++;

      transform Composite(
        unrolljam = (['k'],[U_K]),
        regtile = (['k'],[RT1_K])
      )
      for (k = 0; k <= n-1; k++){
        scalar_1 = P[i * n+k];
        P[i * n+k] = P[ind_max * n+k];
        P[ind_max * n+k] = scalar_1;
      
        scalar_2 = U[i * n+k];
        U[i * n+k] = U[ind_max * n+k];
        U[ind_max * n+k] = scalar_2;
      }
    }

    transform Composite(
      unrolljam = (['i','j'],[U_I5,U_J5]),
      regtile = (['i','j'],[RT5_I,RT5_J]),
      vector = (VEC, ['ivdep','vector always'])
    )
    for(j = i+1; j <= n-1; j++) {
      coeff = (U[j * n+i]/U[i * n+i]);
      L[j * n+i] = coeff;
      for (k = i; k <= n-1; k++) {
        U[j * n + k] -= coeff * U[i * n + k];
      }
    }

  } //end main for



) @*/
  {
    for (i2t=0; i2t<=n-6; i2t=i2t+6) {
      for (j2=0; j2<=n-1; j2++ ) {
        if (i2t==j2) {
          P[n*i2t+j2]=1;
          L[n*i2t+j2]=1;
        } else {
          P[n*i2t+j2]=0;
          L[n*i2t+j2]=0;
        }
        if ((i2t+1)==j2) {
          P[n*(i2t+1)+j2]=1;
          L[n*(i2t+1)+j2]=1;
        } else {
          P[n*(i2t+1)+j2]=0;
          L[n*(i2t+1)+j2]=0;
        }
        if ((i2t+2)==j2) {
          P[n*(i2t+2)+j2]=1;
          L[n*(i2t+2)+j2]=1;
        } else {
          P[n*(i2t+2)+j2]=0;
          L[n*(i2t+2)+j2]=0;
        }
        if ((i2t+3)==j2) {
          P[n*(i2t+3)+j2]=1;
          L[n*(i2t+3)+j2]=1;
        } else {
          P[n*(i2t+3)+j2]=0;
          L[n*(i2t+3)+j2]=0;
        }
        if ((i2t+4)==j2) {
          P[n*(i2t+4)+j2]=1;
          L[n*(i2t+4)+j2]=1;
        } else {
          P[n*(i2t+4)+j2]=0;
          L[n*(i2t+4)+j2]=0;
        }
        if ((i2t+5)==j2) {
          P[n*(i2t+5)+j2]=1;
          L[n*(i2t+5)+j2]=1;
        } else {
          P[n*(i2t+5)+j2]=0;
          L[n*(i2t+5)+j2]=0;
        }
      }
    }
    {
      int i2;
      for (i2=i2t; i2<=n-4; i2=i2+4) {
        for (j2=0; j2<=n-1; j2++ ) {
          if (i2==j2) {
            P[n*i2+j2]=1;
            L[n*i2+j2]=1;
          } else {
            P[n*i2+j2]=0;
            L[n*i2+j2]=0;
          }
          if ((i2+1)==j2) {
            P[n*(i2+1)+j2]=1;
            L[n*(i2+1)+j2]=1;
          } else {
            P[n*(i2+1)+j2]=0;
            L[n*(i2+1)+j2]=0;
          }
          if ((i2+2)==j2) {
            P[n*(i2+2)+j2]=1;
            L[n*(i2+2)+j2]=1;
          } else {
            P[n*(i2+2)+j2]=0;
            L[n*(i2+2)+j2]=0;
          }
          if ((i2+3)==j2) {
            P[n*(i2+3)+j2]=1;
            L[n*(i2+3)+j2]=1;
          } else {
            P[n*(i2+3)+j2]=0;
            L[n*(i2+3)+j2]=0;
          }
        }
      }
      for (i2=n-((n-(i2t))%4); i2<=n-1; i2=i2+1) 
        for (j2=0; j2<=n-1; j2++ ) {
          if (i2==j2) {
            P[n*i2+j2]=1;
            L[n*i2+j2]=1;
          } else {
            P[n*i2+j2]=0;
            L[n*i2+j2]=0;
          }
        }
    }
  }
  {
    for (i2t=0; i2t<=size_a-2; i2t=i2t+2) {
      U[i2t]=mat_a[i2t];
      U[(i2t+1)]=mat_a[(i2t+1)];
    }
    {
      int i2;
      for (i2=i2t; i2<=size_a-3; i2=i2+3) {
        U[i2]=mat_a[i2];
        U[(i2+1)]=mat_a[(i2+1)];
        U[(i2+2)]=mat_a[(i2+2)];
      }
      for (i2=size_a-((size_a-(i2t))%3); i2<=size_a-1; i2=i2+1) 
        U[i2]=mat_a[i2];
    }
  }
  for (i=0; i<=n-1; i++ ) {
    if (U[i*n+i]>0) 
      max_a=U[i*n+i];
    else 
      max_a=0-U[i*n+i];
    ind_max=i;
    {
      for (jt=i+1; jt<=n-6; jt=jt+6) {
        if (U[jt*n+i]>0) 
          abs_a=U[jt*n+i];
        else 
          abs_a=0-U[jt*n+i];
        if (abs_a>max_a) {
          max_a=abs_a;
          ind_max=jt;
          max_a=abs_a;
          ind_max=(jt+1);
          max_a=abs_a;
          ind_max=(jt+2);
          max_a=abs_a;
          ind_max=(jt+3);
          max_a=abs_a;
          ind_max=(jt+4);
          max_a=abs_a;
          ind_max=(jt+5);
        }
      }
      for (j=jt; j<=n-1; j=j+1) {
        if (U[j*n+i]>0) 
          abs_a=U[j*n+i];
        else 
          abs_a=0-U[j*n+i];
        if (abs_a>max_a) {
          max_a=abs_a;
          ind_max=j;
        }
      }
    }
    if (max_a<=tolerance) {
      cnt_pivots=0-1;
      break;
    }
    if (ind_max==i) {
    } else {
      cnt_pivots++ ;
      {
        for (kt=0; kt<=n-6; kt=kt+6) {
          scalar_1=P[i*n+kt];
          P[i*n+kt]=P[ind_max*n+kt];
          P[ind_max*n+kt]=scalar_1;
          scalar_2=U[i*n+kt];
          U[i*n+kt]=U[ind_max*n+kt];
          U[ind_max*n+kt]=scalar_2;
          scalar_1=P[i*n+(kt+1)];
          P[i*n+(kt+1)]=P[ind_max*n+(kt+1)];
          P[ind_max*n+(kt+1)]=scalar_1;
          scalar_2=U[i*n+(kt+1)];
          U[i*n+(kt+1)]=U[ind_max*n+(kt+1)];
          U[ind_max*n+(kt+1)]=scalar_2;
          scalar_1=P[i*n+(kt+2)];
          P[i*n+(kt+2)]=P[ind_max*n+(kt+2)];
          P[ind_max*n+(kt+2)]=scalar_1;
          scalar_2=U[i*n+(kt+2)];
          U[i*n+(kt+2)]=U[ind_max*n+(kt+2)];
          U[ind_max*n+(kt+2)]=scalar_2;
          scalar_1=P[i*n+(kt+3)];
          P[i*n+(kt+3)]=P[ind_max*n+(kt+3)];
          P[ind_max*n+(kt+3)]=scalar_1;
          scalar_2=U[i*n+(kt+3)];
          U[i*n+(kt+3)]=U[ind_max*n+(kt+3)];
          U[ind_max*n+(kt+3)]=scalar_2;
          scalar_1=P[i*n+(kt+4)];
          P[i*n+(kt+4)]=P[ind_max*n+(kt+4)];
          P[ind_max*n+(kt+4)]=scalar_1;
          scalar_2=U[i*n+(kt+4)];
          U[i*n+(kt+4)]=U[ind_max*n+(kt+4)];
          U[ind_max*n+(kt+4)]=scalar_2;
          scalar_1=P[i*n+(kt+5)];
          P[i*n+(kt+5)]=P[ind_max*n+(kt+5)];
          P[ind_max*n+(kt+5)]=scalar_1;
          scalar_2=U[i*n+(kt+5)];
          U[i*n+(kt+5)]=U[ind_max*n+(kt+5)];
          U[ind_max*n+(kt+5)]=scalar_2;
        }
        {
          int k;
          for (k=kt; k<=n-4; k=k+4) {
            scalar_1=P[i*n+k];
            P[i*n+k]=P[ind_max*n+k];
            P[ind_max*n+k]=scalar_1;
            scalar_2=U[i*n+k];
            U[i*n+k]=U[ind_max*n+k];
            U[ind_max*n+k]=scalar_2;
            scalar_1=P[i*n+k+1];
            P[i*n+k+1]=P[ind_max*n+k+1];
            P[ind_max*n+k+1]=scalar_1;
            scalar_2=U[i*n+k+1];
            U[i*n+k+1]=U[ind_max*n+k+1];
            U[ind_max*n+k+1]=scalar_2;
            scalar_1=P[i*n+k+2];
            P[i*n+k+2]=P[ind_max*n+k+2];
            P[ind_max*n+k+2]=scalar_1;
            scalar_2=U[i*n+k+2];
            U[i*n+k+2]=U[ind_max*n+k+2];
            U[ind_max*n+k+2]=scalar_2;
            scalar_1=P[i*n+k+3];
            P[i*n+k+3]=P[ind_max*n+k+3];
            P[ind_max*n+k+3]=scalar_1;
            scalar_2=U[i*n+k+3];
            U[i*n+k+3]=U[ind_max*n+k+3];
            U[ind_max*n+k+3]=scalar_2;
          }
          for (k=n-((n-(kt))%4); k<=n-1; k=k+1) {
            scalar_1=P[i*n+k];
            P[i*n+k]=P[ind_max*n+k];
            P[ind_max*n+k]=scalar_1;
            scalar_2=U[i*n+k];
            U[i*n+k]=U[ind_max*n+k];
            U[ind_max*n+k]=scalar_2;
          }
        }
      }
    }
    {
      for (jt=i+1; jt<=n-2; jt=jt+2) {
        coeff=(U[jt*n+i]/U[i*n+i]);
        L[jt*n+i]=coeff;
        register int cbv_1;
        cbv_1=n-1;
#pragma ivdep
#pragma vector always
        for (k=i; k<=cbv_1; k++ ) {
          U[jt*n+k]=U[jt*n+k]-coeff*U[i*n+k];
          U[(jt+1)*n+k]=U[(jt+1)*n+k]-coeff*U[i*n+k];
        }
      }
      {
        int j;
        for (j=jt; j<=n-2; j=j+2) {
          coeff=(U[j*n+i]/U[i*n+i]);
          coeff=(U[(j+1)*n+i]/U[i*n+i]);
          L[j*n+i]=coeff;
          L[(j+1)*n+i]=coeff;
          register int cbv_2;
          cbv_2=n-1;
#pragma ivdep
#pragma vector always
          for (k=i; k<=cbv_2; k++ ) {
            U[j*n+k]=U[j*n+k]-coeff*U[i*n+k];
            U[(j+1)*n+k]=U[(j+1)*n+k]-coeff*U[i*n+k];
          }
        }
        for (j=n-((n-(jt))%2); j<=n-1; j=j+1) {
          coeff=(U[j*n+i]/U[i*n+i]);
          L[j*n+i]=coeff;
          register int cbv_3;
          cbv_3=n-1;
#pragma ivdep
#pragma vector always
          for (k=i; k<=cbv_3; k++ ) {
            U[j*n+k]=U[j*n+k]-coeff*U[i*n+k];
          }
        }
      }
    }
  }
  /*//end main for*/
/*@ end @*/
/*@ end @*/



  for (i2 = 0; i2 <= n-1; i2++) {
    for (j2 = 0; j2 <= n-1; j2++) {
      if(i2 == j2) {
        P[n * i2 + j2] = 1;
        L[n * i2 + j2] = 1;
      } else {
        P[n * i2 + j2] = 0;
        L[n * i2 + j2] = 0;
      }
    }
  }


  for (i2 = 0; i2 <= size_a-1; i2++) {
    U[i2] = mat_a[i2];
  }

  for (i = 0; i <= n-1; i++) {
    if(U[i * n + i] > 0) max_a = U[i * n + i]; 
    else max_a = 0 - U[i * n + i];
    ind_max = i;


    for (j = i+1; j <= n-1; j++) {
      if(U[j * n + i] > 0) abs_a = U[j * n + i]; 
      else abs_a = 0 - U[j * n + i];
      if (abs_a > max_a) {
        max_a = abs_a;
        ind_max = j;
      }
    }
    
    if (max_a <= tolerance) {
      cnt_pivots = 0 - 1;
      break;
    }


    if ( !(ind_max == i) )  {
      cnt_pivots++;

      for (k = 0; k <= n-1; k++){
        scalar_1 = P[i * n+k];
        P[i * n+k] = P[ind_max * n+k];
        P[ind_max * n+k] = scalar_1;
      
        scalar_2 = U[i * n+k];
        U[i * n+k] = U[ind_max * n+k];
        U[ind_max * n+k] = scalar_2;
      }
    }

    for(j = i+1; j <= n-1; j++) {
      coeff = (U[j * n+i]/U[i * n+i]);
      L[j * n+i] = coeff;
      for (k = i; k <= n-1; k++) {
        U[j * n + k] -= coeff * U[i * n + k];
      }
    }

  } //end main for

  return cnt_pivots;


}

// currently not tuned because of function calls


double determinant_matrix(double* mat_a, int n) {


  /* begin PerfTuning (

    def build {
      arg build_command = 'gcc';
      #arg libs = '-lrt';  # Only needed on linux
    } 

    def performance_counter {
      arg repetitions = 5;
    }

    def performance_params {  
      param U_I[] = range(1,31);

      param VEC[] = [False,True];

      param CFLAGS[] = ['-O0', '-O1', '-O2', '-O3'];

    }

    def input_params {
      let N = [10, 20];
      param n[] = N;
    }

    def input_vars {
      decl dynamic double mat_a[n*n] = random;
    }

    def search {
      arg algorithm = 'Exhaustive';
    }

  ) */


  double det = 1.0;

  int i, num_pivots;
  int size_a = n * n;

  double L[size_a];
  double U[size_a];
  double P[size_a];
  
  num_pivots = compute_LUP(mat_a, L, U, P, n);

  if(num_pivots == -1) return 0;
  
  det = (num_pivots%2) == 1 ? -1.0 : 1.0;


  /* begin Loop (  
    transform Composite(
      unrolljam = (['i'],[U_I]),
      vector = (VEC, ['ivdep','vector always'])
    )
    for (i = 0; i <= n-1; i++) {
      det *= U[i*n+i];
    }
  ) */

  for (i = 0; i <= n-1; i++) {
    det *= U[i*n+i];
  }
  

/* end @*/
/* end @*/

  return det;
}



void multiply_matrix(TYPE* mat_a, int rows_a, int cols_a, 
                     TYPE* mat_b, int cols_b, 
                     TYPE* mat_c) {


  /*@ begin PerfTuning (

    def build {
      arg build_command = 'icc';
      #arg libs = '-lrt';  # Only needed on linux
    } 

    def performance_counter {
      arg repetitions = 5;
    }

    def performance_params {  
      param U_I0[] = range(1,6);
      param U_J0[] = range(1,6);
      param U_I[] = range(1,6);
      param U_J[] = range(1,6);
      param U_K[] = range(1,6);

      param VEC[] = [False,True];

      param RT0_I[] = [1,2,6];
      param RT0_J[] = [1,2,6];
      param RT1_I[] = [1,2,6];
      param RT1_J[] = [1,2,6];
      param RT1_K[] = [1,2,6];

      param CFLAGS[] = ['-O1', '-O2', '-O3'];
      constraint unroll_limit_0 = ((U_I == 1) or (U_J == 1));
      constraint reg_capacity_0 = (RT1_I*RT1_J <= 150);
      constraint unroll_limit = ((U_I == 1) or (U_J == 1) or (U_K == 1));
      constraint reg_capacity_1 = (RT1_I*RT1_J*RT1_K <= 150);

    }

    def input_params {
      let N = [6, 12];
      param rows_a[] = N;
      param cols_a[] = N;
      param cols_b[] = N;
    }

    def input_vars {
      decl dynamic double mat_a[rows_a*cols_a] = random;
      decl dynamic double mat_b[cols_b*cols_b] = random;
      decl dynamic double mat_c[rows_a*cols_b] = 0;
    }

    def search {
      arg algorithm = 'Randomsearch';
      arg total_runs  = 100000;
    }

  ) @*/
  if ((rows_a<=6) && (cols_a<=6) && (cols_b<=6)) {

/**-- (Generated by Orio) 
Best performance cost: 
  [1.209e-06, 4.52e-07, 3.71e-07, 3.69e-07, 3.68e-07] 
Tuned for specific problem sizes: 
  cols_a = 6 
  cols_b = 6 
  rows_a = 6 
Best performance parameters: 
  CFLAGS = -O1 
  RT0_I = 6 
  RT0_J = 2 
  RT1_I = 1 
  RT1_J = 2 
  RT1_K = 6 
  U_I = 1 
  U_I0 = 2 
  U_J = 1 
  U_J0 = 3 
  U_K = 3 
  VEC = True 
--**/


  int i, j, k;  
  int it,jt, kt;
  int c_ind, a_row, c_row;


  /*@ begin Loop (  
    transform Composite(
      unrolljam = (['i','j'],[U_I0,U_J0]),
      vector = (VEC, ['ivdep','vector always']),
      regtile = (['i','j'],[RT0_I,RT0_J])
    )
    for (i = 0; i <= rows_a-1; i++) {
      for (j = 0; j <= cols_b-1; j++) {
        mat_c[j + cols_b * i] = 0;
      }
    } 

    transform Composite(
      unrolljam = (['i','j','k'],[U_I,U_J,U_K]),
      vector = (VEC, ['ivdep','vector always']),
      regtile = (['i','j','k'],[RT1_I,RT1_J,RT1_K])
    )
    for (i = 0; i <= rows_a-1; i++) {
      for (j = 0; j <= cols_b-1; j++) {
        for (k = 0; k <= cols_a-1; k++) {
          mat_c[j + cols_b * i] += mat_a[cols_a * i + k] * mat_b[cols_b * k + j];
        }
      } 
    }
  ) @*/
  {
    for (it=0; it<=rows_a-6; it=it+6) {
      register int cbv_1;
      cbv_1=cols_b-2;
#pragma ivdep
#pragma vector always
      for (jt=0; jt<=cbv_1; jt=jt+2) {
        mat_c[jt+cols_b*it]=0;
        mat_c[(jt+1)+cols_b*it]=0;
        mat_c[jt+cols_b*(it+1)]=0;
        mat_c[(jt+1)+cols_b*(it+1)]=0;
        mat_c[jt+cols_b*(it+2)]=0;
        mat_c[(jt+1)+cols_b*(it+2)]=0;
        mat_c[jt+cols_b*(it+3)]=0;
        mat_c[(jt+1)+cols_b*(it+3)]=0;
        mat_c[jt+cols_b*(it+4)]=0;
        mat_c[(jt+1)+cols_b*(it+4)]=0;
        mat_c[jt+cols_b*(it+5)]=0;
        mat_c[(jt+1)+cols_b*(it+5)]=0;
      }
      {
        int j;
        register int cbv_2;
        cbv_2=cols_b-3;
#pragma ivdep
#pragma vector always
        for (j=jt; j<=cbv_2; j=j+3) {
          mat_c[j+cols_b*it]=0;
          mat_c[j+cols_b*(it+1)]=0;
          mat_c[j+cols_b*(it+2)]=0;
          mat_c[j+cols_b*(it+3)]=0;
          mat_c[j+cols_b*(it+4)]=0;
          mat_c[j+cols_b*(it+5)]=0;
          mat_c[j+cols_b*it+1]=0;
          mat_c[j+cols_b*(it+1)+1]=0;
          mat_c[j+cols_b*(it+2)+1]=0;
          mat_c[j+cols_b*(it+3)+1]=0;
          mat_c[j+cols_b*(it+4)+1]=0;
          mat_c[j+cols_b*(it+5)+1]=0;
          mat_c[j+cols_b*it+2]=0;
          mat_c[j+cols_b*(it+1)+2]=0;
          mat_c[j+cols_b*(it+2)+2]=0;
          mat_c[j+cols_b*(it+3)+2]=0;
          mat_c[j+cols_b*(it+4)+2]=0;
          mat_c[j+cols_b*(it+5)+2]=0;
        }
        register int cbv_3, cbv_4;
        cbv_3=cols_b-((cols_b-(jt))%3);
        cbv_4=cols_b-1;
#pragma ivdep
#pragma vector always
        for (j=cbv_3; j<=cbv_4; j=j+1) {
          mat_c[j+cols_b*it]=0;
          mat_c[j+cols_b*(it+1)]=0;
          mat_c[j+cols_b*(it+2)]=0;
          mat_c[j+cols_b*(it+3)]=0;
          mat_c[j+cols_b*(it+4)]=0;
          mat_c[j+cols_b*(it+5)]=0;
        }
      }
    }
    {
      int i;
      for (i=it; i<=rows_a-2; i=i+2) {
        register int cbv_5;
        cbv_5=cols_b-2;
#pragma ivdep
#pragma vector always
        for (jt=0; jt<=cbv_5; jt=jt+2) {
          mat_c[jt+cols_b*i]=0;
          mat_c[jt+cols_b*i+1]=0;
          mat_c[jt+cols_b*(i+1)]=0;
          mat_c[jt+cols_b*(i+1)+1]=0;
        }
        {
          int j;
          register int cbv_6;
          cbv_6=cols_b-3;
#pragma ivdep
#pragma vector always
          for (j=jt; j<=cbv_6; j=j+3) {
            mat_c[j+cols_b*i]=0;
            mat_c[j+cols_b*i+1]=0;
            mat_c[j+cols_b*i+2]=0;
          }
          register int cbv_7, cbv_8;
          cbv_7=cols_b-((cols_b-(jt))%3);
          cbv_8=cols_b-1;
#pragma ivdep
#pragma vector always
          for (j=cbv_7; j<=cbv_8; j=j+1) 
            mat_c[j+cols_b*i]=0;
        }
        {
          int j;
          register int cbv_9;
          cbv_9=cols_b-3;
#pragma ivdep
#pragma vector always
          for (j=jt; j<=cbv_9; j=j+3) {
            mat_c[j+cols_b*(i+1)]=0;
            mat_c[j+cols_b*(i+1)+1]=0;
            mat_c[j+cols_b*(i+1)+2]=0;
          }
          register int cbv_10, cbv_11;
          cbv_10=cols_b-((cols_b-(jt))%3);
          cbv_11=cols_b-1;
#pragma ivdep
#pragma vector always
          for (j=cbv_10; j<=cbv_11; j=j+1) 
            mat_c[j+cols_b*(i+1)]=0;
        }
      }
      for (i=rows_a-((rows_a-(it))%2); i<=rows_a-1; i=i+1) {
        register int cbv_12;
        cbv_12=cols_b-2;
#pragma ivdep
#pragma vector always
        for (jt=0; jt<=cbv_12; jt=jt+2) {
          mat_c[jt+cols_b*i]=0;
          mat_c[(jt+1)+cols_b*i]=0;
        }
        {
          int j;
          register int cbv_13;
          cbv_13=cols_b-3;
#pragma ivdep
#pragma vector always
          for (j=jt; j<=cbv_13; j=j+3) {
            mat_c[j+cols_b*i]=0;
            mat_c[j+cols_b*i+1]=0;
            mat_c[j+cols_b*i+2]=0;
          }
          register int cbv_14, cbv_15;
          cbv_14=cols_b-((cols_b-(jt))%3);
          cbv_15=cols_b-1;
#pragma ivdep
#pragma vector always
          for (j=cbv_14; j<=cbv_15; j=j+1) 
            mat_c[j+cols_b*i]=0;
        }
      }
    }
  }
  for (i=0; i<=rows_a-1; i++ ) {
    for (jt=0; jt<=cols_b-2; jt=jt+2) {
      register int cbv_1;
      cbv_1=cols_a-6;
#pragma ivdep
#pragma vector always
      for (kt=0; kt<=cbv_1; kt=kt+6) {
        mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+jt];
        mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+(kt+1)]*mat_b[cols_b*(kt+1)+jt];
        mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+(kt+2)]*mat_b[cols_b*(kt+2)+jt];
        mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+(kt+3)]*mat_b[cols_b*(kt+3)+jt];
        mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+(kt+4)]*mat_b[cols_b*(kt+4)+jt];
        mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+(kt+5)]*mat_b[cols_b*(kt+5)+jt];
        mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+(jt+1)];
        mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+(kt+1)]*mat_b[cols_b*(kt+1)+(jt+1)];
        mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+(kt+2)]*mat_b[cols_b*(kt+2)+(jt+1)];
        mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+(kt+3)]*mat_b[cols_b*(kt+3)+(jt+1)];
        mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+(kt+4)]*mat_b[cols_b*(kt+4)+(jt+1)];
        mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+(kt+5)]*mat_b[cols_b*(kt+5)+(jt+1)];
      }
      {
        int k;
        register int cbv_2;
        cbv_2=cols_a-3;
#pragma ivdep
#pragma vector always
        for (k=kt; k<=cbv_2; k=k+3) {
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt];
          mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt+1];
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+jt];
          mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+jt+1];
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+jt];
          mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+jt+1];
        }
        register int cbv_3, cbv_4;
        cbv_3=cols_a-((cols_a-(kt))%3);
        cbv_4=cols_a-1;
#pragma ivdep
#pragma vector always
        for (k=cbv_3; k<=cbv_4; k=k+1) {
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt];
          mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+(jt+1)];
        }
      }
    }
    for (j=jt; j<=cols_b-1; j=j+1) {
      register int cbv_5;
      cbv_5=cols_a-6;
#pragma ivdep
#pragma vector always
      for (kt=0; kt<=cbv_5; kt=kt+6) {
        mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+j];
        mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+(kt+1)]*mat_b[cols_b*(kt+1)+j];
        mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+(kt+2)]*mat_b[cols_b*(kt+2)+j];
        mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+(kt+3)]*mat_b[cols_b*(kt+3)+j];
        mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+(kt+4)]*mat_b[cols_b*(kt+4)+j];
        mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+(kt+5)]*mat_b[cols_b*(kt+5)+j];
      }
      {
        int k;
        register int cbv_6;
        cbv_6=cols_a-3;
#pragma ivdep
#pragma vector always
        for (k=kt; k<=cbv_6; k=k+3) {
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+j];
        }
        register int cbv_7, cbv_8;
        cbv_7=cols_a-((cols_a-(kt))%3);
        cbv_8=cols_a-1;
#pragma ivdep
#pragma vector always
        for (k=cbv_7; k<=cbv_8; k=k+1) 
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
      }
    }
  }
/*@ end @*/
} else if ((rows_a<=6) && (cols_a<=6) && (cols_b<=12)) {

/**-- (Generated by Orio) 
Best performance cost: 
  [1.137e-06, 7.31e-07, 5.75e-07, 5.72e-07, 5.76e-07] 
Tuned for specific problem sizes: 
  cols_a = 6 
  cols_b = 12 
  rows_a = 6 
Best performance parameters: 
  CFLAGS = -O1 
  RT0_I = 1 
  RT0_J = 1 
  RT1_I = 1 
  RT1_J = 1 
  RT1_K = 1 
  U_I = 1 
  U_I0 = 1 
  U_J = 1 
  U_J0 = 1 
  U_K = 1 
  VEC = False 
--**/


  int i, j, k;  
  int it,jt, kt;
  int c_ind, a_row, c_row;


  /*@ begin Loop (  
    transform Composite(
      unrolljam = (['i','j'],[U_I0,U_J0]),
      vector = (VEC, ['ivdep','vector always']),
      regtile = (['i','j'],[RT0_I,RT0_J])
    )
    for (i = 0; i <= rows_a-1; i++) {
      for (j = 0; j <= cols_b-1; j++) {
        mat_c[j + cols_b * i] = 0;
      }
    } 

    transform Composite(
      unrolljam = (['i','j','k'],[U_I,U_J,U_K]),
      vector = (VEC, ['ivdep','vector always']),
      regtile = (['i','j','k'],[RT1_I,RT1_J,RT1_K])
    )
    for (i = 0; i <= rows_a-1; i++) {
      for (j = 0; j <= cols_b-1; j++) {
        for (k = 0; k <= cols_a-1; k++) {
          mat_c[j + cols_b * i] += mat_a[cols_a * i + k] * mat_b[cols_b * k + j];
        }
      } 
    }
  ) @*/
  for (i=0; i<=rows_a-1; i++ ) {
    for (j=0; j<=cols_b-1; j++ ) {
      mat_c[j+cols_b*i]=0;
    }
  }
  for (i=0; i<=rows_a-1; i++ ) {
    for (j=0; j<=cols_b-1; j++ ) {
      for (k=0; k<=cols_a-1; k++ ) {
        mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
      }
    }
  }
/*@ end @*/
} else if ((rows_a<=6) && (cols_a<=12) && (cols_b<=6)) {

/**-- (Generated by Orio) 
Best performance cost: 
  [1.472e-06, 6.43e-07, 5.47e-07, 5.32e-07, 5.28e-07] 
Tuned for specific problem sizes: 
  cols_a = 12 
  cols_b = 6 
  rows_a = 6 
Best performance parameters: 
  CFLAGS = -O3 
  RT0_I = 1 
  RT0_J = 1 
  RT1_I = 6 
  RT1_J = 1 
  RT1_K = 1 
  U_I = 4 
  U_I0 = 3 
  U_J = 1 
  U_J0 = 4 
  U_K = 5 
  VEC = True 
--**/


  int i, j, k;  
  int it,jt, kt;
  int c_ind, a_row, c_row;


  /*@ begin Loop (  
    transform Composite(
      unrolljam = (['i','j'],[U_I0,U_J0]),
      vector = (VEC, ['ivdep','vector always']),
      regtile = (['i','j'],[RT0_I,RT0_J])
    )
    for (i = 0; i <= rows_a-1; i++) {
      for (j = 0; j <= cols_b-1; j++) {
        mat_c[j + cols_b * i] = 0;
      }
    } 

    transform Composite(
      unrolljam = (['i','j','k'],[U_I,U_J,U_K]),
      vector = (VEC, ['ivdep','vector always']),
      regtile = (['i','j','k'],[RT1_I,RT1_J,RT1_K])
    )
    for (i = 0; i <= rows_a-1; i++) {
      for (j = 0; j <= cols_b-1; j++) {
        for (k = 0; k <= cols_a-1; k++) {
          mat_c[j + cols_b * i] += mat_a[cols_a * i + k] * mat_b[cols_b * k + j];
        }
      } 
    }
  ) @*/
  {
    int i;
    for (i=0; i<=rows_a-3; i=i+3) {
      int j;
      register int cbv_1;
      cbv_1=cols_b-4;
#pragma ivdep
#pragma vector always
      for (j=0; j<=cbv_1; j=j+4) {
        mat_c[j+cols_b*i]=0;
        mat_c[j+cols_b*i+1]=0;
        mat_c[j+cols_b*i+2]=0;
        mat_c[j+cols_b*i+3]=0;
        mat_c[j+cols_b*(i+1)]=0;
        mat_c[j+cols_b*(i+1)+1]=0;
        mat_c[j+cols_b*(i+1)+2]=0;
        mat_c[j+cols_b*(i+1)+3]=0;
        mat_c[j+cols_b*(i+2)]=0;
        mat_c[j+cols_b*(i+2)+1]=0;
        mat_c[j+cols_b*(i+2)+2]=0;
        mat_c[j+cols_b*(i+2)+3]=0;
      }
      register int cbv_2, cbv_3;
      cbv_2=cols_b-((cols_b-(0))%4);
      cbv_3=cols_b-1;
#pragma ivdep
#pragma vector always
      for (j=cbv_2; j<=cbv_3; j=j+1) {
        mat_c[j+cols_b*i]=0;
        mat_c[j+cols_b*(i+1)]=0;
        mat_c[j+cols_b*(i+2)]=0;
      }
    }
    for (i=rows_a-((rows_a-(0))%3); i<=rows_a-1; i=i+1) {
      int j;
      register int cbv_4;
      cbv_4=cols_b-4;
#pragma ivdep
#pragma vector always
      for (j=0; j<=cbv_4; j=j+4) {
        mat_c[j+cols_b*i]=0;
        mat_c[j+cols_b*i+1]=0;
        mat_c[j+cols_b*i+2]=0;
        mat_c[j+cols_b*i+3]=0;
      }
      register int cbv_5, cbv_6;
      cbv_5=cols_b-((cols_b-(0))%4);
      cbv_6=cols_b-1;
#pragma ivdep
#pragma vector always
      for (j=cbv_5; j<=cbv_6; j=j+1) 
        mat_c[j+cols_b*i]=0;
    }
  }
  {
    for (it=0; it<=rows_a-6; it=it+6) {
      for (j=0; j<=cols_b-1; j++ ) {
        {
          int k;
          register int cbv_1;
          cbv_1=cols_a-5;
#pragma ivdep
#pragma vector always
          for (k=0; k<=cbv_1; k=k+5) {
            mat_c[j+cols_b*it]=mat_c[j+cols_b*it]+mat_a[cols_a*it+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+1)]=mat_c[j+cols_b*(it+1)]+mat_a[cols_a*(it+1)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+2)]=mat_c[j+cols_b*(it+2)]+mat_a[cols_a*(it+2)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+3)]=mat_c[j+cols_b*(it+3)]+mat_a[cols_a*(it+3)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+4)]=mat_c[j+cols_b*(it+4)]+mat_a[cols_a*(it+4)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+5)]=mat_c[j+cols_b*(it+5)]+mat_a[cols_a*(it+5)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*it]=mat_c[j+cols_b*it]+mat_a[cols_a*it+k+1]*mat_b[cols_b*(k+1)+j];
            mat_c[j+cols_b*(it+1)]=mat_c[j+cols_b*(it+1)]+mat_a[cols_a*(it+1)+k+1]*mat_b[cols_b*(k+1)+j];
            mat_c[j+cols_b*(it+2)]=mat_c[j+cols_b*(it+2)]+mat_a[cols_a*(it+2)+k+1]*mat_b[cols_b*(k+1)+j];
            mat_c[j+cols_b*(it+3)]=mat_c[j+cols_b*(it+3)]+mat_a[cols_a*(it+3)+k+1]*mat_b[cols_b*(k+1)+j];
            mat_c[j+cols_b*(it+4)]=mat_c[j+cols_b*(it+4)]+mat_a[cols_a*(it+4)+k+1]*mat_b[cols_b*(k+1)+j];
            mat_c[j+cols_b*(it+5)]=mat_c[j+cols_b*(it+5)]+mat_a[cols_a*(it+5)+k+1]*mat_b[cols_b*(k+1)+j];
            mat_c[j+cols_b*it]=mat_c[j+cols_b*it]+mat_a[cols_a*it+k+2]*mat_b[cols_b*(k+2)+j];
            mat_c[j+cols_b*(it+1)]=mat_c[j+cols_b*(it+1)]+mat_a[cols_a*(it+1)+k+2]*mat_b[cols_b*(k+2)+j];
            mat_c[j+cols_b*(it+2)]=mat_c[j+cols_b*(it+2)]+mat_a[cols_a*(it+2)+k+2]*mat_b[cols_b*(k+2)+j];
            mat_c[j+cols_b*(it+3)]=mat_c[j+cols_b*(it+3)]+mat_a[cols_a*(it+3)+k+2]*mat_b[cols_b*(k+2)+j];
            mat_c[j+cols_b*(it+4)]=mat_c[j+cols_b*(it+4)]+mat_a[cols_a*(it+4)+k+2]*mat_b[cols_b*(k+2)+j];
            mat_c[j+cols_b*(it+5)]=mat_c[j+cols_b*(it+5)]+mat_a[cols_a*(it+5)+k+2]*mat_b[cols_b*(k+2)+j];
            mat_c[j+cols_b*it]=mat_c[j+cols_b*it]+mat_a[cols_a*it+k+3]*mat_b[cols_b*(k+3)+j];
            mat_c[j+cols_b*(it+1)]=mat_c[j+cols_b*(it+1)]+mat_a[cols_a*(it+1)+k+3]*mat_b[cols_b*(k+3)+j];
            mat_c[j+cols_b*(it+2)]=mat_c[j+cols_b*(it+2)]+mat_a[cols_a*(it+2)+k+3]*mat_b[cols_b*(k+3)+j];
            mat_c[j+cols_b*(it+3)]=mat_c[j+cols_b*(it+3)]+mat_a[cols_a*(it+3)+k+3]*mat_b[cols_b*(k+3)+j];
            mat_c[j+cols_b*(it+4)]=mat_c[j+cols_b*(it+4)]+mat_a[cols_a*(it+4)+k+3]*mat_b[cols_b*(k+3)+j];
            mat_c[j+cols_b*(it+5)]=mat_c[j+cols_b*(it+5)]+mat_a[cols_a*(it+5)+k+3]*mat_b[cols_b*(k+3)+j];
            mat_c[j+cols_b*it]=mat_c[j+cols_b*it]+mat_a[cols_a*it+k+4]*mat_b[cols_b*(k+4)+j];
            mat_c[j+cols_b*(it+1)]=mat_c[j+cols_b*(it+1)]+mat_a[cols_a*(it+1)+k+4]*mat_b[cols_b*(k+4)+j];
            mat_c[j+cols_b*(it+2)]=mat_c[j+cols_b*(it+2)]+mat_a[cols_a*(it+2)+k+4]*mat_b[cols_b*(k+4)+j];
            mat_c[j+cols_b*(it+3)]=mat_c[j+cols_b*(it+3)]+mat_a[cols_a*(it+3)+k+4]*mat_b[cols_b*(k+4)+j];
            mat_c[j+cols_b*(it+4)]=mat_c[j+cols_b*(it+4)]+mat_a[cols_a*(it+4)+k+4]*mat_b[cols_b*(k+4)+j];
            mat_c[j+cols_b*(it+5)]=mat_c[j+cols_b*(it+5)]+mat_a[cols_a*(it+5)+k+4]*mat_b[cols_b*(k+4)+j];
          }
          register int cbv_2, cbv_3;
          cbv_2=cols_a-((cols_a-(0))%5);
          cbv_3=cols_a-1;
#pragma ivdep
#pragma vector always
          for (k=cbv_2; k<=cbv_3; k=k+1) {
            mat_c[j+cols_b*it]=mat_c[j+cols_b*it]+mat_a[cols_a*it+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+1)]=mat_c[j+cols_b*(it+1)]+mat_a[cols_a*(it+1)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+2)]=mat_c[j+cols_b*(it+2)]+mat_a[cols_a*(it+2)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+3)]=mat_c[j+cols_b*(it+3)]+mat_a[cols_a*(it+3)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+4)]=mat_c[j+cols_b*(it+4)]+mat_a[cols_a*(it+4)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+5)]=mat_c[j+cols_b*(it+5)]+mat_a[cols_a*(it+5)+k]*mat_b[cols_b*k+j];
          }
        }
      }
    }
    {
      int i;
      for (i=it; i<=rows_a-4; i=i+4) {
        for (j=0; j<=cols_b-1; j++ ) {
          {
            int k;
            register int cbv_4;
            cbv_4=cols_a-5;
#pragma ivdep
#pragma vector always
            for (k=0; k<=cbv_4; k=k+5) {
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+j];
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+j];
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+j];
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+4]*mat_b[cols_b*(k+4)+j];
            }
            register int cbv_5, cbv_6;
            cbv_5=cols_a-((cols_a-(0))%5);
            cbv_6=cols_a-1;
#pragma ivdep
#pragma vector always
            for (k=cbv_5; k<=cbv_6; k=k+1) 
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
          }
          {
            int k;
            register int cbv_7;
            cbv_7=cols_a-5;
#pragma ivdep
#pragma vector always
            for (k=0; k<=cbv_7; k=k+5) {
              mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k]*mat_b[cols_b*k+j];
              mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k+1]*mat_b[cols_b*(k+1)+j];
              mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k+2]*mat_b[cols_b*(k+2)+j];
              mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k+3]*mat_b[cols_b*(k+3)+j];
              mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k+4]*mat_b[cols_b*(k+4)+j];
            }
            register int cbv_8, cbv_9;
            cbv_8=cols_a-((cols_a-(0))%5);
            cbv_9=cols_a-1;
#pragma ivdep
#pragma vector always
            for (k=cbv_8; k<=cbv_9; k=k+1) 
              mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k]*mat_b[cols_b*k+j];
          }
          {
            int k;
            register int cbv_10;
            cbv_10=cols_a-5;
#pragma ivdep
#pragma vector always
            for (k=0; k<=cbv_10; k=k+5) {
              mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k]*mat_b[cols_b*k+j];
              mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k+1]*mat_b[cols_b*(k+1)+j];
              mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k+2]*mat_b[cols_b*(k+2)+j];
              mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k+3]*mat_b[cols_b*(k+3)+j];
              mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k+4]*mat_b[cols_b*(k+4)+j];
            }
            register int cbv_11, cbv_12;
            cbv_11=cols_a-((cols_a-(0))%5);
            cbv_12=cols_a-1;
#pragma ivdep
#pragma vector always
            for (k=cbv_11; k<=cbv_12; k=k+1) 
              mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k]*mat_b[cols_b*k+j];
          }
          {
            int k;
            register int cbv_13;
            cbv_13=cols_a-5;
#pragma ivdep
#pragma vector always
            for (k=0; k<=cbv_13; k=k+5) {
              mat_c[j+cols_b*(i+3)]=mat_c[j+cols_b*(i+3)]+mat_a[cols_a*(i+3)+k]*mat_b[cols_b*k+j];
              mat_c[j+cols_b*(i+3)]=mat_c[j+cols_b*(i+3)]+mat_a[cols_a*(i+3)+k+1]*mat_b[cols_b*(k+1)+j];
              mat_c[j+cols_b*(i+3)]=mat_c[j+cols_b*(i+3)]+mat_a[cols_a*(i+3)+k+2]*mat_b[cols_b*(k+2)+j];
              mat_c[j+cols_b*(i+3)]=mat_c[j+cols_b*(i+3)]+mat_a[cols_a*(i+3)+k+3]*mat_b[cols_b*(k+3)+j];
              mat_c[j+cols_b*(i+3)]=mat_c[j+cols_b*(i+3)]+mat_a[cols_a*(i+3)+k+4]*mat_b[cols_b*(k+4)+j];
            }
            register int cbv_14, cbv_15;
            cbv_14=cols_a-((cols_a-(0))%5);
            cbv_15=cols_a-1;
#pragma ivdep
#pragma vector always
            for (k=cbv_14; k<=cbv_15; k=k+1) 
              mat_c[j+cols_b*(i+3)]=mat_c[j+cols_b*(i+3)]+mat_a[cols_a*(i+3)+k]*mat_b[cols_b*k+j];
          }
        }
      }
      for (i=rows_a-((rows_a-(it))%4); i<=rows_a-1; i=i+1) 
        for (j=0; j<=cols_b-1; j++ ) {
          {
            int k;
            register int cbv_16;
            cbv_16=cols_a-5;
#pragma ivdep
#pragma vector always
            for (k=0; k<=cbv_16; k=k+5) {
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+j];
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+j];
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+j];
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+4]*mat_b[cols_b*(k+4)+j];
            }
            register int cbv_17, cbv_18;
            cbv_17=cols_a-((cols_a-(0))%5);
            cbv_18=cols_a-1;
#pragma ivdep
#pragma vector always
            for (k=cbv_17; k<=cbv_18; k=k+1) 
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
          }
        }
    }
  }
/*@ end @*/
} else if ((rows_a<=6) && (cols_a<=12) && (cols_b<=12)) {

/**-- (Generated by Orio) 
Best performance cost: 
  [1.946e-06, 1.038e-06, 9.01e-07, 8.8e-07, 8.75e-07] 
Tuned for specific problem sizes: 
  cols_a = 12 
  cols_b = 12 
  rows_a = 6 
Best performance parameters: 
  CFLAGS = -O3 
  RT0_I = 1 
  RT0_J = 1 
  RT1_I = 6 
  RT1_J = 1 
  RT1_K = 1 
  U_I = 4 
  U_I0 = 3 
  U_J = 1 
  U_J0 = 4 
  U_K = 5 
  VEC = True 
--**/


  int i, j, k;  
  int it,jt, kt;
  int c_ind, a_row, c_row;


  /*@ begin Loop (  
    transform Composite(
      unrolljam = (['i','j'],[U_I0,U_J0]),
      vector = (VEC, ['ivdep','vector always']),
      regtile = (['i','j'],[RT0_I,RT0_J])
    )
    for (i = 0; i <= rows_a-1; i++) {
      for (j = 0; j <= cols_b-1; j++) {
        mat_c[j + cols_b * i] = 0;
      }
    } 

    transform Composite(
      unrolljam = (['i','j','k'],[U_I,U_J,U_K]),
      vector = (VEC, ['ivdep','vector always']),
      regtile = (['i','j','k'],[RT1_I,RT1_J,RT1_K])
    )
    for (i = 0; i <= rows_a-1; i++) {
      for (j = 0; j <= cols_b-1; j++) {
        for (k = 0; k <= cols_a-1; k++) {
          mat_c[j + cols_b * i] += mat_a[cols_a * i + k] * mat_b[cols_b * k + j];
        }
      } 
    }
  ) @*/
  {
    int i;
    for (i=0; i<=rows_a-3; i=i+3) {
      int j;
      register int cbv_1;
      cbv_1=cols_b-4;
#pragma ivdep
#pragma vector always
      for (j=0; j<=cbv_1; j=j+4) {
        mat_c[j+cols_b*i]=0;
        mat_c[j+cols_b*i+1]=0;
        mat_c[j+cols_b*i+2]=0;
        mat_c[j+cols_b*i+3]=0;
        mat_c[j+cols_b*(i+1)]=0;
        mat_c[j+cols_b*(i+1)+1]=0;
        mat_c[j+cols_b*(i+1)+2]=0;
        mat_c[j+cols_b*(i+1)+3]=0;
        mat_c[j+cols_b*(i+2)]=0;
        mat_c[j+cols_b*(i+2)+1]=0;
        mat_c[j+cols_b*(i+2)+2]=0;
        mat_c[j+cols_b*(i+2)+3]=0;
      }
      register int cbv_2, cbv_3;
      cbv_2=cols_b-((cols_b-(0))%4);
      cbv_3=cols_b-1;
#pragma ivdep
#pragma vector always
      for (j=cbv_2; j<=cbv_3; j=j+1) {
        mat_c[j+cols_b*i]=0;
        mat_c[j+cols_b*(i+1)]=0;
        mat_c[j+cols_b*(i+2)]=0;
      }
    }
    for (i=rows_a-((rows_a-(0))%3); i<=rows_a-1; i=i+1) {
      int j;
      register int cbv_4;
      cbv_4=cols_b-4;
#pragma ivdep
#pragma vector always
      for (j=0; j<=cbv_4; j=j+4) {
        mat_c[j+cols_b*i]=0;
        mat_c[j+cols_b*i+1]=0;
        mat_c[j+cols_b*i+2]=0;
        mat_c[j+cols_b*i+3]=0;
      }
      register int cbv_5, cbv_6;
      cbv_5=cols_b-((cols_b-(0))%4);
      cbv_6=cols_b-1;
#pragma ivdep
#pragma vector always
      for (j=cbv_5; j<=cbv_6; j=j+1) 
        mat_c[j+cols_b*i]=0;
    }
  }
  {
    for (it=0; it<=rows_a-6; it=it+6) {
      for (j=0; j<=cols_b-1; j++ ) {
        {
          int k;
          register int cbv_1;
          cbv_1=cols_a-5;
#pragma ivdep
#pragma vector always
          for (k=0; k<=cbv_1; k=k+5) {
            mat_c[j+cols_b*it]=mat_c[j+cols_b*it]+mat_a[cols_a*it+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+1)]=mat_c[j+cols_b*(it+1)]+mat_a[cols_a*(it+1)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+2)]=mat_c[j+cols_b*(it+2)]+mat_a[cols_a*(it+2)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+3)]=mat_c[j+cols_b*(it+3)]+mat_a[cols_a*(it+3)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+4)]=mat_c[j+cols_b*(it+4)]+mat_a[cols_a*(it+4)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+5)]=mat_c[j+cols_b*(it+5)]+mat_a[cols_a*(it+5)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*it]=mat_c[j+cols_b*it]+mat_a[cols_a*it+k+1]*mat_b[cols_b*(k+1)+j];
            mat_c[j+cols_b*(it+1)]=mat_c[j+cols_b*(it+1)]+mat_a[cols_a*(it+1)+k+1]*mat_b[cols_b*(k+1)+j];
            mat_c[j+cols_b*(it+2)]=mat_c[j+cols_b*(it+2)]+mat_a[cols_a*(it+2)+k+1]*mat_b[cols_b*(k+1)+j];
            mat_c[j+cols_b*(it+3)]=mat_c[j+cols_b*(it+3)]+mat_a[cols_a*(it+3)+k+1]*mat_b[cols_b*(k+1)+j];
            mat_c[j+cols_b*(it+4)]=mat_c[j+cols_b*(it+4)]+mat_a[cols_a*(it+4)+k+1]*mat_b[cols_b*(k+1)+j];
            mat_c[j+cols_b*(it+5)]=mat_c[j+cols_b*(it+5)]+mat_a[cols_a*(it+5)+k+1]*mat_b[cols_b*(k+1)+j];
            mat_c[j+cols_b*it]=mat_c[j+cols_b*it]+mat_a[cols_a*it+k+2]*mat_b[cols_b*(k+2)+j];
            mat_c[j+cols_b*(it+1)]=mat_c[j+cols_b*(it+1)]+mat_a[cols_a*(it+1)+k+2]*mat_b[cols_b*(k+2)+j];
            mat_c[j+cols_b*(it+2)]=mat_c[j+cols_b*(it+2)]+mat_a[cols_a*(it+2)+k+2]*mat_b[cols_b*(k+2)+j];
            mat_c[j+cols_b*(it+3)]=mat_c[j+cols_b*(it+3)]+mat_a[cols_a*(it+3)+k+2]*mat_b[cols_b*(k+2)+j];
            mat_c[j+cols_b*(it+4)]=mat_c[j+cols_b*(it+4)]+mat_a[cols_a*(it+4)+k+2]*mat_b[cols_b*(k+2)+j];
            mat_c[j+cols_b*(it+5)]=mat_c[j+cols_b*(it+5)]+mat_a[cols_a*(it+5)+k+2]*mat_b[cols_b*(k+2)+j];
            mat_c[j+cols_b*it]=mat_c[j+cols_b*it]+mat_a[cols_a*it+k+3]*mat_b[cols_b*(k+3)+j];
            mat_c[j+cols_b*(it+1)]=mat_c[j+cols_b*(it+1)]+mat_a[cols_a*(it+1)+k+3]*mat_b[cols_b*(k+3)+j];
            mat_c[j+cols_b*(it+2)]=mat_c[j+cols_b*(it+2)]+mat_a[cols_a*(it+2)+k+3]*mat_b[cols_b*(k+3)+j];
            mat_c[j+cols_b*(it+3)]=mat_c[j+cols_b*(it+3)]+mat_a[cols_a*(it+3)+k+3]*mat_b[cols_b*(k+3)+j];
            mat_c[j+cols_b*(it+4)]=mat_c[j+cols_b*(it+4)]+mat_a[cols_a*(it+4)+k+3]*mat_b[cols_b*(k+3)+j];
            mat_c[j+cols_b*(it+5)]=mat_c[j+cols_b*(it+5)]+mat_a[cols_a*(it+5)+k+3]*mat_b[cols_b*(k+3)+j];
            mat_c[j+cols_b*it]=mat_c[j+cols_b*it]+mat_a[cols_a*it+k+4]*mat_b[cols_b*(k+4)+j];
            mat_c[j+cols_b*(it+1)]=mat_c[j+cols_b*(it+1)]+mat_a[cols_a*(it+1)+k+4]*mat_b[cols_b*(k+4)+j];
            mat_c[j+cols_b*(it+2)]=mat_c[j+cols_b*(it+2)]+mat_a[cols_a*(it+2)+k+4]*mat_b[cols_b*(k+4)+j];
            mat_c[j+cols_b*(it+3)]=mat_c[j+cols_b*(it+3)]+mat_a[cols_a*(it+3)+k+4]*mat_b[cols_b*(k+4)+j];
            mat_c[j+cols_b*(it+4)]=mat_c[j+cols_b*(it+4)]+mat_a[cols_a*(it+4)+k+4]*mat_b[cols_b*(k+4)+j];
            mat_c[j+cols_b*(it+5)]=mat_c[j+cols_b*(it+5)]+mat_a[cols_a*(it+5)+k+4]*mat_b[cols_b*(k+4)+j];
          }
          register int cbv_2, cbv_3;
          cbv_2=cols_a-((cols_a-(0))%5);
          cbv_3=cols_a-1;
#pragma ivdep
#pragma vector always
          for (k=cbv_2; k<=cbv_3; k=k+1) {
            mat_c[j+cols_b*it]=mat_c[j+cols_b*it]+mat_a[cols_a*it+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+1)]=mat_c[j+cols_b*(it+1)]+mat_a[cols_a*(it+1)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+2)]=mat_c[j+cols_b*(it+2)]+mat_a[cols_a*(it+2)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+3)]=mat_c[j+cols_b*(it+3)]+mat_a[cols_a*(it+3)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+4)]=mat_c[j+cols_b*(it+4)]+mat_a[cols_a*(it+4)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(it+5)]=mat_c[j+cols_b*(it+5)]+mat_a[cols_a*(it+5)+k]*mat_b[cols_b*k+j];
          }
        }
      }
    }
    {
      int i;
      for (i=it; i<=rows_a-4; i=i+4) {
        for (j=0; j<=cols_b-1; j++ ) {
          {
            int k;
            register int cbv_4;
            cbv_4=cols_a-5;
#pragma ivdep
#pragma vector always
            for (k=0; k<=cbv_4; k=k+5) {
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+j];
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+j];
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+j];
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+4]*mat_b[cols_b*(k+4)+j];
            }
            register int cbv_5, cbv_6;
            cbv_5=cols_a-((cols_a-(0))%5);
            cbv_6=cols_a-1;
#pragma ivdep
#pragma vector always
            for (k=cbv_5; k<=cbv_6; k=k+1) 
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
          }
          {
            int k;
            register int cbv_7;
            cbv_7=cols_a-5;
#pragma ivdep
#pragma vector always
            for (k=0; k<=cbv_7; k=k+5) {
              mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k]*mat_b[cols_b*k+j];
              mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k+1]*mat_b[cols_b*(k+1)+j];
              mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k+2]*mat_b[cols_b*(k+2)+j];
              mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k+3]*mat_b[cols_b*(k+3)+j];
              mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k+4]*mat_b[cols_b*(k+4)+j];
            }
            register int cbv_8, cbv_9;
            cbv_8=cols_a-((cols_a-(0))%5);
            cbv_9=cols_a-1;
#pragma ivdep
#pragma vector always
            for (k=cbv_8; k<=cbv_9; k=k+1) 
              mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k]*mat_b[cols_b*k+j];
          }
          {
            int k;
            register int cbv_10;
            cbv_10=cols_a-5;
#pragma ivdep
#pragma vector always
            for (k=0; k<=cbv_10; k=k+5) {
              mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k]*mat_b[cols_b*k+j];
              mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k+1]*mat_b[cols_b*(k+1)+j];
              mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k+2]*mat_b[cols_b*(k+2)+j];
              mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k+3]*mat_b[cols_b*(k+3)+j];
              mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k+4]*mat_b[cols_b*(k+4)+j];
            }
            register int cbv_11, cbv_12;
            cbv_11=cols_a-((cols_a-(0))%5);
            cbv_12=cols_a-1;
#pragma ivdep
#pragma vector always
            for (k=cbv_11; k<=cbv_12; k=k+1) 
              mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k]*mat_b[cols_b*k+j];
          }
          {
            int k;
            register int cbv_13;
            cbv_13=cols_a-5;
#pragma ivdep
#pragma vector always
            for (k=0; k<=cbv_13; k=k+5) {
              mat_c[j+cols_b*(i+3)]=mat_c[j+cols_b*(i+3)]+mat_a[cols_a*(i+3)+k]*mat_b[cols_b*k+j];
              mat_c[j+cols_b*(i+3)]=mat_c[j+cols_b*(i+3)]+mat_a[cols_a*(i+3)+k+1]*mat_b[cols_b*(k+1)+j];
              mat_c[j+cols_b*(i+3)]=mat_c[j+cols_b*(i+3)]+mat_a[cols_a*(i+3)+k+2]*mat_b[cols_b*(k+2)+j];
              mat_c[j+cols_b*(i+3)]=mat_c[j+cols_b*(i+3)]+mat_a[cols_a*(i+3)+k+3]*mat_b[cols_b*(k+3)+j];
              mat_c[j+cols_b*(i+3)]=mat_c[j+cols_b*(i+3)]+mat_a[cols_a*(i+3)+k+4]*mat_b[cols_b*(k+4)+j];
            }
            register int cbv_14, cbv_15;
            cbv_14=cols_a-((cols_a-(0))%5);
            cbv_15=cols_a-1;
#pragma ivdep
#pragma vector always
            for (k=cbv_14; k<=cbv_15; k=k+1) 
              mat_c[j+cols_b*(i+3)]=mat_c[j+cols_b*(i+3)]+mat_a[cols_a*(i+3)+k]*mat_b[cols_b*k+j];
          }
        }
      }
      for (i=rows_a-((rows_a-(it))%4); i<=rows_a-1; i=i+1) 
        for (j=0; j<=cols_b-1; j++ ) {
          {
            int k;
            register int cbv_16;
            cbv_16=cols_a-5;
#pragma ivdep
#pragma vector always
            for (k=0; k<=cbv_16; k=k+5) {
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+j];
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+j];
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+j];
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+4]*mat_b[cols_b*(k+4)+j];
            }
            register int cbv_17, cbv_18;
            cbv_17=cols_a-((cols_a-(0))%5);
            cbv_18=cols_a-1;
#pragma ivdep
#pragma vector always
            for (k=cbv_17; k<=cbv_18; k=k+1) 
              mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
          }
        }
    }
  }
/*@ end @*/
} else if ((rows_a<=12) && (cols_a<=6) && (cols_b<=6)) {

/**-- (Generated by Orio) 
Best performance cost: 
  [1.404e-06, 6.43e-07, 5.45e-07, 5.4e-07, 5.4e-07] 
Tuned for specific problem sizes: 
  cols_a = 6 
  cols_b = 6 
  rows_a = 12 
Best performance parameters: 
  CFLAGS = -O1 
  RT0_I = 1 
  RT0_J = 6 
  RT1_I = 1 
  RT1_J = 6 
  RT1_K = 6 
  U_I = 3 
  U_I0 = 4 
  U_J = 1 
  U_J0 = 3 
  U_K = 5 
  VEC = False 
--**/


  int i, j, k;  
  int it,jt, kt;
  int c_ind, a_row, c_row;


  /*@ begin Loop (  
    transform Composite(
      unrolljam = (['i','j'],[U_I0,U_J0]),
      vector = (VEC, ['ivdep','vector always']),
      regtile = (['i','j'],[RT0_I,RT0_J])
    )
    for (i = 0; i <= rows_a-1; i++) {
      for (j = 0; j <= cols_b-1; j++) {
        mat_c[j + cols_b * i] = 0;
      }
    } 

    transform Composite(
      unrolljam = (['i','j','k'],[U_I,U_J,U_K]),
      vector = (VEC, ['ivdep','vector always']),
      regtile = (['i','j','k'],[RT1_I,RT1_J,RT1_K])
    )
    for (i = 0; i <= rows_a-1; i++) {
      for (j = 0; j <= cols_b-1; j++) {
        for (k = 0; k <= cols_a-1; k++) {
          mat_c[j + cols_b * i] += mat_a[cols_a * i + k] * mat_b[cols_b * k + j];
        }
      } 
    }
  ) @*/
  {
    int i;
    for (i=0; i<=rows_a-4; i=i+4) {
      for (jt=0; jt<=cols_b-6; jt=jt+6) {
        mat_c[jt+cols_b*i]=0;
        mat_c[jt+cols_b*i+1]=0;
        mat_c[jt+cols_b*i+2]=0;
        mat_c[jt+cols_b*i+3]=0;
        mat_c[jt+cols_b*i+4]=0;
        mat_c[jt+cols_b*i+5]=0;
        mat_c[jt+cols_b*(i+1)]=0;
        mat_c[jt+cols_b*(i+1)+1]=0;
        mat_c[jt+cols_b*(i+1)+2]=0;
        mat_c[jt+cols_b*(i+1)+3]=0;
        mat_c[jt+cols_b*(i+1)+4]=0;
        mat_c[jt+cols_b*(i+1)+5]=0;
        mat_c[jt+cols_b*(i+2)]=0;
        mat_c[jt+cols_b*(i+2)+1]=0;
        mat_c[jt+cols_b*(i+2)+2]=0;
        mat_c[jt+cols_b*(i+2)+3]=0;
        mat_c[jt+cols_b*(i+2)+4]=0;
        mat_c[jt+cols_b*(i+2)+5]=0;
        mat_c[jt+cols_b*(i+3)]=0;
        mat_c[jt+cols_b*(i+3)+1]=0;
        mat_c[jt+cols_b*(i+3)+2]=0;
        mat_c[jt+cols_b*(i+3)+3]=0;
        mat_c[jt+cols_b*(i+3)+4]=0;
        mat_c[jt+cols_b*(i+3)+5]=0;
      }
      {
        int j;
        for (j=jt; j<=cols_b-3; j=j+3) {
          mat_c[j+cols_b*i]=0;
          mat_c[j+cols_b*i+1]=0;
          mat_c[j+cols_b*i+2]=0;
        }
        for (j=cols_b-((cols_b-(jt))%3); j<=cols_b-1; j=j+1) 
          mat_c[j+cols_b*i]=0;
      }
      {
        int j;
        for (j=jt; j<=cols_b-3; j=j+3) {
          mat_c[j+cols_b*(i+1)]=0;
          mat_c[j+cols_b*(i+1)+1]=0;
          mat_c[j+cols_b*(i+1)+2]=0;
        }
        for (j=cols_b-((cols_b-(jt))%3); j<=cols_b-1; j=j+1) 
          mat_c[j+cols_b*(i+1)]=0;
      }
      {
        int j;
        for (j=jt; j<=cols_b-3; j=j+3) {
          mat_c[j+cols_b*(i+2)]=0;
          mat_c[j+cols_b*(i+2)+1]=0;
          mat_c[j+cols_b*(i+2)+2]=0;
        }
        for (j=cols_b-((cols_b-(jt))%3); j<=cols_b-1; j=j+1) 
          mat_c[j+cols_b*(i+2)]=0;
      }
      {
        int j;
        for (j=jt; j<=cols_b-3; j=j+3) {
          mat_c[j+cols_b*(i+3)]=0;
          mat_c[j+cols_b*(i+3)+1]=0;
          mat_c[j+cols_b*(i+3)+2]=0;
        }
        for (j=cols_b-((cols_b-(jt))%3); j<=cols_b-1; j=j+1) 
          mat_c[j+cols_b*(i+3)]=0;
      }
    }
    for (i=rows_a-((rows_a-(0))%4); i<=rows_a-1; i=i+1) {
      for (jt=0; jt<=cols_b-6; jt=jt+6) {
        mat_c[jt+cols_b*i]=0;
        mat_c[(jt+1)+cols_b*i]=0;
        mat_c[(jt+2)+cols_b*i]=0;
        mat_c[(jt+3)+cols_b*i]=0;
        mat_c[(jt+4)+cols_b*i]=0;
        mat_c[(jt+5)+cols_b*i]=0;
      }
      {
        int j;
        for (j=jt; j<=cols_b-3; j=j+3) {
          mat_c[j+cols_b*i]=0;
          mat_c[j+cols_b*i+1]=0;
          mat_c[j+cols_b*i+2]=0;
        }
        for (j=cols_b-((cols_b-(jt))%3); j<=cols_b-1; j=j+1) 
          mat_c[j+cols_b*i]=0;
      }
    }
  }
  {
    int i;
    for (i=0; i<=rows_a-3; i=i+3) {
      for (jt=0; jt<=cols_b-6; jt=jt+6) {
        for (kt=0; kt<=cols_a-6; kt=kt+6) {
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+jt];
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+kt+1]*mat_b[cols_b*(kt+1)+jt];
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+kt+2]*mat_b[cols_b*(kt+2)+jt];
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+kt+3]*mat_b[cols_b*(kt+3)+jt];
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+kt+4]*mat_b[cols_b*(kt+4)+jt];
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+kt+5]*mat_b[cols_b*(kt+5)+jt];
          mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+jt+1];
          mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+kt+1]*mat_b[cols_b*(kt+1)+jt+1];
          mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+kt+2]*mat_b[cols_b*(kt+2)+jt+1];
          mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+kt+3]*mat_b[cols_b*(kt+3)+jt+1];
          mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+kt+4]*mat_b[cols_b*(kt+4)+jt+1];
          mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+kt+5]*mat_b[cols_b*(kt+5)+jt+1];
          mat_c[jt+cols_b*i+2]=mat_c[jt+cols_b*i+2]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+jt+2];
          mat_c[jt+cols_b*i+2]=mat_c[jt+cols_b*i+2]+mat_a[cols_a*i+kt+1]*mat_b[cols_b*(kt+1)+jt+2];
          mat_c[jt+cols_b*i+2]=mat_c[jt+cols_b*i+2]+mat_a[cols_a*i+kt+2]*mat_b[cols_b*(kt+2)+jt+2];
          mat_c[jt+cols_b*i+2]=mat_c[jt+cols_b*i+2]+mat_a[cols_a*i+kt+3]*mat_b[cols_b*(kt+3)+jt+2];
          mat_c[jt+cols_b*i+2]=mat_c[jt+cols_b*i+2]+mat_a[cols_a*i+kt+4]*mat_b[cols_b*(kt+4)+jt+2];
          mat_c[jt+cols_b*i+2]=mat_c[jt+cols_b*i+2]+mat_a[cols_a*i+kt+5]*mat_b[cols_b*(kt+5)+jt+2];
          mat_c[jt+cols_b*i+3]=mat_c[jt+cols_b*i+3]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+jt+3];
          mat_c[jt+cols_b*i+3]=mat_c[jt+cols_b*i+3]+mat_a[cols_a*i+kt+1]*mat_b[cols_b*(kt+1)+jt+3];
          mat_c[jt+cols_b*i+3]=mat_c[jt+cols_b*i+3]+mat_a[cols_a*i+kt+2]*mat_b[cols_b*(kt+2)+jt+3];
          mat_c[jt+cols_b*i+3]=mat_c[jt+cols_b*i+3]+mat_a[cols_a*i+kt+3]*mat_b[cols_b*(kt+3)+jt+3];
          mat_c[jt+cols_b*i+3]=mat_c[jt+cols_b*i+3]+mat_a[cols_a*i+kt+4]*mat_b[cols_b*(kt+4)+jt+3];
          mat_c[jt+cols_b*i+3]=mat_c[jt+cols_b*i+3]+mat_a[cols_a*i+kt+5]*mat_b[cols_b*(kt+5)+jt+3];
          mat_c[jt+cols_b*i+4]=mat_c[jt+cols_b*i+4]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+jt+4];
          mat_c[jt+cols_b*i+4]=mat_c[jt+cols_b*i+4]+mat_a[cols_a*i+kt+1]*mat_b[cols_b*(kt+1)+jt+4];
          mat_c[jt+cols_b*i+4]=mat_c[jt+cols_b*i+4]+mat_a[cols_a*i+kt+2]*mat_b[cols_b*(kt+2)+jt+4];
          mat_c[jt+cols_b*i+4]=mat_c[jt+cols_b*i+4]+mat_a[cols_a*i+kt+3]*mat_b[cols_b*(kt+3)+jt+4];
          mat_c[jt+cols_b*i+4]=mat_c[jt+cols_b*i+4]+mat_a[cols_a*i+kt+4]*mat_b[cols_b*(kt+4)+jt+4];
          mat_c[jt+cols_b*i+4]=mat_c[jt+cols_b*i+4]+mat_a[cols_a*i+kt+5]*mat_b[cols_b*(kt+5)+jt+4];
          mat_c[jt+cols_b*i+5]=mat_c[jt+cols_b*i+5]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+jt+5];
          mat_c[jt+cols_b*i+5]=mat_c[jt+cols_b*i+5]+mat_a[cols_a*i+kt+1]*mat_b[cols_b*(kt+1)+jt+5];
          mat_c[jt+cols_b*i+5]=mat_c[jt+cols_b*i+5]+mat_a[cols_a*i+kt+2]*mat_b[cols_b*(kt+2)+jt+5];
          mat_c[jt+cols_b*i+5]=mat_c[jt+cols_b*i+5]+mat_a[cols_a*i+kt+3]*mat_b[cols_b*(kt+3)+jt+5];
          mat_c[jt+cols_b*i+5]=mat_c[jt+cols_b*i+5]+mat_a[cols_a*i+kt+4]*mat_b[cols_b*(kt+4)+jt+5];
          mat_c[jt+cols_b*i+5]=mat_c[jt+cols_b*i+5]+mat_a[cols_a*i+kt+5]*mat_b[cols_b*(kt+5)+jt+5];
          mat_c[jt+cols_b*(i+1)]=mat_c[jt+cols_b*(i+1)]+mat_a[cols_a*(i+1)+kt]*mat_b[cols_b*kt+jt];
          mat_c[jt+cols_b*(i+1)]=mat_c[jt+cols_b*(i+1)]+mat_a[cols_a*(i+1)+kt+1]*mat_b[cols_b*(kt+1)+jt];
          mat_c[jt+cols_b*(i+1)]=mat_c[jt+cols_b*(i+1)]+mat_a[cols_a*(i+1)+kt+2]*mat_b[cols_b*(kt+2)+jt];
          mat_c[jt+cols_b*(i+1)]=mat_c[jt+cols_b*(i+1)]+mat_a[cols_a*(i+1)+kt+3]*mat_b[cols_b*(kt+3)+jt];
          mat_c[jt+cols_b*(i+1)]=mat_c[jt+cols_b*(i+1)]+mat_a[cols_a*(i+1)+kt+4]*mat_b[cols_b*(kt+4)+jt];
          mat_c[jt+cols_b*(i+1)]=mat_c[jt+cols_b*(i+1)]+mat_a[cols_a*(i+1)+kt+5]*mat_b[cols_b*(kt+5)+jt];
          mat_c[jt+cols_b*(i+1)+1]=mat_c[jt+cols_b*(i+1)+1]+mat_a[cols_a*(i+1)+kt]*mat_b[cols_b*kt+jt+1];
          mat_c[jt+cols_b*(i+1)+1]=mat_c[jt+cols_b*(i+1)+1]+mat_a[cols_a*(i+1)+kt+1]*mat_b[cols_b*(kt+1)+jt+1];
          mat_c[jt+cols_b*(i+1)+1]=mat_c[jt+cols_b*(i+1)+1]+mat_a[cols_a*(i+1)+kt+2]*mat_b[cols_b*(kt+2)+jt+1];
          mat_c[jt+cols_b*(i+1)+1]=mat_c[jt+cols_b*(i+1)+1]+mat_a[cols_a*(i+1)+kt+3]*mat_b[cols_b*(kt+3)+jt+1];
          mat_c[jt+cols_b*(i+1)+1]=mat_c[jt+cols_b*(i+1)+1]+mat_a[cols_a*(i+1)+kt+4]*mat_b[cols_b*(kt+4)+jt+1];
          mat_c[jt+cols_b*(i+1)+1]=mat_c[jt+cols_b*(i+1)+1]+mat_a[cols_a*(i+1)+kt+5]*mat_b[cols_b*(kt+5)+jt+1];
          mat_c[jt+cols_b*(i+1)+2]=mat_c[jt+cols_b*(i+1)+2]+mat_a[cols_a*(i+1)+kt]*mat_b[cols_b*kt+jt+2];
          mat_c[jt+cols_b*(i+1)+2]=mat_c[jt+cols_b*(i+1)+2]+mat_a[cols_a*(i+1)+kt+1]*mat_b[cols_b*(kt+1)+jt+2];
          mat_c[jt+cols_b*(i+1)+2]=mat_c[jt+cols_b*(i+1)+2]+mat_a[cols_a*(i+1)+kt+2]*mat_b[cols_b*(kt+2)+jt+2];
          mat_c[jt+cols_b*(i+1)+2]=mat_c[jt+cols_b*(i+1)+2]+mat_a[cols_a*(i+1)+kt+3]*mat_b[cols_b*(kt+3)+jt+2];
          mat_c[jt+cols_b*(i+1)+2]=mat_c[jt+cols_b*(i+1)+2]+mat_a[cols_a*(i+1)+kt+4]*mat_b[cols_b*(kt+4)+jt+2];
          mat_c[jt+cols_b*(i+1)+2]=mat_c[jt+cols_b*(i+1)+2]+mat_a[cols_a*(i+1)+kt+5]*mat_b[cols_b*(kt+5)+jt+2];
          mat_c[jt+cols_b*(i+1)+3]=mat_c[jt+cols_b*(i+1)+3]+mat_a[cols_a*(i+1)+kt]*mat_b[cols_b*kt+jt+3];
          mat_c[jt+cols_b*(i+1)+3]=mat_c[jt+cols_b*(i+1)+3]+mat_a[cols_a*(i+1)+kt+1]*mat_b[cols_b*(kt+1)+jt+3];
          mat_c[jt+cols_b*(i+1)+3]=mat_c[jt+cols_b*(i+1)+3]+mat_a[cols_a*(i+1)+kt+2]*mat_b[cols_b*(kt+2)+jt+3];
          mat_c[jt+cols_b*(i+1)+3]=mat_c[jt+cols_b*(i+1)+3]+mat_a[cols_a*(i+1)+kt+3]*mat_b[cols_b*(kt+3)+jt+3];
          mat_c[jt+cols_b*(i+1)+3]=mat_c[jt+cols_b*(i+1)+3]+mat_a[cols_a*(i+1)+kt+4]*mat_b[cols_b*(kt+4)+jt+3];
          mat_c[jt+cols_b*(i+1)+3]=mat_c[jt+cols_b*(i+1)+3]+mat_a[cols_a*(i+1)+kt+5]*mat_b[cols_b*(kt+5)+jt+3];
          mat_c[jt+cols_b*(i+1)+4]=mat_c[jt+cols_b*(i+1)+4]+mat_a[cols_a*(i+1)+kt]*mat_b[cols_b*kt+jt+4];
          mat_c[jt+cols_b*(i+1)+4]=mat_c[jt+cols_b*(i+1)+4]+mat_a[cols_a*(i+1)+kt+1]*mat_b[cols_b*(kt+1)+jt+4];
          mat_c[jt+cols_b*(i+1)+4]=mat_c[jt+cols_b*(i+1)+4]+mat_a[cols_a*(i+1)+kt+2]*mat_b[cols_b*(kt+2)+jt+4];
          mat_c[jt+cols_b*(i+1)+4]=mat_c[jt+cols_b*(i+1)+4]+mat_a[cols_a*(i+1)+kt+3]*mat_b[cols_b*(kt+3)+jt+4];
          mat_c[jt+cols_b*(i+1)+4]=mat_c[jt+cols_b*(i+1)+4]+mat_a[cols_a*(i+1)+kt+4]*mat_b[cols_b*(kt+4)+jt+4];
          mat_c[jt+cols_b*(i+1)+4]=mat_c[jt+cols_b*(i+1)+4]+mat_a[cols_a*(i+1)+kt+5]*mat_b[cols_b*(kt+5)+jt+4];
          mat_c[jt+cols_b*(i+1)+5]=mat_c[jt+cols_b*(i+1)+5]+mat_a[cols_a*(i+1)+kt]*mat_b[cols_b*kt+jt+5];
          mat_c[jt+cols_b*(i+1)+5]=mat_c[jt+cols_b*(i+1)+5]+mat_a[cols_a*(i+1)+kt+1]*mat_b[cols_b*(kt+1)+jt+5];
          mat_c[jt+cols_b*(i+1)+5]=mat_c[jt+cols_b*(i+1)+5]+mat_a[cols_a*(i+1)+kt+2]*mat_b[cols_b*(kt+2)+jt+5];
          mat_c[jt+cols_b*(i+1)+5]=mat_c[jt+cols_b*(i+1)+5]+mat_a[cols_a*(i+1)+kt+3]*mat_b[cols_b*(kt+3)+jt+5];
          mat_c[jt+cols_b*(i+1)+5]=mat_c[jt+cols_b*(i+1)+5]+mat_a[cols_a*(i+1)+kt+4]*mat_b[cols_b*(kt+4)+jt+5];
          mat_c[jt+cols_b*(i+1)+5]=mat_c[jt+cols_b*(i+1)+5]+mat_a[cols_a*(i+1)+kt+5]*mat_b[cols_b*(kt+5)+jt+5];
          mat_c[jt+cols_b*(i+2)]=mat_c[jt+cols_b*(i+2)]+mat_a[cols_a*(i+2)+kt]*mat_b[cols_b*kt+jt];
          mat_c[jt+cols_b*(i+2)]=mat_c[jt+cols_b*(i+2)]+mat_a[cols_a*(i+2)+kt+1]*mat_b[cols_b*(kt+1)+jt];
          mat_c[jt+cols_b*(i+2)]=mat_c[jt+cols_b*(i+2)]+mat_a[cols_a*(i+2)+kt+2]*mat_b[cols_b*(kt+2)+jt];
          mat_c[jt+cols_b*(i+2)]=mat_c[jt+cols_b*(i+2)]+mat_a[cols_a*(i+2)+kt+3]*mat_b[cols_b*(kt+3)+jt];
          mat_c[jt+cols_b*(i+2)]=mat_c[jt+cols_b*(i+2)]+mat_a[cols_a*(i+2)+kt+4]*mat_b[cols_b*(kt+4)+jt];
          mat_c[jt+cols_b*(i+2)]=mat_c[jt+cols_b*(i+2)]+mat_a[cols_a*(i+2)+kt+5]*mat_b[cols_b*(kt+5)+jt];
          mat_c[jt+cols_b*(i+2)+1]=mat_c[jt+cols_b*(i+2)+1]+mat_a[cols_a*(i+2)+kt]*mat_b[cols_b*kt+jt+1];
          mat_c[jt+cols_b*(i+2)+1]=mat_c[jt+cols_b*(i+2)+1]+mat_a[cols_a*(i+2)+kt+1]*mat_b[cols_b*(kt+1)+jt+1];
          mat_c[jt+cols_b*(i+2)+1]=mat_c[jt+cols_b*(i+2)+1]+mat_a[cols_a*(i+2)+kt+2]*mat_b[cols_b*(kt+2)+jt+1];
          mat_c[jt+cols_b*(i+2)+1]=mat_c[jt+cols_b*(i+2)+1]+mat_a[cols_a*(i+2)+kt+3]*mat_b[cols_b*(kt+3)+jt+1];
          mat_c[jt+cols_b*(i+2)+1]=mat_c[jt+cols_b*(i+2)+1]+mat_a[cols_a*(i+2)+kt+4]*mat_b[cols_b*(kt+4)+jt+1];
          mat_c[jt+cols_b*(i+2)+1]=mat_c[jt+cols_b*(i+2)+1]+mat_a[cols_a*(i+2)+kt+5]*mat_b[cols_b*(kt+5)+jt+1];
          mat_c[jt+cols_b*(i+2)+2]=mat_c[jt+cols_b*(i+2)+2]+mat_a[cols_a*(i+2)+kt]*mat_b[cols_b*kt+jt+2];
          mat_c[jt+cols_b*(i+2)+2]=mat_c[jt+cols_b*(i+2)+2]+mat_a[cols_a*(i+2)+kt+1]*mat_b[cols_b*(kt+1)+jt+2];
          mat_c[jt+cols_b*(i+2)+2]=mat_c[jt+cols_b*(i+2)+2]+mat_a[cols_a*(i+2)+kt+2]*mat_b[cols_b*(kt+2)+jt+2];
          mat_c[jt+cols_b*(i+2)+2]=mat_c[jt+cols_b*(i+2)+2]+mat_a[cols_a*(i+2)+kt+3]*mat_b[cols_b*(kt+3)+jt+2];
          mat_c[jt+cols_b*(i+2)+2]=mat_c[jt+cols_b*(i+2)+2]+mat_a[cols_a*(i+2)+kt+4]*mat_b[cols_b*(kt+4)+jt+2];
          mat_c[jt+cols_b*(i+2)+2]=mat_c[jt+cols_b*(i+2)+2]+mat_a[cols_a*(i+2)+kt+5]*mat_b[cols_b*(kt+5)+jt+2];
          mat_c[jt+cols_b*(i+2)+3]=mat_c[jt+cols_b*(i+2)+3]+mat_a[cols_a*(i+2)+kt]*mat_b[cols_b*kt+jt+3];
          mat_c[jt+cols_b*(i+2)+3]=mat_c[jt+cols_b*(i+2)+3]+mat_a[cols_a*(i+2)+kt+1]*mat_b[cols_b*(kt+1)+jt+3];
          mat_c[jt+cols_b*(i+2)+3]=mat_c[jt+cols_b*(i+2)+3]+mat_a[cols_a*(i+2)+kt+2]*mat_b[cols_b*(kt+2)+jt+3];
          mat_c[jt+cols_b*(i+2)+3]=mat_c[jt+cols_b*(i+2)+3]+mat_a[cols_a*(i+2)+kt+3]*mat_b[cols_b*(kt+3)+jt+3];
          mat_c[jt+cols_b*(i+2)+3]=mat_c[jt+cols_b*(i+2)+3]+mat_a[cols_a*(i+2)+kt+4]*mat_b[cols_b*(kt+4)+jt+3];
          mat_c[jt+cols_b*(i+2)+3]=mat_c[jt+cols_b*(i+2)+3]+mat_a[cols_a*(i+2)+kt+5]*mat_b[cols_b*(kt+5)+jt+3];
          mat_c[jt+cols_b*(i+2)+4]=mat_c[jt+cols_b*(i+2)+4]+mat_a[cols_a*(i+2)+kt]*mat_b[cols_b*kt+jt+4];
          mat_c[jt+cols_b*(i+2)+4]=mat_c[jt+cols_b*(i+2)+4]+mat_a[cols_a*(i+2)+kt+1]*mat_b[cols_b*(kt+1)+jt+4];
          mat_c[jt+cols_b*(i+2)+4]=mat_c[jt+cols_b*(i+2)+4]+mat_a[cols_a*(i+2)+kt+2]*mat_b[cols_b*(kt+2)+jt+4];
          mat_c[jt+cols_b*(i+2)+4]=mat_c[jt+cols_b*(i+2)+4]+mat_a[cols_a*(i+2)+kt+3]*mat_b[cols_b*(kt+3)+jt+4];
          mat_c[jt+cols_b*(i+2)+4]=mat_c[jt+cols_b*(i+2)+4]+mat_a[cols_a*(i+2)+kt+4]*mat_b[cols_b*(kt+4)+jt+4];
          mat_c[jt+cols_b*(i+2)+4]=mat_c[jt+cols_b*(i+2)+4]+mat_a[cols_a*(i+2)+kt+5]*mat_b[cols_b*(kt+5)+jt+4];
          mat_c[jt+cols_b*(i+2)+5]=mat_c[jt+cols_b*(i+2)+5]+mat_a[cols_a*(i+2)+kt]*mat_b[cols_b*kt+jt+5];
          mat_c[jt+cols_b*(i+2)+5]=mat_c[jt+cols_b*(i+2)+5]+mat_a[cols_a*(i+2)+kt+1]*mat_b[cols_b*(kt+1)+jt+5];
          mat_c[jt+cols_b*(i+2)+5]=mat_c[jt+cols_b*(i+2)+5]+mat_a[cols_a*(i+2)+kt+2]*mat_b[cols_b*(kt+2)+jt+5];
          mat_c[jt+cols_b*(i+2)+5]=mat_c[jt+cols_b*(i+2)+5]+mat_a[cols_a*(i+2)+kt+3]*mat_b[cols_b*(kt+3)+jt+5];
          mat_c[jt+cols_b*(i+2)+5]=mat_c[jt+cols_b*(i+2)+5]+mat_a[cols_a*(i+2)+kt+4]*mat_b[cols_b*(kt+4)+jt+5];
          mat_c[jt+cols_b*(i+2)+5]=mat_c[jt+cols_b*(i+2)+5]+mat_a[cols_a*(i+2)+kt+5]*mat_b[cols_b*(kt+5)+jt+5];
        }
        {
          int k;
          for (k=kt; k<=cols_a-5; k=k+5) {
            mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt];
            mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt+1];
            mat_c[jt+cols_b*i+2]=mat_c[jt+cols_b*i+2]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt+2];
            mat_c[jt+cols_b*i+3]=mat_c[jt+cols_b*i+3]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt+3];
            mat_c[jt+cols_b*i+4]=mat_c[jt+cols_b*i+4]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt+4];
            mat_c[jt+cols_b*i+5]=mat_c[jt+cols_b*i+5]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt+5];
            mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+jt];
            mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+jt+1];
            mat_c[jt+cols_b*i+2]=mat_c[jt+cols_b*i+2]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+jt+2];
            mat_c[jt+cols_b*i+3]=mat_c[jt+cols_b*i+3]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+jt+3];
            mat_c[jt+cols_b*i+4]=mat_c[jt+cols_b*i+4]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+jt+4];
            mat_c[jt+cols_b*i+5]=mat_c[jt+cols_b*i+5]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+jt+5];
            mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+jt];
            mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+jt+1];
            mat_c[jt+cols_b*i+2]=mat_c[jt+cols_b*i+2]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+jt+2];
            mat_c[jt+cols_b*i+3]=mat_c[jt+cols_b*i+3]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+jt+3];
            mat_c[jt+cols_b*i+4]=mat_c[jt+cols_b*i+4]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+jt+4];
            mat_c[jt+cols_b*i+5]=mat_c[jt+cols_b*i+5]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+jt+5];
            mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+jt];
            mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+jt+1];
            mat_c[jt+cols_b*i+2]=mat_c[jt+cols_b*i+2]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+jt+2];
            mat_c[jt+cols_b*i+3]=mat_c[jt+cols_b*i+3]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+jt+3];
            mat_c[jt+cols_b*i+4]=mat_c[jt+cols_b*i+4]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+jt+4];
            mat_c[jt+cols_b*i+5]=mat_c[jt+cols_b*i+5]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+jt+5];
            mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k+4]*mat_b[cols_b*(k+4)+jt];
            mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k+4]*mat_b[cols_b*(k+4)+jt+1];
            mat_c[jt+cols_b*i+2]=mat_c[jt+cols_b*i+2]+mat_a[cols_a*i+k+4]*mat_b[cols_b*(k+4)+jt+2];
            mat_c[jt+cols_b*i+3]=mat_c[jt+cols_b*i+3]+mat_a[cols_a*i+k+4]*mat_b[cols_b*(k+4)+jt+3];
            mat_c[jt+cols_b*i+4]=mat_c[jt+cols_b*i+4]+mat_a[cols_a*i+k+4]*mat_b[cols_b*(k+4)+jt+4];
            mat_c[jt+cols_b*i+5]=mat_c[jt+cols_b*i+5]+mat_a[cols_a*i+k+4]*mat_b[cols_b*(k+4)+jt+5];
          }
          for (k=cols_a-((cols_a-(kt))%5); k<=cols_a-1; k=k+1) {
            mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt];
            mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt+1];
            mat_c[jt+cols_b*i+2]=mat_c[jt+cols_b*i+2]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt+2];
            mat_c[jt+cols_b*i+3]=mat_c[jt+cols_b*i+3]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt+3];
            mat_c[jt+cols_b*i+4]=mat_c[jt+cols_b*i+4]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt+4];
            mat_c[jt+cols_b*i+5]=mat_c[jt+cols_b*i+5]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt+5];
          }
        }
        {
          int k;
          for (k=kt; k<=cols_a-5; k=k+5) {
            mat_c[jt+cols_b*(i+1)]=mat_c[jt+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k]*mat_b[cols_b*k+jt];
            mat_c[jt+cols_b*(i+1)+1]=mat_c[jt+cols_b*(i+1)+1]+mat_a[cols_a*(i+1)+k]*mat_b[cols_b*k+jt+1];
            mat_c[jt+cols_b*(i+1)+2]=mat_c[jt+cols_b*(i+1)+2]+mat_a[cols_a*(i+1)+k]*mat_b[cols_b*k+jt+2];
            mat_c[jt+cols_b*(i+1)+3]=mat_c[jt+cols_b*(i+1)+3]+mat_a[cols_a*(i+1)+k]*mat_b[cols_b*k+jt+3];
            mat_c[jt+cols_b*(i+1)+4]=mat_c[jt+cols_b*(i+1)+4]+mat_a[cols_a*(i+1)+k]*mat_b[cols_b*k+jt+4];
            mat_c[jt+cols_b*(i+1)+5]=mat_c[jt+cols_b*(i+1)+5]+mat_a[cols_a*(i+1)+k]*mat_b[cols_b*k+jt+5];
            mat_c[jt+cols_b*(i+1)]=mat_c[jt+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k+1]*mat_b[cols_b*(k+1)+jt];
            mat_c[jt+cols_b*(i+1)+1]=mat_c[jt+cols_b*(i+1)+1]+mat_a[cols_a*(i+1)+k+1]*mat_b[cols_b*(k+1)+jt+1];
            mat_c[jt+cols_b*(i+1)+2]=mat_c[jt+cols_b*(i+1)+2]+mat_a[cols_a*(i+1)+k+1]*mat_b[cols_b*(k+1)+jt+2];
            mat_c[jt+cols_b*(i+1)+3]=mat_c[jt+cols_b*(i+1)+3]+mat_a[cols_a*(i+1)+k+1]*mat_b[cols_b*(k+1)+jt+3];
            mat_c[jt+cols_b*(i+1)+4]=mat_c[jt+cols_b*(i+1)+4]+mat_a[cols_a*(i+1)+k+1]*mat_b[cols_b*(k+1)+jt+4];
            mat_c[jt+cols_b*(i+1)+5]=mat_c[jt+cols_b*(i+1)+5]+mat_a[cols_a*(i+1)+k+1]*mat_b[cols_b*(k+1)+jt+5];
            mat_c[jt+cols_b*(i+1)]=mat_c[jt+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k+2]*mat_b[cols_b*(k+2)+jt];
            mat_c[jt+cols_b*(i+1)+1]=mat_c[jt+cols_b*(i+1)+1]+mat_a[cols_a*(i+1)+k+2]*mat_b[cols_b*(k+2)+jt+1];
            mat_c[jt+cols_b*(i+1)+2]=mat_c[jt+cols_b*(i+1)+2]+mat_a[cols_a*(i+1)+k+2]*mat_b[cols_b*(k+2)+jt+2];
            mat_c[jt+cols_b*(i+1)+3]=mat_c[jt+cols_b*(i+1)+3]+mat_a[cols_a*(i+1)+k+2]*mat_b[cols_b*(k+2)+jt+3];
            mat_c[jt+cols_b*(i+1)+4]=mat_c[jt+cols_b*(i+1)+4]+mat_a[cols_a*(i+1)+k+2]*mat_b[cols_b*(k+2)+jt+4];
            mat_c[jt+cols_b*(i+1)+5]=mat_c[jt+cols_b*(i+1)+5]+mat_a[cols_a*(i+1)+k+2]*mat_b[cols_b*(k+2)+jt+5];
            mat_c[jt+cols_b*(i+1)]=mat_c[jt+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k+3]*mat_b[cols_b*(k+3)+jt];
            mat_c[jt+cols_b*(i+1)+1]=mat_c[jt+cols_b*(i+1)+1]+mat_a[cols_a*(i+1)+k+3]*mat_b[cols_b*(k+3)+jt+1];
            mat_c[jt+cols_b*(i+1)+2]=mat_c[jt+cols_b*(i+1)+2]+mat_a[cols_a*(i+1)+k+3]*mat_b[cols_b*(k+3)+jt+2];
            mat_c[jt+cols_b*(i+1)+3]=mat_c[jt+cols_b*(i+1)+3]+mat_a[cols_a*(i+1)+k+3]*mat_b[cols_b*(k+3)+jt+3];
            mat_c[jt+cols_b*(i+1)+4]=mat_c[jt+cols_b*(i+1)+4]+mat_a[cols_a*(i+1)+k+3]*mat_b[cols_b*(k+3)+jt+4];
            mat_c[jt+cols_b*(i+1)+5]=mat_c[jt+cols_b*(i+1)+5]+mat_a[cols_a*(i+1)+k+3]*mat_b[cols_b*(k+3)+jt+5];
            mat_c[jt+cols_b*(i+1)]=mat_c[jt+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k+4]*mat_b[cols_b*(k+4)+jt];
            mat_c[jt+cols_b*(i+1)+1]=mat_c[jt+cols_b*(i+1)+1]+mat_a[cols_a*(i+1)+k+4]*mat_b[cols_b*(k+4)+jt+1];
            mat_c[jt+cols_b*(i+1)+2]=mat_c[jt+cols_b*(i+1)+2]+mat_a[cols_a*(i+1)+k+4]*mat_b[cols_b*(k+4)+jt+2];
            mat_c[jt+cols_b*(i+1)+3]=mat_c[jt+cols_b*(i+1)+3]+mat_a[cols_a*(i+1)+k+4]*mat_b[cols_b*(k+4)+jt+3];
            mat_c[jt+cols_b*(i+1)+4]=mat_c[jt+cols_b*(i+1)+4]+mat_a[cols_a*(i+1)+k+4]*mat_b[cols_b*(k+4)+jt+4];
            mat_c[jt+cols_b*(i+1)+5]=mat_c[jt+cols_b*(i+1)+5]+mat_a[cols_a*(i+1)+k+4]*mat_b[cols_b*(k+4)+jt+5];
          }
          for (k=cols_a-((cols_a-(kt))%5); k<=cols_a-1; k=k+1) {
            mat_c[jt+cols_b*(i+1)]=mat_c[jt+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k]*mat_b[cols_b*k+jt];
            mat_c[jt+cols_b*(i+1)+1]=mat_c[jt+cols_b*(i+1)+1]+mat_a[cols_a*(i+1)+k]*mat_b[cols_b*k+jt+1];
            mat_c[jt+cols_b*(i+1)+2]=mat_c[jt+cols_b*(i+1)+2]+mat_a[cols_a*(i+1)+k]*mat_b[cols_b*k+jt+2];
            mat_c[jt+cols_b*(i+1)+3]=mat_c[jt+cols_b*(i+1)+3]+mat_a[cols_a*(i+1)+k]*mat_b[cols_b*k+jt+3];
            mat_c[jt+cols_b*(i+1)+4]=mat_c[jt+cols_b*(i+1)+4]+mat_a[cols_a*(i+1)+k]*mat_b[cols_b*k+jt+4];
            mat_c[jt+cols_b*(i+1)+5]=mat_c[jt+cols_b*(i+1)+5]+mat_a[cols_a*(i+1)+k]*mat_b[cols_b*k+jt+5];
          }
        }
        {
          int k;
          for (k=kt; k<=cols_a-5; k=k+5) {
            mat_c[jt+cols_b*(i+2)]=mat_c[jt+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k]*mat_b[cols_b*k+jt];
            mat_c[jt+cols_b*(i+2)+1]=mat_c[jt+cols_b*(i+2)+1]+mat_a[cols_a*(i+2)+k]*mat_b[cols_b*k+jt+1];
            mat_c[jt+cols_b*(i+2)+2]=mat_c[jt+cols_b*(i+2)+2]+mat_a[cols_a*(i+2)+k]*mat_b[cols_b*k+jt+2];
            mat_c[jt+cols_b*(i+2)+3]=mat_c[jt+cols_b*(i+2)+3]+mat_a[cols_a*(i+2)+k]*mat_b[cols_b*k+jt+3];
            mat_c[jt+cols_b*(i+2)+4]=mat_c[jt+cols_b*(i+2)+4]+mat_a[cols_a*(i+2)+k]*mat_b[cols_b*k+jt+4];
            mat_c[jt+cols_b*(i+2)+5]=mat_c[jt+cols_b*(i+2)+5]+mat_a[cols_a*(i+2)+k]*mat_b[cols_b*k+jt+5];
            mat_c[jt+cols_b*(i+2)]=mat_c[jt+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k+1]*mat_b[cols_b*(k+1)+jt];
            mat_c[jt+cols_b*(i+2)+1]=mat_c[jt+cols_b*(i+2)+1]+mat_a[cols_a*(i+2)+k+1]*mat_b[cols_b*(k+1)+jt+1];
            mat_c[jt+cols_b*(i+2)+2]=mat_c[jt+cols_b*(i+2)+2]+mat_a[cols_a*(i+2)+k+1]*mat_b[cols_b*(k+1)+jt+2];
            mat_c[jt+cols_b*(i+2)+3]=mat_c[jt+cols_b*(i+2)+3]+mat_a[cols_a*(i+2)+k+1]*mat_b[cols_b*(k+1)+jt+3];
            mat_c[jt+cols_b*(i+2)+4]=mat_c[jt+cols_b*(i+2)+4]+mat_a[cols_a*(i+2)+k+1]*mat_b[cols_b*(k+1)+jt+4];
            mat_c[jt+cols_b*(i+2)+5]=mat_c[jt+cols_b*(i+2)+5]+mat_a[cols_a*(i+2)+k+1]*mat_b[cols_b*(k+1)+jt+5];
            mat_c[jt+cols_b*(i+2)]=mat_c[jt+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k+2]*mat_b[cols_b*(k+2)+jt];
            mat_c[jt+cols_b*(i+2)+1]=mat_c[jt+cols_b*(i+2)+1]+mat_a[cols_a*(i+2)+k+2]*mat_b[cols_b*(k+2)+jt+1];
            mat_c[jt+cols_b*(i+2)+2]=mat_c[jt+cols_b*(i+2)+2]+mat_a[cols_a*(i+2)+k+2]*mat_b[cols_b*(k+2)+jt+2];
            mat_c[jt+cols_b*(i+2)+3]=mat_c[jt+cols_b*(i+2)+3]+mat_a[cols_a*(i+2)+k+2]*mat_b[cols_b*(k+2)+jt+3];
            mat_c[jt+cols_b*(i+2)+4]=mat_c[jt+cols_b*(i+2)+4]+mat_a[cols_a*(i+2)+k+2]*mat_b[cols_b*(k+2)+jt+4];
            mat_c[jt+cols_b*(i+2)+5]=mat_c[jt+cols_b*(i+2)+5]+mat_a[cols_a*(i+2)+k+2]*mat_b[cols_b*(k+2)+jt+5];
            mat_c[jt+cols_b*(i+2)]=mat_c[jt+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k+3]*mat_b[cols_b*(k+3)+jt];
            mat_c[jt+cols_b*(i+2)+1]=mat_c[jt+cols_b*(i+2)+1]+mat_a[cols_a*(i+2)+k+3]*mat_b[cols_b*(k+3)+jt+1];
            mat_c[jt+cols_b*(i+2)+2]=mat_c[jt+cols_b*(i+2)+2]+mat_a[cols_a*(i+2)+k+3]*mat_b[cols_b*(k+3)+jt+2];
            mat_c[jt+cols_b*(i+2)+3]=mat_c[jt+cols_b*(i+2)+3]+mat_a[cols_a*(i+2)+k+3]*mat_b[cols_b*(k+3)+jt+3];
            mat_c[jt+cols_b*(i+2)+4]=mat_c[jt+cols_b*(i+2)+4]+mat_a[cols_a*(i+2)+k+3]*mat_b[cols_b*(k+3)+jt+4];
            mat_c[jt+cols_b*(i+2)+5]=mat_c[jt+cols_b*(i+2)+5]+mat_a[cols_a*(i+2)+k+3]*mat_b[cols_b*(k+3)+jt+5];
            mat_c[jt+cols_b*(i+2)]=mat_c[jt+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k+4]*mat_b[cols_b*(k+4)+jt];
            mat_c[jt+cols_b*(i+2)+1]=mat_c[jt+cols_b*(i+2)+1]+mat_a[cols_a*(i+2)+k+4]*mat_b[cols_b*(k+4)+jt+1];
            mat_c[jt+cols_b*(i+2)+2]=mat_c[jt+cols_b*(i+2)+2]+mat_a[cols_a*(i+2)+k+4]*mat_b[cols_b*(k+4)+jt+2];
            mat_c[jt+cols_b*(i+2)+3]=mat_c[jt+cols_b*(i+2)+3]+mat_a[cols_a*(i+2)+k+4]*mat_b[cols_b*(k+4)+jt+3];
            mat_c[jt+cols_b*(i+2)+4]=mat_c[jt+cols_b*(i+2)+4]+mat_a[cols_a*(i+2)+k+4]*mat_b[cols_b*(k+4)+jt+4];
            mat_c[jt+cols_b*(i+2)+5]=mat_c[jt+cols_b*(i+2)+5]+mat_a[cols_a*(i+2)+k+4]*mat_b[cols_b*(k+4)+jt+5];
          }
          for (k=cols_a-((cols_a-(kt))%5); k<=cols_a-1; k=k+1) {
            mat_c[jt+cols_b*(i+2)]=mat_c[jt+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k]*mat_b[cols_b*k+jt];
            mat_c[jt+cols_b*(i+2)+1]=mat_c[jt+cols_b*(i+2)+1]+mat_a[cols_a*(i+2)+k]*mat_b[cols_b*k+jt+1];
            mat_c[jt+cols_b*(i+2)+2]=mat_c[jt+cols_b*(i+2)+2]+mat_a[cols_a*(i+2)+k]*mat_b[cols_b*k+jt+2];
            mat_c[jt+cols_b*(i+2)+3]=mat_c[jt+cols_b*(i+2)+3]+mat_a[cols_a*(i+2)+k]*mat_b[cols_b*k+jt+3];
            mat_c[jt+cols_b*(i+2)+4]=mat_c[jt+cols_b*(i+2)+4]+mat_a[cols_a*(i+2)+k]*mat_b[cols_b*k+jt+4];
            mat_c[jt+cols_b*(i+2)+5]=mat_c[jt+cols_b*(i+2)+5]+mat_a[cols_a*(i+2)+k]*mat_b[cols_b*k+jt+5];
          }
        }
      }
      for (j=jt; j<=cols_b-1; j=j+1) {
        for (kt=0; kt<=cols_a-6; kt=kt+6) {
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+kt+1]*mat_b[cols_b*(kt+1)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+kt+2]*mat_b[cols_b*(kt+2)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+kt+3]*mat_b[cols_b*(kt+3)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+kt+4]*mat_b[cols_b*(kt+4)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+kt+5]*mat_b[cols_b*(kt+5)+j];
          mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+kt]*mat_b[cols_b*kt+j];
          mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+kt+1]*mat_b[cols_b*(kt+1)+j];
          mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+kt+2]*mat_b[cols_b*(kt+2)+j];
          mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+kt+3]*mat_b[cols_b*(kt+3)+j];
          mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+kt+4]*mat_b[cols_b*(kt+4)+j];
          mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+kt+5]*mat_b[cols_b*(kt+5)+j];
          mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+kt]*mat_b[cols_b*kt+j];
          mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+kt+1]*mat_b[cols_b*(kt+1)+j];
          mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+kt+2]*mat_b[cols_b*(kt+2)+j];
          mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+kt+3]*mat_b[cols_b*(kt+3)+j];
          mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+kt+4]*mat_b[cols_b*(kt+4)+j];
          mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+kt+5]*mat_b[cols_b*(kt+5)+j];
        }
        {
          int k;
          for (k=kt; k<=cols_a-5; k=k+5) {
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+j];
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+j];
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+j];
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+4]*mat_b[cols_b*(k+4)+j];
          }
          for (k=cols_a-((cols_a-(kt))%5); k<=cols_a-1; k=k+1) 
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
        }
        {
          int k;
          for (k=kt; k<=cols_a-5; k=k+5) {
            mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k+1]*mat_b[cols_b*(k+1)+j];
            mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k+2]*mat_b[cols_b*(k+2)+j];
            mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k+3]*mat_b[cols_b*(k+3)+j];
            mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k+4]*mat_b[cols_b*(k+4)+j];
          }
          for (k=cols_a-((cols_a-(kt))%5); k<=cols_a-1; k=k+1) 
            mat_c[j+cols_b*(i+1)]=mat_c[j+cols_b*(i+1)]+mat_a[cols_a*(i+1)+k]*mat_b[cols_b*k+j];
        }
        {
          int k;
          for (k=kt; k<=cols_a-5; k=k+5) {
            mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k+1]*mat_b[cols_b*(k+1)+j];
            mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k+2]*mat_b[cols_b*(k+2)+j];
            mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k+3]*mat_b[cols_b*(k+3)+j];
            mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k+4]*mat_b[cols_b*(k+4)+j];
          }
          for (k=cols_a-((cols_a-(kt))%5); k<=cols_a-1; k=k+1) 
            mat_c[j+cols_b*(i+2)]=mat_c[j+cols_b*(i+2)]+mat_a[cols_a*(i+2)+k]*mat_b[cols_b*k+j];
        }
      }
    }
    for (i=rows_a-((rows_a-(0))%3); i<=rows_a-1; i=i+1) {
      for (jt=0; jt<=cols_b-6; jt=jt+6) {
        for (kt=0; kt<=cols_a-6; kt=kt+6) {
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+jt];
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+(kt+1)]*mat_b[cols_b*(kt+1)+jt];
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+(kt+2)]*mat_b[cols_b*(kt+2)+jt];
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+(kt+3)]*mat_b[cols_b*(kt+3)+jt];
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+(kt+4)]*mat_b[cols_b*(kt+4)+jt];
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+(kt+5)]*mat_b[cols_b*(kt+5)+jt];
          mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+(jt+1)];
          mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+(kt+1)]*mat_b[cols_b*(kt+1)+(jt+1)];
          mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+(kt+2)]*mat_b[cols_b*(kt+2)+(jt+1)];
          mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+(kt+3)]*mat_b[cols_b*(kt+3)+(jt+1)];
          mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+(kt+4)]*mat_b[cols_b*(kt+4)+(jt+1)];
          mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+(kt+5)]*mat_b[cols_b*(kt+5)+(jt+1)];
          mat_c[(jt+2)+cols_b*i]=mat_c[(jt+2)+cols_b*i]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+(jt+2)];
          mat_c[(jt+2)+cols_b*i]=mat_c[(jt+2)+cols_b*i]+mat_a[cols_a*i+(kt+1)]*mat_b[cols_b*(kt+1)+(jt+2)];
          mat_c[(jt+2)+cols_b*i]=mat_c[(jt+2)+cols_b*i]+mat_a[cols_a*i+(kt+2)]*mat_b[cols_b*(kt+2)+(jt+2)];
          mat_c[(jt+2)+cols_b*i]=mat_c[(jt+2)+cols_b*i]+mat_a[cols_a*i+(kt+3)]*mat_b[cols_b*(kt+3)+(jt+2)];
          mat_c[(jt+2)+cols_b*i]=mat_c[(jt+2)+cols_b*i]+mat_a[cols_a*i+(kt+4)]*mat_b[cols_b*(kt+4)+(jt+2)];
          mat_c[(jt+2)+cols_b*i]=mat_c[(jt+2)+cols_b*i]+mat_a[cols_a*i+(kt+5)]*mat_b[cols_b*(kt+5)+(jt+2)];
          mat_c[(jt+3)+cols_b*i]=mat_c[(jt+3)+cols_b*i]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+(jt+3)];
          mat_c[(jt+3)+cols_b*i]=mat_c[(jt+3)+cols_b*i]+mat_a[cols_a*i+(kt+1)]*mat_b[cols_b*(kt+1)+(jt+3)];
          mat_c[(jt+3)+cols_b*i]=mat_c[(jt+3)+cols_b*i]+mat_a[cols_a*i+(kt+2)]*mat_b[cols_b*(kt+2)+(jt+3)];
          mat_c[(jt+3)+cols_b*i]=mat_c[(jt+3)+cols_b*i]+mat_a[cols_a*i+(kt+3)]*mat_b[cols_b*(kt+3)+(jt+3)];
          mat_c[(jt+3)+cols_b*i]=mat_c[(jt+3)+cols_b*i]+mat_a[cols_a*i+(kt+4)]*mat_b[cols_b*(kt+4)+(jt+3)];
          mat_c[(jt+3)+cols_b*i]=mat_c[(jt+3)+cols_b*i]+mat_a[cols_a*i+(kt+5)]*mat_b[cols_b*(kt+5)+(jt+3)];
          mat_c[(jt+4)+cols_b*i]=mat_c[(jt+4)+cols_b*i]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+(jt+4)];
          mat_c[(jt+4)+cols_b*i]=mat_c[(jt+4)+cols_b*i]+mat_a[cols_a*i+(kt+1)]*mat_b[cols_b*(kt+1)+(jt+4)];
          mat_c[(jt+4)+cols_b*i]=mat_c[(jt+4)+cols_b*i]+mat_a[cols_a*i+(kt+2)]*mat_b[cols_b*(kt+2)+(jt+4)];
          mat_c[(jt+4)+cols_b*i]=mat_c[(jt+4)+cols_b*i]+mat_a[cols_a*i+(kt+3)]*mat_b[cols_b*(kt+3)+(jt+4)];
          mat_c[(jt+4)+cols_b*i]=mat_c[(jt+4)+cols_b*i]+mat_a[cols_a*i+(kt+4)]*mat_b[cols_b*(kt+4)+(jt+4)];
          mat_c[(jt+4)+cols_b*i]=mat_c[(jt+4)+cols_b*i]+mat_a[cols_a*i+(kt+5)]*mat_b[cols_b*(kt+5)+(jt+4)];
          mat_c[(jt+5)+cols_b*i]=mat_c[(jt+5)+cols_b*i]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+(jt+5)];
          mat_c[(jt+5)+cols_b*i]=mat_c[(jt+5)+cols_b*i]+mat_a[cols_a*i+(kt+1)]*mat_b[cols_b*(kt+1)+(jt+5)];
          mat_c[(jt+5)+cols_b*i]=mat_c[(jt+5)+cols_b*i]+mat_a[cols_a*i+(kt+2)]*mat_b[cols_b*(kt+2)+(jt+5)];
          mat_c[(jt+5)+cols_b*i]=mat_c[(jt+5)+cols_b*i]+mat_a[cols_a*i+(kt+3)]*mat_b[cols_b*(kt+3)+(jt+5)];
          mat_c[(jt+5)+cols_b*i]=mat_c[(jt+5)+cols_b*i]+mat_a[cols_a*i+(kt+4)]*mat_b[cols_b*(kt+4)+(jt+5)];
          mat_c[(jt+5)+cols_b*i]=mat_c[(jt+5)+cols_b*i]+mat_a[cols_a*i+(kt+5)]*mat_b[cols_b*(kt+5)+(jt+5)];
        }
        {
          int k;
          for (k=kt; k<=cols_a-5; k=k+5) {
            mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt];
            mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt+1];
            mat_c[jt+cols_b*i+2]=mat_c[jt+cols_b*i+2]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt+2];
            mat_c[jt+cols_b*i+3]=mat_c[jt+cols_b*i+3]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt+3];
            mat_c[jt+cols_b*i+4]=mat_c[jt+cols_b*i+4]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt+4];
            mat_c[jt+cols_b*i+5]=mat_c[jt+cols_b*i+5]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt+5];
            mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+jt];
            mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+jt+1];
            mat_c[jt+cols_b*i+2]=mat_c[jt+cols_b*i+2]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+jt+2];
            mat_c[jt+cols_b*i+3]=mat_c[jt+cols_b*i+3]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+jt+3];
            mat_c[jt+cols_b*i+4]=mat_c[jt+cols_b*i+4]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+jt+4];
            mat_c[jt+cols_b*i+5]=mat_c[jt+cols_b*i+5]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+jt+5];
            mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+jt];
            mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+jt+1];
            mat_c[jt+cols_b*i+2]=mat_c[jt+cols_b*i+2]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+jt+2];
            mat_c[jt+cols_b*i+3]=mat_c[jt+cols_b*i+3]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+jt+3];
            mat_c[jt+cols_b*i+4]=mat_c[jt+cols_b*i+4]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+jt+4];
            mat_c[jt+cols_b*i+5]=mat_c[jt+cols_b*i+5]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+jt+5];
            mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+jt];
            mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+jt+1];
            mat_c[jt+cols_b*i+2]=mat_c[jt+cols_b*i+2]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+jt+2];
            mat_c[jt+cols_b*i+3]=mat_c[jt+cols_b*i+3]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+jt+3];
            mat_c[jt+cols_b*i+4]=mat_c[jt+cols_b*i+4]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+jt+4];
            mat_c[jt+cols_b*i+5]=mat_c[jt+cols_b*i+5]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+jt+5];
            mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k+4]*mat_b[cols_b*(k+4)+jt];
            mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k+4]*mat_b[cols_b*(k+4)+jt+1];
            mat_c[jt+cols_b*i+2]=mat_c[jt+cols_b*i+2]+mat_a[cols_a*i+k+4]*mat_b[cols_b*(k+4)+jt+2];
            mat_c[jt+cols_b*i+3]=mat_c[jt+cols_b*i+3]+mat_a[cols_a*i+k+4]*mat_b[cols_b*(k+4)+jt+3];
            mat_c[jt+cols_b*i+4]=mat_c[jt+cols_b*i+4]+mat_a[cols_a*i+k+4]*mat_b[cols_b*(k+4)+jt+4];
            mat_c[jt+cols_b*i+5]=mat_c[jt+cols_b*i+5]+mat_a[cols_a*i+k+4]*mat_b[cols_b*(k+4)+jt+5];
          }
          for (k=cols_a-((cols_a-(kt))%5); k<=cols_a-1; k=k+1) {
            mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt];
            mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+(jt+1)];
            mat_c[(jt+2)+cols_b*i]=mat_c[(jt+2)+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+(jt+2)];
            mat_c[(jt+3)+cols_b*i]=mat_c[(jt+3)+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+(jt+3)];
            mat_c[(jt+4)+cols_b*i]=mat_c[(jt+4)+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+(jt+4)];
            mat_c[(jt+5)+cols_b*i]=mat_c[(jt+5)+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+(jt+5)];
          }
        }
      }
      for (j=jt; j<=cols_b-1; j=j+1) {
        for (kt=0; kt<=cols_a-6; kt=kt+6) {
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+(kt+1)]*mat_b[cols_b*(kt+1)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+(kt+2)]*mat_b[cols_b*(kt+2)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+(kt+3)]*mat_b[cols_b*(kt+3)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+(kt+4)]*mat_b[cols_b*(kt+4)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+(kt+5)]*mat_b[cols_b*(kt+5)+j];
        }
        {
          int k;
          for (k=kt; k<=cols_a-5; k=k+5) {
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+j];
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+j];
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+j];
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+4]*mat_b[cols_b*(k+4)+j];
          }
          for (k=cols_a-((cols_a-(kt))%5); k<=cols_a-1; k=k+1) 
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
        }
      }
    }
  }
/*@ end @*/
} else if ((rows_a<=12) && (cols_a<=6) && (cols_b<=12)) {

/**-- (Generated by Orio) 
Best performance cost: 
  [1.796e-06, 1.111e-06, 9.32e-07, 9.17e-07, 9.17e-07] 
Tuned for specific problem sizes: 
  cols_a = 6 
  cols_b = 12 
  rows_a = 12 
Best performance parameters: 
  CFLAGS = -O1 
  RT0_I = 1 
  RT0_J = 6 
  RT1_I = 1 
  RT1_J = 2 
  RT1_K = 6 
  U_I = 1 
  U_I0 = 2 
  U_J = 5 
  U_J0 = 2 
  U_K = 4 
  VEC = True 
--**/


  int i, j, k;  
  int it,jt, kt;
  int c_ind, a_row, c_row;


  /*@ begin Loop (  
    transform Composite(
      unrolljam = (['i','j'],[U_I0,U_J0]),
      vector = (VEC, ['ivdep','vector always']),
      regtile = (['i','j'],[RT0_I,RT0_J])
    )
    for (i = 0; i <= rows_a-1; i++) {
      for (j = 0; j <= cols_b-1; j++) {
        mat_c[j + cols_b * i] = 0;
      }
    } 

    transform Composite(
      unrolljam = (['i','j','k'],[U_I,U_J,U_K]),
      vector = (VEC, ['ivdep','vector always']),
      regtile = (['i','j','k'],[RT1_I,RT1_J,RT1_K])
    )
    for (i = 0; i <= rows_a-1; i++) {
      for (j = 0; j <= cols_b-1; j++) {
        for (k = 0; k <= cols_a-1; k++) {
          mat_c[j + cols_b * i] += mat_a[cols_a * i + k] * mat_b[cols_b * k + j];
        }
      } 
    }
  ) @*/
  {
    int i;
    for (i=0; i<=rows_a-2; i=i+2) {
      register int cbv_1;
      cbv_1=cols_b-6;
#pragma ivdep
#pragma vector always
      for (jt=0; jt<=cbv_1; jt=jt+6) {
        mat_c[jt+cols_b*i]=0;
        mat_c[jt+cols_b*i+1]=0;
        mat_c[jt+cols_b*i+2]=0;
        mat_c[jt+cols_b*i+3]=0;
        mat_c[jt+cols_b*i+4]=0;
        mat_c[jt+cols_b*i+5]=0;
        mat_c[jt+cols_b*(i+1)]=0;
        mat_c[jt+cols_b*(i+1)+1]=0;
        mat_c[jt+cols_b*(i+1)+2]=0;
        mat_c[jt+cols_b*(i+1)+3]=0;
        mat_c[jt+cols_b*(i+1)+4]=0;
        mat_c[jt+cols_b*(i+1)+5]=0;
      }
      {
        int j;
        register int cbv_2;
        cbv_2=cols_b-2;
#pragma ivdep
#pragma vector always
        for (j=jt; j<=cbv_2; j=j+2) {
          mat_c[j+cols_b*i]=0;
          mat_c[j+cols_b*i+1]=0;
        }
        register int cbv_3, cbv_4;
        cbv_3=cols_b-((cols_b-(jt))%2);
        cbv_4=cols_b-1;
#pragma ivdep
#pragma vector always
        for (j=cbv_3; j<=cbv_4; j=j+1) 
          mat_c[j+cols_b*i]=0;
      }
      {
        int j;
        register int cbv_5;
        cbv_5=cols_b-2;
#pragma ivdep
#pragma vector always
        for (j=jt; j<=cbv_5; j=j+2) {
          mat_c[j+cols_b*(i+1)]=0;
          mat_c[j+cols_b*(i+1)+1]=0;
        }
        register int cbv_6, cbv_7;
        cbv_6=cols_b-((cols_b-(jt))%2);
        cbv_7=cols_b-1;
#pragma ivdep
#pragma vector always
        for (j=cbv_6; j<=cbv_7; j=j+1) 
          mat_c[j+cols_b*(i+1)]=0;
      }
    }
    for (i=rows_a-((rows_a-(0))%2); i<=rows_a-1; i=i+1) {
      register int cbv_8;
      cbv_8=cols_b-6;
#pragma ivdep
#pragma vector always
      for (jt=0; jt<=cbv_8; jt=jt+6) {
        mat_c[jt+cols_b*i]=0;
        mat_c[(jt+1)+cols_b*i]=0;
        mat_c[(jt+2)+cols_b*i]=0;
        mat_c[(jt+3)+cols_b*i]=0;
        mat_c[(jt+4)+cols_b*i]=0;
        mat_c[(jt+5)+cols_b*i]=0;
      }
      {
        int j;
        register int cbv_9;
        cbv_9=cols_b-2;
#pragma ivdep
#pragma vector always
        for (j=jt; j<=cbv_9; j=j+2) {
          mat_c[j+cols_b*i]=0;
          mat_c[j+cols_b*i+1]=0;
        }
        register int cbv_10, cbv_11;
        cbv_10=cols_b-((cols_b-(jt))%2);
        cbv_11=cols_b-1;
#pragma ivdep
#pragma vector always
        for (j=cbv_10; j<=cbv_11; j=j+1) 
          mat_c[j+cols_b*i]=0;
      }
    }
  }
  for (i=0; i<=rows_a-1; i++ ) {
    for (jt=0; jt<=cols_b-2; jt=jt+2) {
      register int cbv_1;
      cbv_1=cols_a-6;
#pragma ivdep
#pragma vector always
      for (kt=0; kt<=cbv_1; kt=kt+6) {
        mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+jt];
        mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+(kt+1)]*mat_b[cols_b*(kt+1)+jt];
        mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+(kt+2)]*mat_b[cols_b*(kt+2)+jt];
        mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+(kt+3)]*mat_b[cols_b*(kt+3)+jt];
        mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+(kt+4)]*mat_b[cols_b*(kt+4)+jt];
        mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+(kt+5)]*mat_b[cols_b*(kt+5)+jt];
        mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+(jt+1)];
        mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+(kt+1)]*mat_b[cols_b*(kt+1)+(jt+1)];
        mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+(kt+2)]*mat_b[cols_b*(kt+2)+(jt+1)];
        mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+(kt+3)]*mat_b[cols_b*(kt+3)+(jt+1)];
        mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+(kt+4)]*mat_b[cols_b*(kt+4)+(jt+1)];
        mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+(kt+5)]*mat_b[cols_b*(kt+5)+(jt+1)];
      }
      {
        int k;
        register int cbv_2;
        cbv_2=cols_a-4;
#pragma ivdep
#pragma vector always
        for (k=kt; k<=cbv_2; k=k+4) {
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt];
          mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt+1];
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+jt];
          mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+jt+1];
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+jt];
          mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+jt+1];
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+jt];
          mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+jt+1];
        }
        register int cbv_3, cbv_4;
        cbv_3=cols_a-((cols_a-(kt))%4);
        cbv_4=cols_a-1;
#pragma ivdep
#pragma vector always
        for (k=cbv_3; k<=cbv_4; k=k+1) {
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt];
          mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+(jt+1)];
        }
      }
    }
    {
      int j;
      for (j=jt; j<=cols_b-5; j=j+5) {
        register int cbv_5;
        cbv_5=cols_a-6;
#pragma ivdep
#pragma vector always
        for (kt=0; kt<=cbv_5; kt=kt+6) {
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+kt+1]*mat_b[cols_b*(kt+1)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+kt+2]*mat_b[cols_b*(kt+2)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+kt+3]*mat_b[cols_b*(kt+3)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+kt+4]*mat_b[cols_b*(kt+4)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+kt+5]*mat_b[cols_b*(kt+5)+j];
          mat_c[j+cols_b*i+1]=mat_c[j+cols_b*i+1]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+j+1];
          mat_c[j+cols_b*i+1]=mat_c[j+cols_b*i+1]+mat_a[cols_a*i+kt+1]*mat_b[cols_b*(kt+1)+j+1];
          mat_c[j+cols_b*i+1]=mat_c[j+cols_b*i+1]+mat_a[cols_a*i+kt+2]*mat_b[cols_b*(kt+2)+j+1];
          mat_c[j+cols_b*i+1]=mat_c[j+cols_b*i+1]+mat_a[cols_a*i+kt+3]*mat_b[cols_b*(kt+3)+j+1];
          mat_c[j+cols_b*i+1]=mat_c[j+cols_b*i+1]+mat_a[cols_a*i+kt+4]*mat_b[cols_b*(kt+4)+j+1];
          mat_c[j+cols_b*i+1]=mat_c[j+cols_b*i+1]+mat_a[cols_a*i+kt+5]*mat_b[cols_b*(kt+5)+j+1];
          mat_c[j+cols_b*i+2]=mat_c[j+cols_b*i+2]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+j+2];
          mat_c[j+cols_b*i+2]=mat_c[j+cols_b*i+2]+mat_a[cols_a*i+kt+1]*mat_b[cols_b*(kt+1)+j+2];
          mat_c[j+cols_b*i+2]=mat_c[j+cols_b*i+2]+mat_a[cols_a*i+kt+2]*mat_b[cols_b*(kt+2)+j+2];
          mat_c[j+cols_b*i+2]=mat_c[j+cols_b*i+2]+mat_a[cols_a*i+kt+3]*mat_b[cols_b*(kt+3)+j+2];
          mat_c[j+cols_b*i+2]=mat_c[j+cols_b*i+2]+mat_a[cols_a*i+kt+4]*mat_b[cols_b*(kt+4)+j+2];
          mat_c[j+cols_b*i+2]=mat_c[j+cols_b*i+2]+mat_a[cols_a*i+kt+5]*mat_b[cols_b*(kt+5)+j+2];
          mat_c[j+cols_b*i+3]=mat_c[j+cols_b*i+3]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+j+3];
          mat_c[j+cols_b*i+3]=mat_c[j+cols_b*i+3]+mat_a[cols_a*i+kt+1]*mat_b[cols_b*(kt+1)+j+3];
          mat_c[j+cols_b*i+3]=mat_c[j+cols_b*i+3]+mat_a[cols_a*i+kt+2]*mat_b[cols_b*(kt+2)+j+3];
          mat_c[j+cols_b*i+3]=mat_c[j+cols_b*i+3]+mat_a[cols_a*i+kt+3]*mat_b[cols_b*(kt+3)+j+3];
          mat_c[j+cols_b*i+3]=mat_c[j+cols_b*i+3]+mat_a[cols_a*i+kt+4]*mat_b[cols_b*(kt+4)+j+3];
          mat_c[j+cols_b*i+3]=mat_c[j+cols_b*i+3]+mat_a[cols_a*i+kt+5]*mat_b[cols_b*(kt+5)+j+3];
          mat_c[j+cols_b*i+4]=mat_c[j+cols_b*i+4]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+j+4];
          mat_c[j+cols_b*i+4]=mat_c[j+cols_b*i+4]+mat_a[cols_a*i+kt+1]*mat_b[cols_b*(kt+1)+j+4];
          mat_c[j+cols_b*i+4]=mat_c[j+cols_b*i+4]+mat_a[cols_a*i+kt+2]*mat_b[cols_b*(kt+2)+j+4];
          mat_c[j+cols_b*i+4]=mat_c[j+cols_b*i+4]+mat_a[cols_a*i+kt+3]*mat_b[cols_b*(kt+3)+j+4];
          mat_c[j+cols_b*i+4]=mat_c[j+cols_b*i+4]+mat_a[cols_a*i+kt+4]*mat_b[cols_b*(kt+4)+j+4];
          mat_c[j+cols_b*i+4]=mat_c[j+cols_b*i+4]+mat_a[cols_a*i+kt+5]*mat_b[cols_b*(kt+5)+j+4];
        }
        {
          int k;
          register int cbv_6;
          cbv_6=cols_a-4;
#pragma ivdep
#pragma vector always
          for (k=kt; k<=cbv_6; k=k+4) {
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+j];
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+j];
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+j];
          }
          register int cbv_7, cbv_8;
          cbv_7=cols_a-((cols_a-(kt))%4);
          cbv_8=cols_a-1;
#pragma ivdep
#pragma vector always
          for (k=cbv_7; k<=cbv_8; k=k+1) 
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
        }
        {
          int k;
          register int cbv_9;
          cbv_9=cols_a-4;
#pragma ivdep
#pragma vector always
          for (k=kt; k<=cbv_9; k=k+4) {
            mat_c[j+cols_b*i+1]=mat_c[j+cols_b*i+1]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j+1];
            mat_c[j+cols_b*i+1]=mat_c[j+cols_b*i+1]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+j+1];
            mat_c[j+cols_b*i+1]=mat_c[j+cols_b*i+1]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+j+1];
            mat_c[j+cols_b*i+1]=mat_c[j+cols_b*i+1]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+j+1];
          }
          register int cbv_10, cbv_11;
          cbv_10=cols_a-((cols_a-(kt))%4);
          cbv_11=cols_a-1;
#pragma ivdep
#pragma vector always
          for (k=cbv_10; k<=cbv_11; k=k+1) 
            mat_c[j+cols_b*i+1]=mat_c[j+cols_b*i+1]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j+1];
        }
        {
          int k;
          register int cbv_12;
          cbv_12=cols_a-4;
#pragma ivdep
#pragma vector always
          for (k=kt; k<=cbv_12; k=k+4) {
            mat_c[j+cols_b*i+2]=mat_c[j+cols_b*i+2]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j+2];
            mat_c[j+cols_b*i+2]=mat_c[j+cols_b*i+2]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+j+2];
            mat_c[j+cols_b*i+2]=mat_c[j+cols_b*i+2]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+j+2];
            mat_c[j+cols_b*i+2]=mat_c[j+cols_b*i+2]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+j+2];
          }
          register int cbv_13, cbv_14;
          cbv_13=cols_a-((cols_a-(kt))%4);
          cbv_14=cols_a-1;
#pragma ivdep
#pragma vector always
          for (k=cbv_13; k<=cbv_14; k=k+1) 
            mat_c[j+cols_b*i+2]=mat_c[j+cols_b*i+2]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j+2];
        }
        {
          int k;
          register int cbv_15;
          cbv_15=cols_a-4;
#pragma ivdep
#pragma vector always
          for (k=kt; k<=cbv_15; k=k+4) {
            mat_c[j+cols_b*i+3]=mat_c[j+cols_b*i+3]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j+3];
            mat_c[j+cols_b*i+3]=mat_c[j+cols_b*i+3]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+j+3];
            mat_c[j+cols_b*i+3]=mat_c[j+cols_b*i+3]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+j+3];
            mat_c[j+cols_b*i+3]=mat_c[j+cols_b*i+3]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+j+3];
          }
          register int cbv_16, cbv_17;
          cbv_16=cols_a-((cols_a-(kt))%4);
          cbv_17=cols_a-1;
#pragma ivdep
#pragma vector always
          for (k=cbv_16; k<=cbv_17; k=k+1) 
            mat_c[j+cols_b*i+3]=mat_c[j+cols_b*i+3]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j+3];
        }
        {
          int k;
          register int cbv_18;
          cbv_18=cols_a-4;
#pragma ivdep
#pragma vector always
          for (k=kt; k<=cbv_18; k=k+4) {
            mat_c[j+cols_b*i+4]=mat_c[j+cols_b*i+4]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j+4];
            mat_c[j+cols_b*i+4]=mat_c[j+cols_b*i+4]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+j+4];
            mat_c[j+cols_b*i+4]=mat_c[j+cols_b*i+4]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+j+4];
            mat_c[j+cols_b*i+4]=mat_c[j+cols_b*i+4]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+j+4];
          }
          register int cbv_19, cbv_20;
          cbv_19=cols_a-((cols_a-(kt))%4);
          cbv_20=cols_a-1;
#pragma ivdep
#pragma vector always
          for (k=cbv_19; k<=cbv_20; k=k+1) 
            mat_c[j+cols_b*i+4]=mat_c[j+cols_b*i+4]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j+4];
        }
      }
      for (j=cols_b-((cols_b-(jt))%5); j<=cols_b-1; j=j+1) {
        register int cbv_21;
        cbv_21=cols_a-6;
#pragma ivdep
#pragma vector always
        for (kt=0; kt<=cbv_21; kt=kt+6) {
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+kt]*mat_b[cols_b*kt+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+(kt+1)]*mat_b[cols_b*(kt+1)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+(kt+2)]*mat_b[cols_b*(kt+2)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+(kt+3)]*mat_b[cols_b*(kt+3)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+(kt+4)]*mat_b[cols_b*(kt+4)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+(kt+5)]*mat_b[cols_b*(kt+5)+j];
        }
        {
          int k;
          register int cbv_22;
          cbv_22=cols_a-4;
#pragma ivdep
#pragma vector always
          for (k=kt; k<=cbv_22; k=k+4) {
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+j];
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+j];
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+3]*mat_b[cols_b*(k+3)+j];
          }
          register int cbv_23, cbv_24;
          cbv_23=cols_a-((cols_a-(kt))%4);
          cbv_24=cols_a-1;
#pragma ivdep
#pragma vector always
          for (k=cbv_23; k<=cbv_24; k=k+1) 
            mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
        }
      }
    }
  }
/*@ end @*/
} else if ((rows_a<=12) && (cols_a<=12) && (cols_b<=6)) {

/**-- (Generated by Orio) 
Best performance cost: 
  [1.823e-06, 1.123e-06, 9.61e-07, 9.59e-07, 9.62e-07] 
Tuned for specific problem sizes: 
  cols_a = 12 
  cols_b = 6 
  rows_a = 12 
Best performance parameters: 
  CFLAGS = -O1 
  RT0_I = 6 
  RT0_J = 6 
  RT1_I = 1 
  RT1_J = 2 
  RT1_K = 1 
  U_I = 1 
  U_I0 = 4 
  U_J = 3 
  U_J0 = 4 
  U_K = 3 
  VEC = True 
--**/


  int i, j, k;  
  int it,jt, kt;
  int c_ind, a_row, c_row;


  /*@ begin Loop (  
    transform Composite(
      unrolljam = (['i','j'],[U_I0,U_J0]),
      vector = (VEC, ['ivdep','vector always']),
      regtile = (['i','j'],[RT0_I,RT0_J])
    )
    for (i = 0; i <= rows_a-1; i++) {
      for (j = 0; j <= cols_b-1; j++) {
        mat_c[j + cols_b * i] = 0;
      }
    } 

    transform Composite(
      unrolljam = (['i','j','k'],[U_I,U_J,U_K]),
      vector = (VEC, ['ivdep','vector always']),
      regtile = (['i','j','k'],[RT1_I,RT1_J,RT1_K])
    )
    for (i = 0; i <= rows_a-1; i++) {
      for (j = 0; j <= cols_b-1; j++) {
        for (k = 0; k <= cols_a-1; k++) {
          mat_c[j + cols_b * i] += mat_a[cols_a * i + k] * mat_b[cols_b * k + j];
        }
      } 
    }
  ) @*/
  {
    for (it=0; it<=rows_a-6; it=it+6) {
      register int cbv_1;
      cbv_1=cols_b-6;
#pragma ivdep
#pragma vector always
      for (jt=0; jt<=cbv_1; jt=jt+6) {
        mat_c[jt+cols_b*it]=0;
        mat_c[(jt+1)+cols_b*it]=0;
        mat_c[(jt+2)+cols_b*it]=0;
        mat_c[(jt+3)+cols_b*it]=0;
        mat_c[(jt+4)+cols_b*it]=0;
        mat_c[(jt+5)+cols_b*it]=0;
        mat_c[jt+cols_b*(it+1)]=0;
        mat_c[(jt+1)+cols_b*(it+1)]=0;
        mat_c[(jt+2)+cols_b*(it+1)]=0;
        mat_c[(jt+3)+cols_b*(it+1)]=0;
        mat_c[(jt+4)+cols_b*(it+1)]=0;
        mat_c[(jt+5)+cols_b*(it+1)]=0;
        mat_c[jt+cols_b*(it+2)]=0;
        mat_c[(jt+1)+cols_b*(it+2)]=0;
        mat_c[(jt+2)+cols_b*(it+2)]=0;
        mat_c[(jt+3)+cols_b*(it+2)]=0;
        mat_c[(jt+4)+cols_b*(it+2)]=0;
        mat_c[(jt+5)+cols_b*(it+2)]=0;
        mat_c[jt+cols_b*(it+3)]=0;
        mat_c[(jt+1)+cols_b*(it+3)]=0;
        mat_c[(jt+2)+cols_b*(it+3)]=0;
        mat_c[(jt+3)+cols_b*(it+3)]=0;
        mat_c[(jt+4)+cols_b*(it+3)]=0;
        mat_c[(jt+5)+cols_b*(it+3)]=0;
        mat_c[jt+cols_b*(it+4)]=0;
        mat_c[(jt+1)+cols_b*(it+4)]=0;
        mat_c[(jt+2)+cols_b*(it+4)]=0;
        mat_c[(jt+3)+cols_b*(it+4)]=0;
        mat_c[(jt+4)+cols_b*(it+4)]=0;
        mat_c[(jt+5)+cols_b*(it+4)]=0;
        mat_c[jt+cols_b*(it+5)]=0;
        mat_c[(jt+1)+cols_b*(it+5)]=0;
        mat_c[(jt+2)+cols_b*(it+5)]=0;
        mat_c[(jt+3)+cols_b*(it+5)]=0;
        mat_c[(jt+4)+cols_b*(it+5)]=0;
        mat_c[(jt+5)+cols_b*(it+5)]=0;
      }
      {
        int j;
        register int cbv_2;
        cbv_2=cols_b-4;
#pragma ivdep
#pragma vector always
        for (j=jt; j<=cbv_2; j=j+4) {
          mat_c[j+cols_b*it]=0;
          mat_c[j+cols_b*(it+1)]=0;
          mat_c[j+cols_b*(it+2)]=0;
          mat_c[j+cols_b*(it+3)]=0;
          mat_c[j+cols_b*(it+4)]=0;
          mat_c[j+cols_b*(it+5)]=0;
          mat_c[j+cols_b*it+1]=0;
          mat_c[j+cols_b*(it+1)+1]=0;
          mat_c[j+cols_b*(it+2)+1]=0;
          mat_c[j+cols_b*(it+3)+1]=0;
          mat_c[j+cols_b*(it+4)+1]=0;
          mat_c[j+cols_b*(it+5)+1]=0;
          mat_c[j+cols_b*it+2]=0;
          mat_c[j+cols_b*(it+1)+2]=0;
          mat_c[j+cols_b*(it+2)+2]=0;
          mat_c[j+cols_b*(it+3)+2]=0;
          mat_c[j+cols_b*(it+4)+2]=0;
          mat_c[j+cols_b*(it+5)+2]=0;
          mat_c[j+cols_b*it+3]=0;
          mat_c[j+cols_b*(it+1)+3]=0;
          mat_c[j+cols_b*(it+2)+3]=0;
          mat_c[j+cols_b*(it+3)+3]=0;
          mat_c[j+cols_b*(it+4)+3]=0;
          mat_c[j+cols_b*(it+5)+3]=0;
        }
        register int cbv_3, cbv_4;
        cbv_3=cols_b-((cols_b-(jt))%4);
        cbv_4=cols_b-1;
#pragma ivdep
#pragma vector always
        for (j=cbv_3; j<=cbv_4; j=j+1) {
          mat_c[j+cols_b*it]=0;
          mat_c[j+cols_b*(it+1)]=0;
          mat_c[j+cols_b*(it+2)]=0;
          mat_c[j+cols_b*(it+3)]=0;
          mat_c[j+cols_b*(it+4)]=0;
          mat_c[j+cols_b*(it+5)]=0;
        }
      }
    }
    {
      int i;
      for (i=it; i<=rows_a-4; i=i+4) {
        register int cbv_5;
        cbv_5=cols_b-6;
#pragma ivdep
#pragma vector always
        for (jt=0; jt<=cbv_5; jt=jt+6) {
          mat_c[jt+cols_b*i]=0;
          mat_c[jt+cols_b*i+1]=0;
          mat_c[jt+cols_b*i+2]=0;
          mat_c[jt+cols_b*i+3]=0;
          mat_c[jt+cols_b*i+4]=0;
          mat_c[jt+cols_b*i+5]=0;
          mat_c[jt+cols_b*(i+1)]=0;
          mat_c[jt+cols_b*(i+1)+1]=0;
          mat_c[jt+cols_b*(i+1)+2]=0;
          mat_c[jt+cols_b*(i+1)+3]=0;
          mat_c[jt+cols_b*(i+1)+4]=0;
          mat_c[jt+cols_b*(i+1)+5]=0;
          mat_c[jt+cols_b*(i+2)]=0;
          mat_c[jt+cols_b*(i+2)+1]=0;
          mat_c[jt+cols_b*(i+2)+2]=0;
          mat_c[jt+cols_b*(i+2)+3]=0;
          mat_c[jt+cols_b*(i+2)+4]=0;
          mat_c[jt+cols_b*(i+2)+5]=0;
          mat_c[jt+cols_b*(i+3)]=0;
          mat_c[jt+cols_b*(i+3)+1]=0;
          mat_c[jt+cols_b*(i+3)+2]=0;
          mat_c[jt+cols_b*(i+3)+3]=0;
          mat_c[jt+cols_b*(i+3)+4]=0;
          mat_c[jt+cols_b*(i+3)+5]=0;
        }
        {
          int j;
          register int cbv_6;
          cbv_6=cols_b-4;
#pragma ivdep
#pragma vector always
          for (j=jt; j<=cbv_6; j=j+4) {
            mat_c[j+cols_b*i]=0;
            mat_c[j+cols_b*i+1]=0;
            mat_c[j+cols_b*i+2]=0;
            mat_c[j+cols_b*i+3]=0;
          }
          register int cbv_7, cbv_8;
          cbv_7=cols_b-((cols_b-(jt))%4);
          cbv_8=cols_b-1;
#pragma ivdep
#pragma vector always
          for (j=cbv_7; j<=cbv_8; j=j+1) 
            mat_c[j+cols_b*i]=0;
        }
        {
          int j;
          register int cbv_9;
          cbv_9=cols_b-4;
#pragma ivdep
#pragma vector always
          for (j=jt; j<=cbv_9; j=j+4) {
            mat_c[j+cols_b*(i+1)]=0;
            mat_c[j+cols_b*(i+1)+1]=0;
            mat_c[j+cols_b*(i+1)+2]=0;
            mat_c[j+cols_b*(i+1)+3]=0;
          }
          register int cbv_10, cbv_11;
          cbv_10=cols_b-((cols_b-(jt))%4);
          cbv_11=cols_b-1;
#pragma ivdep
#pragma vector always
          for (j=cbv_10; j<=cbv_11; j=j+1) 
            mat_c[j+cols_b*(i+1)]=0;
        }
        {
          int j;
          register int cbv_12;
          cbv_12=cols_b-4;
#pragma ivdep
#pragma vector always
          for (j=jt; j<=cbv_12; j=j+4) {
            mat_c[j+cols_b*(i+2)]=0;
            mat_c[j+cols_b*(i+2)+1]=0;
            mat_c[j+cols_b*(i+2)+2]=0;
            mat_c[j+cols_b*(i+2)+3]=0;
          }
          register int cbv_13, cbv_14;
          cbv_13=cols_b-((cols_b-(jt))%4);
          cbv_14=cols_b-1;
#pragma ivdep
#pragma vector always
          for (j=cbv_13; j<=cbv_14; j=j+1) 
            mat_c[j+cols_b*(i+2)]=0;
        }
        {
          int j;
          register int cbv_15;
          cbv_15=cols_b-4;
#pragma ivdep
#pragma vector always
          for (j=jt; j<=cbv_15; j=j+4) {
            mat_c[j+cols_b*(i+3)]=0;
            mat_c[j+cols_b*(i+3)+1]=0;
            mat_c[j+cols_b*(i+3)+2]=0;
            mat_c[j+cols_b*(i+3)+3]=0;
          }
          register int cbv_16, cbv_17;
          cbv_16=cols_b-((cols_b-(jt))%4);
          cbv_17=cols_b-1;
#pragma ivdep
#pragma vector always
          for (j=cbv_16; j<=cbv_17; j=j+1) 
            mat_c[j+cols_b*(i+3)]=0;
        }
      }
      for (i=rows_a-((rows_a-(it))%4); i<=rows_a-1; i=i+1) {
        register int cbv_18;
        cbv_18=cols_b-6;
#pragma ivdep
#pragma vector always
        for (jt=0; jt<=cbv_18; jt=jt+6) {
          mat_c[jt+cols_b*i]=0;
          mat_c[(jt+1)+cols_b*i]=0;
          mat_c[(jt+2)+cols_b*i]=0;
          mat_c[(jt+3)+cols_b*i]=0;
          mat_c[(jt+4)+cols_b*i]=0;
          mat_c[(jt+5)+cols_b*i]=0;
        }
        {
          int j;
          register int cbv_19;
          cbv_19=cols_b-4;
#pragma ivdep
#pragma vector always
          for (j=jt; j<=cbv_19; j=j+4) {
            mat_c[j+cols_b*i]=0;
            mat_c[j+cols_b*i+1]=0;
            mat_c[j+cols_b*i+2]=0;
            mat_c[j+cols_b*i+3]=0;
          }
          register int cbv_20, cbv_21;
          cbv_20=cols_b-((cols_b-(jt))%4);
          cbv_21=cols_b-1;
#pragma ivdep
#pragma vector always
          for (j=cbv_20; j<=cbv_21; j=j+1) 
            mat_c[j+cols_b*i]=0;
        }
      }
    }
  }
  for (i=0; i<=rows_a-1; i++ ) {
    for (jt=0; jt<=cols_b-2; jt=jt+2) {
      {
        int k;
        register int cbv_1;
        cbv_1=cols_a-3;
#pragma ivdep
#pragma vector always
        for (k=0; k<=cbv_1; k=k+3) {
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt];
          mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt+1];
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+jt];
          mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+jt+1];
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+jt];
          mat_c[jt+cols_b*i+1]=mat_c[jt+cols_b*i+1]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+jt+1];
        }
        register int cbv_2, cbv_3;
        cbv_2=cols_a-((cols_a-(0))%3);
        cbv_3=cols_a-1;
#pragma ivdep
#pragma vector always
        for (k=cbv_2; k<=cbv_3; k=k+1) {
          mat_c[jt+cols_b*i]=mat_c[jt+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+jt];
          mat_c[(jt+1)+cols_b*i]=mat_c[(jt+1)+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+(jt+1)];
        }
      }
    }
    {
      int j;
      for (j=jt; j<=cols_b-3; j=j+3) {
        int k;
        register int cbv_4;
        cbv_4=cols_a-3;
#pragma ivdep
#pragma vector always
        for (k=0; k<=cbv_4; k=k+3) {
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+j];
          mat_c[j+cols_b*i+1]=mat_c[j+cols_b*i+1]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j+1];
          mat_c[j+cols_b*i+1]=mat_c[j+cols_b*i+1]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+j+1];
          mat_c[j+cols_b*i+1]=mat_c[j+cols_b*i+1]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+j+1];
          mat_c[j+cols_b*i+2]=mat_c[j+cols_b*i+2]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j+2];
          mat_c[j+cols_b*i+2]=mat_c[j+cols_b*i+2]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+j+2];
          mat_c[j+cols_b*i+2]=mat_c[j+cols_b*i+2]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+j+2];
        }
        register int cbv_5, cbv_6;
        cbv_5=cols_a-((cols_a-(0))%3);
        cbv_6=cols_a-1;
#pragma ivdep
#pragma vector always
        for (k=cbv_5; k<=cbv_6; k=k+1) {
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
          mat_c[j+cols_b*i+1]=mat_c[j+cols_b*i+1]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j+1];
          mat_c[j+cols_b*i+2]=mat_c[j+cols_b*i+2]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j+2];
        }
      }
      for (j=cols_b-((cols_b-(jt))%3); j<=cols_b-1; j=j+1) {
        int k;
        register int cbv_7;
        cbv_7=cols_a-3;
#pragma ivdep
#pragma vector always
        for (k=0; k<=cbv_7; k=k+3) {
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+j];
        }
        register int cbv_8, cbv_9;
        cbv_8=cols_a-((cols_a-(0))%3);
        cbv_9=cols_a-1;
#pragma ivdep
#pragma vector always
        for (k=cbv_8; k<=cbv_9; k=k+1) 
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
      }
    }
  }
/*@ end @*/
} else if ((rows_a<=12) && (cols_a<=12) && (cols_b<=12)) {

/**-- (Generated by Orio) 
Best performance cost: 
  [2.705e-06, 1.816e-06, 1.572e-06, 1.559e-06, 1.562e-06] 
Tuned for specific problem sizes: 
  cols_a = 12 
  cols_b = 12 
  rows_a = 12 
Best performance parameters: 
  CFLAGS = -O3 
  RT0_I = 1 
  RT0_J = 2 
  RT1_I = 1 
  RT1_J = 1 
  RT1_K = 1 
  U_I = 1 
  U_I0 = 4 
  U_J = 1 
  U_J0 = 1 
  U_K = 3 
  VEC = False 
--**/


  int i, j, k;  
  int it,jt, kt;
  int c_ind, a_row, c_row;


  /*@ begin Loop (  
    transform Composite(
      unrolljam = (['i','j'],[U_I0,U_J0]),
      vector = (VEC, ['ivdep','vector always']),
      regtile = (['i','j'],[RT0_I,RT0_J])
    )
    for (i = 0; i <= rows_a-1; i++) {
      for (j = 0; j <= cols_b-1; j++) {
        mat_c[j + cols_b * i] = 0;
      }
    } 

    transform Composite(
      unrolljam = (['i','j','k'],[U_I,U_J,U_K]),
      vector = (VEC, ['ivdep','vector always']),
      regtile = (['i','j','k'],[RT1_I,RT1_J,RT1_K])
    )
    for (i = 0; i <= rows_a-1; i++) {
      for (j = 0; j <= cols_b-1; j++) {
        for (k = 0; k <= cols_a-1; k++) {
          mat_c[j + cols_b * i] += mat_a[cols_a * i + k] * mat_b[cols_b * k + j];
        }
      } 
    }
  ) @*/
  {
    int i;
    for (i=0; i<=rows_a-4; i=i+4) {
      for (jt=0; jt<=cols_b-2; jt=jt+2) {
        mat_c[jt+cols_b*i]=0;
        mat_c[jt+cols_b*i+1]=0;
        mat_c[jt+cols_b*(i+1)]=0;
        mat_c[jt+cols_b*(i+1)+1]=0;
        mat_c[jt+cols_b*(i+2)]=0;
        mat_c[jt+cols_b*(i+2)+1]=0;
        mat_c[jt+cols_b*(i+3)]=0;
        mat_c[jt+cols_b*(i+3)+1]=0;
      }
      for (j=jt; j<=cols_b-1; j=j+1) {
        mat_c[j+cols_b*i]=0;
        mat_c[j+cols_b*(i+1)]=0;
        mat_c[j+cols_b*(i+2)]=0;
        mat_c[j+cols_b*(i+3)]=0;
      }
    }
    for (i=rows_a-((rows_a-(0))%4); i<=rows_a-1; i=i+1) {
      for (jt=0; jt<=cols_b-2; jt=jt+2) {
        mat_c[jt+cols_b*i]=0;
        mat_c[(jt+1)+cols_b*i]=0;
      }
      for (j=jt; j<=cols_b-1; j=j+1) {
        mat_c[j+cols_b*i]=0;
      }
    }
  }
  for (i=0; i<=rows_a-1; i++ ) {
    for (j=0; j<=cols_b-1; j++ ) {
      {
        int k;
        for (k=0; k<=cols_a-3; k=k+3) {
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+1]*mat_b[cols_b*(k+1)+j];
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k+2]*mat_b[cols_b*(k+2)+j];
        }
        for (k=cols_a-((cols_a-(0))%3); k<=cols_a-1; k=k+1) 
          mat_c[j+cols_b*i]=mat_c[j+cols_b*i]+mat_a[cols_a*i+k]*mat_b[cols_b*k+j];
      }
    }
  }
/*@ end @*/
}
/*@ end @*/
}



void multiply_matrix_by_scalar(TYPE* mat_a, int rows, int cols, TYPE scalar, TYPE* mat_c) {

  /*@ begin PerfTuning (

    def build {
      arg build_command = 'icc';
      #arg libs = '-lrt';  # Only needed on linux
    } 

    def performance_counter {
      arg repetitions = 5;
    }

    def performance_params {  
      param U_I[] = range(1,6);
      param U_J[] = range(1,6);

      param RT1_I[] = [1,2,6];
      param RT1_J[] = [1,2,6];

      param VEC[] = [False,True];

      param CFLAGS[] = ['-O1', '-O2', '-O3'];
      constraint unroll_limit = ((U_I == 1) or (U_J == 1));
      constraint reg_capacity_1 = (RT1_I*RT1_J <= 150);

    }

    def input_params {
      let N = [6];
      param rows[] = N;
      param cols[] = N;
    }

    def input_vars {
      decl dynamic double mat_a[rows*cols] = random;
      decl dynamic double mat_b[rows*cols] = random;
      decl dynamic double mat_c[rows*cols] = 0;
      decl double scalar = random;
    }

    def search {
      arg algorithm = 'Exhaustive';
    }

  ) @*/
/**-- (Generated by Orio) 
Best performance cost: 
  [1.042e-06, 2.64e-07, 1.83e-07, 1.81e-07, 1.82e-07] 
Tuned for specific problem sizes: 
  cols = 6 
  rows = 6 
Best performance parameters: 
  CFLAGS = -O3 
  RT1_I = 6 
  RT1_J = 1 
  U_I = 3 
  U_J = 1 
  VEC = True 
--**/


    
  int i, j, it, jt;
  int ind, row;


  /*@ begin Loop (  
    transform Composite(
      unrolljam = (['i','j'],[U_I,U_J]),
      regtile = (['i','j'],[RT1_I,RT1_J]),
      vector = (VEC, ['ivdep','vector always'])
    )
    for (i = 0; i <= rows-1; i++) {
      for (j = 0; j <= cols-1; j++) {
        mat_c[cols * i + j] = mat_a[cols * i + j] * scalar;
      }
    }
  ) @*/
  {
    for (it=0; it<=rows-6; it=it+6) {
      register int cbv_1;
      cbv_1=cols-1;
#pragma ivdep
#pragma vector always
      for (j=0; j<=cbv_1; j++ ) {
        mat_c[cols*it+j]=mat_a[cols*it+j]*scalar;
        mat_c[cols*(it+1)+j]=mat_a[cols*(it+1)+j]*scalar;
        mat_c[cols*(it+2)+j]=mat_a[cols*(it+2)+j]*scalar;
        mat_c[cols*(it+3)+j]=mat_a[cols*(it+3)+j]*scalar;
        mat_c[cols*(it+4)+j]=mat_a[cols*(it+4)+j]*scalar;
        mat_c[cols*(it+5)+j]=mat_a[cols*(it+5)+j]*scalar;
      }
    }
    {
      int i;
      for (i=it; i<=rows-3; i=i+3) {
        register int cbv_2;
        cbv_2=cols-1;
#pragma ivdep
#pragma vector always
        for (j=0; j<=cbv_2; j++ ) {
          mat_c[cols*i+j]=mat_a[cols*i+j]*scalar;
          mat_c[cols*(i+1)+j]=mat_a[cols*(i+1)+j]*scalar;
          mat_c[cols*(i+2)+j]=mat_a[cols*(i+2)+j]*scalar;
        }
      }
      for (i=rows-((rows-(it))%3); i<=rows-1; i=i+1) {
        register int cbv_3;
        cbv_3=cols-1;
#pragma ivdep
#pragma vector always
        for (j=0; j<=cbv_3; j++ ) {
          mat_c[cols*i+j]=mat_a[cols*i+j]*scalar;
        }
      }
    }
  }
/*@ end @*/
/*@ end @*/

  
}



void transpose_matrix(TYPE* mat_a, int rows_a, int cols_a, TYPE* mat_c) {
 

/*@ begin PerfTuning (

 def build {
   arg build_command = 'icc';
   #arg libs = '-lrt';  # Only needed on linux
 } 

 def performance_counter {
   arg repetitions = 5;
 }

 def performance_params {  
  param U_I[] = range(1,6);
  param U_J[] = range(1,6);

  param RT1_I[] = [1,2,6];
  param RT1_J[] = [1,2,6];

  param VEC[] = [False,True];

  param CFLAGS[] = ['-O1', '-O2', '-O3'];
  constraint unroll_limit = ((U_I == 1) or (U_J == 1));
  constraint reg_capacity_1 = (RT1_I*RT1_J <= 150);

 }
 
 def input_params {
      let N = [6];
  param rows_a[] = N;
  param cols_a[] = N;
 }
 
 def input_vars {
   decl dynamic double mat_a[rows_a*cols_a] = random;
   decl dynamic double mat_c[rows_a*cols_a] = 0;
 }
 
 def search {
   arg algorithm = 'Exhaustive';
 }

) @*/
/**-- (Generated by Orio) 
Best performance cost: 
  [1.119e-06, 2.35e-07, 1.85e-07, 1.83e-07, 1.82e-07] 
Tuned for specific problem sizes: 
  cols_a = 6 
  rows_a = 6 
Best performance parameters: 
  CFLAGS = -O1 
  RT1_I = 6 
  RT1_J = 1 
  U_I = 4 
  U_J = 1 
  VEC = False 
--**/


  int i, j;
  int it,jt;
  int a_row;

/*@ begin Loop (  
  transform Composite(
    unrolljam = (['i','j'],[U_I,U_J]),
    vector = (VEC, ['ivdep','vector always']),
    regtile = (['i','j'],[RT1_I,RT1_J])
  )
  for (i = 0; i <= rows_a-1; i++) {
    for (j = 0; j <= cols_a-1; j++) {
      mat_c[rows_a * j + i] = mat_a[cols_a * i + j];
    }
  }
) @*/
{
  for (it=0; it<=rows_a-6; it=it+6) {
    for (j=0; j<=cols_a-1; j++ ) {
      mat_c[rows_a*j+it]=mat_a[cols_a*it+j];
      mat_c[rows_a*j+(it+1)]=mat_a[cols_a*(it+1)+j];
      mat_c[rows_a*j+(it+2)]=mat_a[cols_a*(it+2)+j];
      mat_c[rows_a*j+(it+3)]=mat_a[cols_a*(it+3)+j];
      mat_c[rows_a*j+(it+4)]=mat_a[cols_a*(it+4)+j];
      mat_c[rows_a*j+(it+5)]=mat_a[cols_a*(it+5)+j];
    }
  }
  {
    int i;
    for (i=it; i<=rows_a-4; i=i+4) {
      for (j=0; j<=cols_a-1; j++ ) {
        mat_c[rows_a*j+i]=mat_a[cols_a*i+j];
        mat_c[rows_a*j+i+1]=mat_a[cols_a*(i+1)+j];
        mat_c[rows_a*j+i+2]=mat_a[cols_a*(i+2)+j];
        mat_c[rows_a*j+i+3]=mat_a[cols_a*(i+3)+j];
      }
    }
    for (i=rows_a-((rows_a-(it))%4); i<=rows_a-1; i=i+1) 
      for (j=0; j<=cols_a-1; j++ ) {
        mat_c[rows_a*j+i]=mat_a[cols_a*i+j];
      }
  }
}
/*@ end @*/
/*@ end @*/

}

