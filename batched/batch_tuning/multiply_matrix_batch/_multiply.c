
#include "../../matrix_batch.h"

void _multiply_matrix_batch(KALMAN_TYPE*** A, int rows_a, int cols_a,
                            KALMAN_TYPE*** B, int rows_b, int cols_b,
                            KALMAN_TYPE*** C,
                            int num_mats) {

/*@ begin PerfTuning (

    def build {
      arg build_command = 'icc';
      #arg libs = '-lrt';  # Only needed on linux
    } 

    def performance_counter {
      arg repetitions = 5;
    }

    def performance_params {  
      param U_I[] = range(1,7);
      param U_J[] = range(1,7);
      param U_K[] = range(1,7);
      param U_L[] = range(1,129);

      param VEC[] = [False,True];

      param RT1_L[] = [1,32];

      param T1_L[] = [1, 2048, 4096];

      constraint tile2 = ((T1_L == 1) or (RT1_L == 1));
    }

    def input_params {
      let N = [60];
      let M = [3000];
      param rows_a[] = N;
      param cols_a[] = N;
      param cols_b[] = N;
      param num_mats[] = M;
    }

    def input_vars {
      decl dynamic double A[rows_a][cols_a][num_mats] = random;
      decl dynamic double B[cols_a][cols_b][num_mats] = random;
      decl dynamic double C[rows_a][cols_b][num_mats] = 0;
    }

    def search {
      arg algorithm = 'Randomsearch';
      arg total_runs  = 100000;
    }

  ) @*/
/**-- (Generated by Orio) 
Best performance cost: 
  [0.394613, 0.395161, 0.395221, 0.394751, 0.397056] 
Tuned for specific problem sizes: 
  cols_a = 60 
  cols_b = 60 
  num_mats = 3000 
  rows_a = 60 
Best performance parameters: 
  RT1_L = 1 
  T1_L = 2048 
  U_I = 3 
  U_J = 2 
  U_K = 1 
  U_L = 18 
  VEC = False 
--**/


  int i,j,k,l;
  int it,jt,kt,lt, ll;
#define max(x,y)    ((x) > (y)? (x) : (y))
#define min(x,y)    ((x) < (y)? (x) : (y)) 

/*@ begin Loop (  
  
  transform Composite(
    unrolljam = (['i','j','k','l'],[U_I,U_J,U_K,U_L]),
    regtile = (['l'],[RT1_L]),
    tile = ([('l',T1_L,'ll')]),
    vector = (VEC, ['vector always'])
  )
  for (i = 0; i <= rows_a-1; i++) {
    for (j = 0; j <= cols_b-1; j++) {
      for (l = 0; l <= num_mats-1; l++) {
        C[i][j][l] = 0;
      }
      for (k = 0; k <= cols_a-1; k++) {
        #pragma ivdep
        for (l = 0; l <= num_mats-1; l++) {
          C[i][j][l] += A[i][k][l] * B[k][j][l];
        }
      }
    } 
  }

  ) @*/
{
  int i;
  for (i=0; i<=rows_a-3; i=i+3) {
    int j;
    for (j=0; j<=cols_b-2; j=j+2) {
      for (ll=0; ll<=num_mats-1; ll=ll+2048) {
        int l;
        for (l=ll; l<=min(num_mats-1,ll+2047)-17; l=l+18) {
          C[i][j][l]=0;
          C[i][j][(l+1)]=0;
          C[i][j][(l+2)]=0;
          C[i][j][(l+3)]=0;
          C[i][j][(l+4)]=0;
          C[i][j][(l+5)]=0;
          C[i][j][(l+6)]=0;
          C[i][j][(l+7)]=0;
          C[i][j][(l+8)]=0;
          C[i][j][(l+9)]=0;
          C[i][j][(l+10)]=0;
          C[i][j][(l+11)]=0;
          C[i][j][(l+12)]=0;
          C[i][j][(l+13)]=0;
          C[i][j][(l+14)]=0;
          C[i][j][(l+15)]=0;
          C[i][j][(l+16)]=0;
          C[i][j][(l+17)]=0;
          C[i][(j+1)][l]=0;
          C[i][(j+1)][(l+1)]=0;
          C[i][(j+1)][(l+2)]=0;
          C[i][(j+1)][(l+3)]=0;
          C[i][(j+1)][(l+4)]=0;
          C[i][(j+1)][(l+5)]=0;
          C[i][(j+1)][(l+6)]=0;
          C[i][(j+1)][(l+7)]=0;
          C[i][(j+1)][(l+8)]=0;
          C[i][(j+1)][(l+9)]=0;
          C[i][(j+1)][(l+10)]=0;
          C[i][(j+1)][(l+11)]=0;
          C[i][(j+1)][(l+12)]=0;
          C[i][(j+1)][(l+13)]=0;
          C[i][(j+1)][(l+14)]=0;
          C[i][(j+1)][(l+15)]=0;
          C[i][(j+1)][(l+16)]=0;
          C[i][(j+1)][(l+17)]=0;
          C[(i+1)][j][l]=0;
          C[(i+1)][j][(l+1)]=0;
          C[(i+1)][j][(l+2)]=0;
          C[(i+1)][j][(l+3)]=0;
          C[(i+1)][j][(l+4)]=0;
          C[(i+1)][j][(l+5)]=0;
          C[(i+1)][j][(l+6)]=0;
          C[(i+1)][j][(l+7)]=0;
          C[(i+1)][j][(l+8)]=0;
          C[(i+1)][j][(l+9)]=0;
          C[(i+1)][j][(l+10)]=0;
          C[(i+1)][j][(l+11)]=0;
          C[(i+1)][j][(l+12)]=0;
          C[(i+1)][j][(l+13)]=0;
          C[(i+1)][j][(l+14)]=0;
          C[(i+1)][j][(l+15)]=0;
          C[(i+1)][j][(l+16)]=0;
          C[(i+1)][j][(l+17)]=0;
          C[(i+1)][(j+1)][l]=0;
          C[(i+1)][(j+1)][(l+1)]=0;
          C[(i+1)][(j+1)][(l+2)]=0;
          C[(i+1)][(j+1)][(l+3)]=0;
          C[(i+1)][(j+1)][(l+4)]=0;
          C[(i+1)][(j+1)][(l+5)]=0;
          C[(i+1)][(j+1)][(l+6)]=0;
          C[(i+1)][(j+1)][(l+7)]=0;
          C[(i+1)][(j+1)][(l+8)]=0;
          C[(i+1)][(j+1)][(l+9)]=0;
          C[(i+1)][(j+1)][(l+10)]=0;
          C[(i+1)][(j+1)][(l+11)]=0;
          C[(i+1)][(j+1)][(l+12)]=0;
          C[(i+1)][(j+1)][(l+13)]=0;
          C[(i+1)][(j+1)][(l+14)]=0;
          C[(i+1)][(j+1)][(l+15)]=0;
          C[(i+1)][(j+1)][(l+16)]=0;
          C[(i+1)][(j+1)][(l+17)]=0;
          C[(i+2)][j][l]=0;
          C[(i+2)][j][(l+1)]=0;
          C[(i+2)][j][(l+2)]=0;
          C[(i+2)][j][(l+3)]=0;
          C[(i+2)][j][(l+4)]=0;
          C[(i+2)][j][(l+5)]=0;
          C[(i+2)][j][(l+6)]=0;
          C[(i+2)][j][(l+7)]=0;
          C[(i+2)][j][(l+8)]=0;
          C[(i+2)][j][(l+9)]=0;
          C[(i+2)][j][(l+10)]=0;
          C[(i+2)][j][(l+11)]=0;
          C[(i+2)][j][(l+12)]=0;
          C[(i+2)][j][(l+13)]=0;
          C[(i+2)][j][(l+14)]=0;
          C[(i+2)][j][(l+15)]=0;
          C[(i+2)][j][(l+16)]=0;
          C[(i+2)][j][(l+17)]=0;
          C[(i+2)][(j+1)][l]=0;
          C[(i+2)][(j+1)][(l+1)]=0;
          C[(i+2)][(j+1)][(l+2)]=0;
          C[(i+2)][(j+1)][(l+3)]=0;
          C[(i+2)][(j+1)][(l+4)]=0;
          C[(i+2)][(j+1)][(l+5)]=0;
          C[(i+2)][(j+1)][(l+6)]=0;
          C[(i+2)][(j+1)][(l+7)]=0;
          C[(i+2)][(j+1)][(l+8)]=0;
          C[(i+2)][(j+1)][(l+9)]=0;
          C[(i+2)][(j+1)][(l+10)]=0;
          C[(i+2)][(j+1)][(l+11)]=0;
          C[(i+2)][(j+1)][(l+12)]=0;
          C[(i+2)][(j+1)][(l+13)]=0;
          C[(i+2)][(j+1)][(l+14)]=0;
          C[(i+2)][(j+1)][(l+15)]=0;
          C[(i+2)][(j+1)][(l+16)]=0;
          C[(i+2)][(j+1)][(l+17)]=0;
        }
        for (l=(min(num_mats-1,ll+2047))-(((min(num_mats-1,ll+2047))-(ll)+1)%18)+1; l<=min(num_mats-1,ll+2047); l=l+1) {
          C[i][j][l]=0;
          C[i][(j+1)][l]=0;
          C[(i+1)][j][l]=0;
          C[(i+1)][(j+1)][l]=0;
          C[(i+2)][j][l]=0;
          C[(i+2)][(j+1)][l]=0;
        }
      }
      for (k=0; k<=cols_a-1; k++ ) {
        /*#pragma ivdep*/
        /*#pragma ivdep*/
        /*#pragma ivdep*/
        /*#pragma ivdep*/
        /*#pragma ivdep*/
        /*#pragma ivdep*/
        for (ll=0; ll<=num_mats-1; ll=ll+2048) {
          int l;
          for (l=ll; l<=min(num_mats-1,ll+2047)-17; l=l+18) {
            C[i][j][l]=C[i][j][l]+A[i][k][l]*B[k][j][l];
            C[i][j][(l+1)]=C[i][j][(l+1)]+A[i][k][(l+1)]*B[k][j][(l+1)];
            C[i][j][(l+2)]=C[i][j][(l+2)]+A[i][k][(l+2)]*B[k][j][(l+2)];
            C[i][j][(l+3)]=C[i][j][(l+3)]+A[i][k][(l+3)]*B[k][j][(l+3)];
            C[i][j][(l+4)]=C[i][j][(l+4)]+A[i][k][(l+4)]*B[k][j][(l+4)];
            C[i][j][(l+5)]=C[i][j][(l+5)]+A[i][k][(l+5)]*B[k][j][(l+5)];
            C[i][j][(l+6)]=C[i][j][(l+6)]+A[i][k][(l+6)]*B[k][j][(l+6)];
            C[i][j][(l+7)]=C[i][j][(l+7)]+A[i][k][(l+7)]*B[k][j][(l+7)];
            C[i][j][(l+8)]=C[i][j][(l+8)]+A[i][k][(l+8)]*B[k][j][(l+8)];
            C[i][j][(l+9)]=C[i][j][(l+9)]+A[i][k][(l+9)]*B[k][j][(l+9)];
            C[i][j][(l+10)]=C[i][j][(l+10)]+A[i][k][(l+10)]*B[k][j][(l+10)];
            C[i][j][(l+11)]=C[i][j][(l+11)]+A[i][k][(l+11)]*B[k][j][(l+11)];
            C[i][j][(l+12)]=C[i][j][(l+12)]+A[i][k][(l+12)]*B[k][j][(l+12)];
            C[i][j][(l+13)]=C[i][j][(l+13)]+A[i][k][(l+13)]*B[k][j][(l+13)];
            C[i][j][(l+14)]=C[i][j][(l+14)]+A[i][k][(l+14)]*B[k][j][(l+14)];
            C[i][j][(l+15)]=C[i][j][(l+15)]+A[i][k][(l+15)]*B[k][j][(l+15)];
            C[i][j][(l+16)]=C[i][j][(l+16)]+A[i][k][(l+16)]*B[k][j][(l+16)];
            C[i][j][(l+17)]=C[i][j][(l+17)]+A[i][k][(l+17)]*B[k][j][(l+17)];
            C[i][(j+1)][l]=C[i][(j+1)][l]+A[i][k][l]*B[k][(j+1)][l];
            C[i][(j+1)][(l+1)]=C[i][(j+1)][(l+1)]+A[i][k][(l+1)]*B[k][(j+1)][(l+1)];
            C[i][(j+1)][(l+2)]=C[i][(j+1)][(l+2)]+A[i][k][(l+2)]*B[k][(j+1)][(l+2)];
            C[i][(j+1)][(l+3)]=C[i][(j+1)][(l+3)]+A[i][k][(l+3)]*B[k][(j+1)][(l+3)];
            C[i][(j+1)][(l+4)]=C[i][(j+1)][(l+4)]+A[i][k][(l+4)]*B[k][(j+1)][(l+4)];
            C[i][(j+1)][(l+5)]=C[i][(j+1)][(l+5)]+A[i][k][(l+5)]*B[k][(j+1)][(l+5)];
            C[i][(j+1)][(l+6)]=C[i][(j+1)][(l+6)]+A[i][k][(l+6)]*B[k][(j+1)][(l+6)];
            C[i][(j+1)][(l+7)]=C[i][(j+1)][(l+7)]+A[i][k][(l+7)]*B[k][(j+1)][(l+7)];
            C[i][(j+1)][(l+8)]=C[i][(j+1)][(l+8)]+A[i][k][(l+8)]*B[k][(j+1)][(l+8)];
            C[i][(j+1)][(l+9)]=C[i][(j+1)][(l+9)]+A[i][k][(l+9)]*B[k][(j+1)][(l+9)];
            C[i][(j+1)][(l+10)]=C[i][(j+1)][(l+10)]+A[i][k][(l+10)]*B[k][(j+1)][(l+10)];
            C[i][(j+1)][(l+11)]=C[i][(j+1)][(l+11)]+A[i][k][(l+11)]*B[k][(j+1)][(l+11)];
            C[i][(j+1)][(l+12)]=C[i][(j+1)][(l+12)]+A[i][k][(l+12)]*B[k][(j+1)][(l+12)];
            C[i][(j+1)][(l+13)]=C[i][(j+1)][(l+13)]+A[i][k][(l+13)]*B[k][(j+1)][(l+13)];
            C[i][(j+1)][(l+14)]=C[i][(j+1)][(l+14)]+A[i][k][(l+14)]*B[k][(j+1)][(l+14)];
            C[i][(j+1)][(l+15)]=C[i][(j+1)][(l+15)]+A[i][k][(l+15)]*B[k][(j+1)][(l+15)];
            C[i][(j+1)][(l+16)]=C[i][(j+1)][(l+16)]+A[i][k][(l+16)]*B[k][(j+1)][(l+16)];
            C[i][(j+1)][(l+17)]=C[i][(j+1)][(l+17)]+A[i][k][(l+17)]*B[k][(j+1)][(l+17)];
            C[(i+1)][j][l]=C[(i+1)][j][l]+A[(i+1)][k][l]*B[k][j][l];
            C[(i+1)][j][(l+1)]=C[(i+1)][j][(l+1)]+A[(i+1)][k][(l+1)]*B[k][j][(l+1)];
            C[(i+1)][j][(l+2)]=C[(i+1)][j][(l+2)]+A[(i+1)][k][(l+2)]*B[k][j][(l+2)];
            C[(i+1)][j][(l+3)]=C[(i+1)][j][(l+3)]+A[(i+1)][k][(l+3)]*B[k][j][(l+3)];
            C[(i+1)][j][(l+4)]=C[(i+1)][j][(l+4)]+A[(i+1)][k][(l+4)]*B[k][j][(l+4)];
            C[(i+1)][j][(l+5)]=C[(i+1)][j][(l+5)]+A[(i+1)][k][(l+5)]*B[k][j][(l+5)];
            C[(i+1)][j][(l+6)]=C[(i+1)][j][(l+6)]+A[(i+1)][k][(l+6)]*B[k][j][(l+6)];
            C[(i+1)][j][(l+7)]=C[(i+1)][j][(l+7)]+A[(i+1)][k][(l+7)]*B[k][j][(l+7)];
            C[(i+1)][j][(l+8)]=C[(i+1)][j][(l+8)]+A[(i+1)][k][(l+8)]*B[k][j][(l+8)];
            C[(i+1)][j][(l+9)]=C[(i+1)][j][(l+9)]+A[(i+1)][k][(l+9)]*B[k][j][(l+9)];
            C[(i+1)][j][(l+10)]=C[(i+1)][j][(l+10)]+A[(i+1)][k][(l+10)]*B[k][j][(l+10)];
            C[(i+1)][j][(l+11)]=C[(i+1)][j][(l+11)]+A[(i+1)][k][(l+11)]*B[k][j][(l+11)];
            C[(i+1)][j][(l+12)]=C[(i+1)][j][(l+12)]+A[(i+1)][k][(l+12)]*B[k][j][(l+12)];
            C[(i+1)][j][(l+13)]=C[(i+1)][j][(l+13)]+A[(i+1)][k][(l+13)]*B[k][j][(l+13)];
            C[(i+1)][j][(l+14)]=C[(i+1)][j][(l+14)]+A[(i+1)][k][(l+14)]*B[k][j][(l+14)];
            C[(i+1)][j][(l+15)]=C[(i+1)][j][(l+15)]+A[(i+1)][k][(l+15)]*B[k][j][(l+15)];
            C[(i+1)][j][(l+16)]=C[(i+1)][j][(l+16)]+A[(i+1)][k][(l+16)]*B[k][j][(l+16)];
            C[(i+1)][j][(l+17)]=C[(i+1)][j][(l+17)]+A[(i+1)][k][(l+17)]*B[k][j][(l+17)];
            C[(i+1)][(j+1)][l]=C[(i+1)][(j+1)][l]+A[(i+1)][k][l]*B[k][(j+1)][l];
            C[(i+1)][(j+1)][(l+1)]=C[(i+1)][(j+1)][(l+1)]+A[(i+1)][k][(l+1)]*B[k][(j+1)][(l+1)];
            C[(i+1)][(j+1)][(l+2)]=C[(i+1)][(j+1)][(l+2)]+A[(i+1)][k][(l+2)]*B[k][(j+1)][(l+2)];
            C[(i+1)][(j+1)][(l+3)]=C[(i+1)][(j+1)][(l+3)]+A[(i+1)][k][(l+3)]*B[k][(j+1)][(l+3)];
            C[(i+1)][(j+1)][(l+4)]=C[(i+1)][(j+1)][(l+4)]+A[(i+1)][k][(l+4)]*B[k][(j+1)][(l+4)];
            C[(i+1)][(j+1)][(l+5)]=C[(i+1)][(j+1)][(l+5)]+A[(i+1)][k][(l+5)]*B[k][(j+1)][(l+5)];
            C[(i+1)][(j+1)][(l+6)]=C[(i+1)][(j+1)][(l+6)]+A[(i+1)][k][(l+6)]*B[k][(j+1)][(l+6)];
            C[(i+1)][(j+1)][(l+7)]=C[(i+1)][(j+1)][(l+7)]+A[(i+1)][k][(l+7)]*B[k][(j+1)][(l+7)];
            C[(i+1)][(j+1)][(l+8)]=C[(i+1)][(j+1)][(l+8)]+A[(i+1)][k][(l+8)]*B[k][(j+1)][(l+8)];
            C[(i+1)][(j+1)][(l+9)]=C[(i+1)][(j+1)][(l+9)]+A[(i+1)][k][(l+9)]*B[k][(j+1)][(l+9)];
            C[(i+1)][(j+1)][(l+10)]=C[(i+1)][(j+1)][(l+10)]+A[(i+1)][k][(l+10)]*B[k][(j+1)][(l+10)];
            C[(i+1)][(j+1)][(l+11)]=C[(i+1)][(j+1)][(l+11)]+A[(i+1)][k][(l+11)]*B[k][(j+1)][(l+11)];
            C[(i+1)][(j+1)][(l+12)]=C[(i+1)][(j+1)][(l+12)]+A[(i+1)][k][(l+12)]*B[k][(j+1)][(l+12)];
            C[(i+1)][(j+1)][(l+13)]=C[(i+1)][(j+1)][(l+13)]+A[(i+1)][k][(l+13)]*B[k][(j+1)][(l+13)];
            C[(i+1)][(j+1)][(l+14)]=C[(i+1)][(j+1)][(l+14)]+A[(i+1)][k][(l+14)]*B[k][(j+1)][(l+14)];
            C[(i+1)][(j+1)][(l+15)]=C[(i+1)][(j+1)][(l+15)]+A[(i+1)][k][(l+15)]*B[k][(j+1)][(l+15)];
            C[(i+1)][(j+1)][(l+16)]=C[(i+1)][(j+1)][(l+16)]+A[(i+1)][k][(l+16)]*B[k][(j+1)][(l+16)];
            C[(i+1)][(j+1)][(l+17)]=C[(i+1)][(j+1)][(l+17)]+A[(i+1)][k][(l+17)]*B[k][(j+1)][(l+17)];
            C[(i+2)][j][l]=C[(i+2)][j][l]+A[(i+2)][k][l]*B[k][j][l];
            C[(i+2)][j][(l+1)]=C[(i+2)][j][(l+1)]+A[(i+2)][k][(l+1)]*B[k][j][(l+1)];
            C[(i+2)][j][(l+2)]=C[(i+2)][j][(l+2)]+A[(i+2)][k][(l+2)]*B[k][j][(l+2)];
            C[(i+2)][j][(l+3)]=C[(i+2)][j][(l+3)]+A[(i+2)][k][(l+3)]*B[k][j][(l+3)];
            C[(i+2)][j][(l+4)]=C[(i+2)][j][(l+4)]+A[(i+2)][k][(l+4)]*B[k][j][(l+4)];
            C[(i+2)][j][(l+5)]=C[(i+2)][j][(l+5)]+A[(i+2)][k][(l+5)]*B[k][j][(l+5)];
            C[(i+2)][j][(l+6)]=C[(i+2)][j][(l+6)]+A[(i+2)][k][(l+6)]*B[k][j][(l+6)];
            C[(i+2)][j][(l+7)]=C[(i+2)][j][(l+7)]+A[(i+2)][k][(l+7)]*B[k][j][(l+7)];
            C[(i+2)][j][(l+8)]=C[(i+2)][j][(l+8)]+A[(i+2)][k][(l+8)]*B[k][j][(l+8)];
            C[(i+2)][j][(l+9)]=C[(i+2)][j][(l+9)]+A[(i+2)][k][(l+9)]*B[k][j][(l+9)];
            C[(i+2)][j][(l+10)]=C[(i+2)][j][(l+10)]+A[(i+2)][k][(l+10)]*B[k][j][(l+10)];
            C[(i+2)][j][(l+11)]=C[(i+2)][j][(l+11)]+A[(i+2)][k][(l+11)]*B[k][j][(l+11)];
            C[(i+2)][j][(l+12)]=C[(i+2)][j][(l+12)]+A[(i+2)][k][(l+12)]*B[k][j][(l+12)];
            C[(i+2)][j][(l+13)]=C[(i+2)][j][(l+13)]+A[(i+2)][k][(l+13)]*B[k][j][(l+13)];
            C[(i+2)][j][(l+14)]=C[(i+2)][j][(l+14)]+A[(i+2)][k][(l+14)]*B[k][j][(l+14)];
            C[(i+2)][j][(l+15)]=C[(i+2)][j][(l+15)]+A[(i+2)][k][(l+15)]*B[k][j][(l+15)];
            C[(i+2)][j][(l+16)]=C[(i+2)][j][(l+16)]+A[(i+2)][k][(l+16)]*B[k][j][(l+16)];
            C[(i+2)][j][(l+17)]=C[(i+2)][j][(l+17)]+A[(i+2)][k][(l+17)]*B[k][j][(l+17)];
            C[(i+2)][(j+1)][l]=C[(i+2)][(j+1)][l]+A[(i+2)][k][l]*B[k][(j+1)][l];
            C[(i+2)][(j+1)][(l+1)]=C[(i+2)][(j+1)][(l+1)]+A[(i+2)][k][(l+1)]*B[k][(j+1)][(l+1)];
            C[(i+2)][(j+1)][(l+2)]=C[(i+2)][(j+1)][(l+2)]+A[(i+2)][k][(l+2)]*B[k][(j+1)][(l+2)];
            C[(i+2)][(j+1)][(l+3)]=C[(i+2)][(j+1)][(l+3)]+A[(i+2)][k][(l+3)]*B[k][(j+1)][(l+3)];
            C[(i+2)][(j+1)][(l+4)]=C[(i+2)][(j+1)][(l+4)]+A[(i+2)][k][(l+4)]*B[k][(j+1)][(l+4)];
            C[(i+2)][(j+1)][(l+5)]=C[(i+2)][(j+1)][(l+5)]+A[(i+2)][k][(l+5)]*B[k][(j+1)][(l+5)];
            C[(i+2)][(j+1)][(l+6)]=C[(i+2)][(j+1)][(l+6)]+A[(i+2)][k][(l+6)]*B[k][(j+1)][(l+6)];
            C[(i+2)][(j+1)][(l+7)]=C[(i+2)][(j+1)][(l+7)]+A[(i+2)][k][(l+7)]*B[k][(j+1)][(l+7)];
            C[(i+2)][(j+1)][(l+8)]=C[(i+2)][(j+1)][(l+8)]+A[(i+2)][k][(l+8)]*B[k][(j+1)][(l+8)];
            C[(i+2)][(j+1)][(l+9)]=C[(i+2)][(j+1)][(l+9)]+A[(i+2)][k][(l+9)]*B[k][(j+1)][(l+9)];
            C[(i+2)][(j+1)][(l+10)]=C[(i+2)][(j+1)][(l+10)]+A[(i+2)][k][(l+10)]*B[k][(j+1)][(l+10)];
            C[(i+2)][(j+1)][(l+11)]=C[(i+2)][(j+1)][(l+11)]+A[(i+2)][k][(l+11)]*B[k][(j+1)][(l+11)];
            C[(i+2)][(j+1)][(l+12)]=C[(i+2)][(j+1)][(l+12)]+A[(i+2)][k][(l+12)]*B[k][(j+1)][(l+12)];
            C[(i+2)][(j+1)][(l+13)]=C[(i+2)][(j+1)][(l+13)]+A[(i+2)][k][(l+13)]*B[k][(j+1)][(l+13)];
            C[(i+2)][(j+1)][(l+14)]=C[(i+2)][(j+1)][(l+14)]+A[(i+2)][k][(l+14)]*B[k][(j+1)][(l+14)];
            C[(i+2)][(j+1)][(l+15)]=C[(i+2)][(j+1)][(l+15)]+A[(i+2)][k][(l+15)]*B[k][(j+1)][(l+15)];
            C[(i+2)][(j+1)][(l+16)]=C[(i+2)][(j+1)][(l+16)]+A[(i+2)][k][(l+16)]*B[k][(j+1)][(l+16)];
            C[(i+2)][(j+1)][(l+17)]=C[(i+2)][(j+1)][(l+17)]+A[(i+2)][k][(l+17)]*B[k][(j+1)][(l+17)];
          }
          for (l=(min(num_mats-1,ll+2047))-(((min(num_mats-1,ll+2047))-(ll)+1)%18)+1; l<=min(num_mats-1,ll+2047); l=l+1) {
            C[i][j][l]=C[i][j][l]+A[i][k][l]*B[k][j][l];
            C[i][(j+1)][l]=C[i][(j+1)][l]+A[i][k][l]*B[k][(j+1)][l];
            C[(i+1)][j][l]=C[(i+1)][j][l]+A[(i+1)][k][l]*B[k][j][l];
            C[(i+1)][(j+1)][l]=C[(i+1)][(j+1)][l]+A[(i+1)][k][l]*B[k][(j+1)][l];
            C[(i+2)][j][l]=C[(i+2)][j][l]+A[(i+2)][k][l]*B[k][j][l];
            C[(i+2)][(j+1)][l]=C[(i+2)][(j+1)][l]+A[(i+2)][k][l]*B[k][(j+1)][l];
          }
        }
      }
    }
    for (j=cols_b-((cols_b-(0))%2); j<=cols_b-1; j=j+1) {
      for (ll=0; ll<=num_mats-1; ll=ll+2048) {
        int l;
        for (l=ll; l<=min(num_mats-1,ll+2047)-17; l=l+18) {
          C[i][j][l]=0;
          C[i][j][(l+1)]=0;
          C[i][j][(l+2)]=0;
          C[i][j][(l+3)]=0;
          C[i][j][(l+4)]=0;
          C[i][j][(l+5)]=0;
          C[i][j][(l+6)]=0;
          C[i][j][(l+7)]=0;
          C[i][j][(l+8)]=0;
          C[i][j][(l+9)]=0;
          C[i][j][(l+10)]=0;
          C[i][j][(l+11)]=0;
          C[i][j][(l+12)]=0;
          C[i][j][(l+13)]=0;
          C[i][j][(l+14)]=0;
          C[i][j][(l+15)]=0;
          C[i][j][(l+16)]=0;
          C[i][j][(l+17)]=0;
          C[(i+1)][j][l]=0;
          C[(i+1)][j][(l+1)]=0;
          C[(i+1)][j][(l+2)]=0;
          C[(i+1)][j][(l+3)]=0;
          C[(i+1)][j][(l+4)]=0;
          C[(i+1)][j][(l+5)]=0;
          C[(i+1)][j][(l+6)]=0;
          C[(i+1)][j][(l+7)]=0;
          C[(i+1)][j][(l+8)]=0;
          C[(i+1)][j][(l+9)]=0;
          C[(i+1)][j][(l+10)]=0;
          C[(i+1)][j][(l+11)]=0;
          C[(i+1)][j][(l+12)]=0;
          C[(i+1)][j][(l+13)]=0;
          C[(i+1)][j][(l+14)]=0;
          C[(i+1)][j][(l+15)]=0;
          C[(i+1)][j][(l+16)]=0;
          C[(i+1)][j][(l+17)]=0;
          C[(i+2)][j][l]=0;
          C[(i+2)][j][(l+1)]=0;
          C[(i+2)][j][(l+2)]=0;
          C[(i+2)][j][(l+3)]=0;
          C[(i+2)][j][(l+4)]=0;
          C[(i+2)][j][(l+5)]=0;
          C[(i+2)][j][(l+6)]=0;
          C[(i+2)][j][(l+7)]=0;
          C[(i+2)][j][(l+8)]=0;
          C[(i+2)][j][(l+9)]=0;
          C[(i+2)][j][(l+10)]=0;
          C[(i+2)][j][(l+11)]=0;
          C[(i+2)][j][(l+12)]=0;
          C[(i+2)][j][(l+13)]=0;
          C[(i+2)][j][(l+14)]=0;
          C[(i+2)][j][(l+15)]=0;
          C[(i+2)][j][(l+16)]=0;
          C[(i+2)][j][(l+17)]=0;
        }
        for (l=(min(num_mats-1,ll+2047))-(((min(num_mats-1,ll+2047))-(ll)+1)%18)+1; l<=min(num_mats-1,ll+2047); l=l+1) {
          C[i][j][l]=0;
          C[(i+1)][j][l]=0;
          C[(i+2)][j][l]=0;
        }
      }
      for (k=0; k<=cols_a-1; k++ ) {
        /*#pragma ivdep*/
        /*#pragma ivdep*/
        /*#pragma ivdep*/
        for (ll=0; ll<=num_mats-1; ll=ll+2048) {
          int l;
          for (l=ll; l<=min(num_mats-1,ll+2047)-17; l=l+18) {
            C[i][j][l]=C[i][j][l]+A[i][k][l]*B[k][j][l];
            C[i][j][(l+1)]=C[i][j][(l+1)]+A[i][k][(l+1)]*B[k][j][(l+1)];
            C[i][j][(l+2)]=C[i][j][(l+2)]+A[i][k][(l+2)]*B[k][j][(l+2)];
            C[i][j][(l+3)]=C[i][j][(l+3)]+A[i][k][(l+3)]*B[k][j][(l+3)];
            C[i][j][(l+4)]=C[i][j][(l+4)]+A[i][k][(l+4)]*B[k][j][(l+4)];
            C[i][j][(l+5)]=C[i][j][(l+5)]+A[i][k][(l+5)]*B[k][j][(l+5)];
            C[i][j][(l+6)]=C[i][j][(l+6)]+A[i][k][(l+6)]*B[k][j][(l+6)];
            C[i][j][(l+7)]=C[i][j][(l+7)]+A[i][k][(l+7)]*B[k][j][(l+7)];
            C[i][j][(l+8)]=C[i][j][(l+8)]+A[i][k][(l+8)]*B[k][j][(l+8)];
            C[i][j][(l+9)]=C[i][j][(l+9)]+A[i][k][(l+9)]*B[k][j][(l+9)];
            C[i][j][(l+10)]=C[i][j][(l+10)]+A[i][k][(l+10)]*B[k][j][(l+10)];
            C[i][j][(l+11)]=C[i][j][(l+11)]+A[i][k][(l+11)]*B[k][j][(l+11)];
            C[i][j][(l+12)]=C[i][j][(l+12)]+A[i][k][(l+12)]*B[k][j][(l+12)];
            C[i][j][(l+13)]=C[i][j][(l+13)]+A[i][k][(l+13)]*B[k][j][(l+13)];
            C[i][j][(l+14)]=C[i][j][(l+14)]+A[i][k][(l+14)]*B[k][j][(l+14)];
            C[i][j][(l+15)]=C[i][j][(l+15)]+A[i][k][(l+15)]*B[k][j][(l+15)];
            C[i][j][(l+16)]=C[i][j][(l+16)]+A[i][k][(l+16)]*B[k][j][(l+16)];
            C[i][j][(l+17)]=C[i][j][(l+17)]+A[i][k][(l+17)]*B[k][j][(l+17)];
            C[(i+1)][j][l]=C[(i+1)][j][l]+A[(i+1)][k][l]*B[k][j][l];
            C[(i+1)][j][(l+1)]=C[(i+1)][j][(l+1)]+A[(i+1)][k][(l+1)]*B[k][j][(l+1)];
            C[(i+1)][j][(l+2)]=C[(i+1)][j][(l+2)]+A[(i+1)][k][(l+2)]*B[k][j][(l+2)];
            C[(i+1)][j][(l+3)]=C[(i+1)][j][(l+3)]+A[(i+1)][k][(l+3)]*B[k][j][(l+3)];
            C[(i+1)][j][(l+4)]=C[(i+1)][j][(l+4)]+A[(i+1)][k][(l+4)]*B[k][j][(l+4)];
            C[(i+1)][j][(l+5)]=C[(i+1)][j][(l+5)]+A[(i+1)][k][(l+5)]*B[k][j][(l+5)];
            C[(i+1)][j][(l+6)]=C[(i+1)][j][(l+6)]+A[(i+1)][k][(l+6)]*B[k][j][(l+6)];
            C[(i+1)][j][(l+7)]=C[(i+1)][j][(l+7)]+A[(i+1)][k][(l+7)]*B[k][j][(l+7)];
            C[(i+1)][j][(l+8)]=C[(i+1)][j][(l+8)]+A[(i+1)][k][(l+8)]*B[k][j][(l+8)];
            C[(i+1)][j][(l+9)]=C[(i+1)][j][(l+9)]+A[(i+1)][k][(l+9)]*B[k][j][(l+9)];
            C[(i+1)][j][(l+10)]=C[(i+1)][j][(l+10)]+A[(i+1)][k][(l+10)]*B[k][j][(l+10)];
            C[(i+1)][j][(l+11)]=C[(i+1)][j][(l+11)]+A[(i+1)][k][(l+11)]*B[k][j][(l+11)];
            C[(i+1)][j][(l+12)]=C[(i+1)][j][(l+12)]+A[(i+1)][k][(l+12)]*B[k][j][(l+12)];
            C[(i+1)][j][(l+13)]=C[(i+1)][j][(l+13)]+A[(i+1)][k][(l+13)]*B[k][j][(l+13)];
            C[(i+1)][j][(l+14)]=C[(i+1)][j][(l+14)]+A[(i+1)][k][(l+14)]*B[k][j][(l+14)];
            C[(i+1)][j][(l+15)]=C[(i+1)][j][(l+15)]+A[(i+1)][k][(l+15)]*B[k][j][(l+15)];
            C[(i+1)][j][(l+16)]=C[(i+1)][j][(l+16)]+A[(i+1)][k][(l+16)]*B[k][j][(l+16)];
            C[(i+1)][j][(l+17)]=C[(i+1)][j][(l+17)]+A[(i+1)][k][(l+17)]*B[k][j][(l+17)];
            C[(i+2)][j][l]=C[(i+2)][j][l]+A[(i+2)][k][l]*B[k][j][l];
            C[(i+2)][j][(l+1)]=C[(i+2)][j][(l+1)]+A[(i+2)][k][(l+1)]*B[k][j][(l+1)];
            C[(i+2)][j][(l+2)]=C[(i+2)][j][(l+2)]+A[(i+2)][k][(l+2)]*B[k][j][(l+2)];
            C[(i+2)][j][(l+3)]=C[(i+2)][j][(l+3)]+A[(i+2)][k][(l+3)]*B[k][j][(l+3)];
            C[(i+2)][j][(l+4)]=C[(i+2)][j][(l+4)]+A[(i+2)][k][(l+4)]*B[k][j][(l+4)];
            C[(i+2)][j][(l+5)]=C[(i+2)][j][(l+5)]+A[(i+2)][k][(l+5)]*B[k][j][(l+5)];
            C[(i+2)][j][(l+6)]=C[(i+2)][j][(l+6)]+A[(i+2)][k][(l+6)]*B[k][j][(l+6)];
            C[(i+2)][j][(l+7)]=C[(i+2)][j][(l+7)]+A[(i+2)][k][(l+7)]*B[k][j][(l+7)];
            C[(i+2)][j][(l+8)]=C[(i+2)][j][(l+8)]+A[(i+2)][k][(l+8)]*B[k][j][(l+8)];
            C[(i+2)][j][(l+9)]=C[(i+2)][j][(l+9)]+A[(i+2)][k][(l+9)]*B[k][j][(l+9)];
            C[(i+2)][j][(l+10)]=C[(i+2)][j][(l+10)]+A[(i+2)][k][(l+10)]*B[k][j][(l+10)];
            C[(i+2)][j][(l+11)]=C[(i+2)][j][(l+11)]+A[(i+2)][k][(l+11)]*B[k][j][(l+11)];
            C[(i+2)][j][(l+12)]=C[(i+2)][j][(l+12)]+A[(i+2)][k][(l+12)]*B[k][j][(l+12)];
            C[(i+2)][j][(l+13)]=C[(i+2)][j][(l+13)]+A[(i+2)][k][(l+13)]*B[k][j][(l+13)];
            C[(i+2)][j][(l+14)]=C[(i+2)][j][(l+14)]+A[(i+2)][k][(l+14)]*B[k][j][(l+14)];
            C[(i+2)][j][(l+15)]=C[(i+2)][j][(l+15)]+A[(i+2)][k][(l+15)]*B[k][j][(l+15)];
            C[(i+2)][j][(l+16)]=C[(i+2)][j][(l+16)]+A[(i+2)][k][(l+16)]*B[k][j][(l+16)];
            C[(i+2)][j][(l+17)]=C[(i+2)][j][(l+17)]+A[(i+2)][k][(l+17)]*B[k][j][(l+17)];
          }
          for (l=(min(num_mats-1,ll+2047))-(((min(num_mats-1,ll+2047))-(ll)+1)%18)+1; l<=min(num_mats-1,ll+2047); l=l+1) {
            C[i][j][l]=C[i][j][l]+A[i][k][l]*B[k][j][l];
            C[(i+1)][j][l]=C[(i+1)][j][l]+A[(i+1)][k][l]*B[k][j][l];
            C[(i+2)][j][l]=C[(i+2)][j][l]+A[(i+2)][k][l]*B[k][j][l];
          }
        }
      }
    }
  }
  for (i=rows_a-((rows_a-(0))%3); i<=rows_a-1; i=i+1) {
    int j;
    for (j=0; j<=cols_b-2; j=j+2) {
      for (ll=0; ll<=num_mats-1; ll=ll+2048) {
        int l;
        for (l=ll; l<=min(num_mats-1,ll+2047)-17; l=l+18) {
          C[i][j][l]=0;
          C[i][j][(l+1)]=0;
          C[i][j][(l+2)]=0;
          C[i][j][(l+3)]=0;
          C[i][j][(l+4)]=0;
          C[i][j][(l+5)]=0;
          C[i][j][(l+6)]=0;
          C[i][j][(l+7)]=0;
          C[i][j][(l+8)]=0;
          C[i][j][(l+9)]=0;
          C[i][j][(l+10)]=0;
          C[i][j][(l+11)]=0;
          C[i][j][(l+12)]=0;
          C[i][j][(l+13)]=0;
          C[i][j][(l+14)]=0;
          C[i][j][(l+15)]=0;
          C[i][j][(l+16)]=0;
          C[i][j][(l+17)]=0;
          C[i][(j+1)][l]=0;
          C[i][(j+1)][(l+1)]=0;
          C[i][(j+1)][(l+2)]=0;
          C[i][(j+1)][(l+3)]=0;
          C[i][(j+1)][(l+4)]=0;
          C[i][(j+1)][(l+5)]=0;
          C[i][(j+1)][(l+6)]=0;
          C[i][(j+1)][(l+7)]=0;
          C[i][(j+1)][(l+8)]=0;
          C[i][(j+1)][(l+9)]=0;
          C[i][(j+1)][(l+10)]=0;
          C[i][(j+1)][(l+11)]=0;
          C[i][(j+1)][(l+12)]=0;
          C[i][(j+1)][(l+13)]=0;
          C[i][(j+1)][(l+14)]=0;
          C[i][(j+1)][(l+15)]=0;
          C[i][(j+1)][(l+16)]=0;
          C[i][(j+1)][(l+17)]=0;
        }
        for (l=(min(num_mats-1,ll+2047))-(((min(num_mats-1,ll+2047))-(ll)+1)%18)+1; l<=min(num_mats-1,ll+2047); l=l+1) {
          C[i][j][l]=0;
          C[i][(j+1)][l]=0;
        }
      }
      for (k=0; k<=cols_a-1; k++ ) {
        /*#pragma ivdep*/
        /*#pragma ivdep*/
        for (ll=0; ll<=num_mats-1; ll=ll+2048) {
          int l;
          for (l=ll; l<=min(num_mats-1,ll+2047)-17; l=l+18) {
            C[i][j][l]=C[i][j][l]+A[i][k][l]*B[k][j][l];
            C[i][j][(l+1)]=C[i][j][(l+1)]+A[i][k][(l+1)]*B[k][j][(l+1)];
            C[i][j][(l+2)]=C[i][j][(l+2)]+A[i][k][(l+2)]*B[k][j][(l+2)];
            C[i][j][(l+3)]=C[i][j][(l+3)]+A[i][k][(l+3)]*B[k][j][(l+3)];
            C[i][j][(l+4)]=C[i][j][(l+4)]+A[i][k][(l+4)]*B[k][j][(l+4)];
            C[i][j][(l+5)]=C[i][j][(l+5)]+A[i][k][(l+5)]*B[k][j][(l+5)];
            C[i][j][(l+6)]=C[i][j][(l+6)]+A[i][k][(l+6)]*B[k][j][(l+6)];
            C[i][j][(l+7)]=C[i][j][(l+7)]+A[i][k][(l+7)]*B[k][j][(l+7)];
            C[i][j][(l+8)]=C[i][j][(l+8)]+A[i][k][(l+8)]*B[k][j][(l+8)];
            C[i][j][(l+9)]=C[i][j][(l+9)]+A[i][k][(l+9)]*B[k][j][(l+9)];
            C[i][j][(l+10)]=C[i][j][(l+10)]+A[i][k][(l+10)]*B[k][j][(l+10)];
            C[i][j][(l+11)]=C[i][j][(l+11)]+A[i][k][(l+11)]*B[k][j][(l+11)];
            C[i][j][(l+12)]=C[i][j][(l+12)]+A[i][k][(l+12)]*B[k][j][(l+12)];
            C[i][j][(l+13)]=C[i][j][(l+13)]+A[i][k][(l+13)]*B[k][j][(l+13)];
            C[i][j][(l+14)]=C[i][j][(l+14)]+A[i][k][(l+14)]*B[k][j][(l+14)];
            C[i][j][(l+15)]=C[i][j][(l+15)]+A[i][k][(l+15)]*B[k][j][(l+15)];
            C[i][j][(l+16)]=C[i][j][(l+16)]+A[i][k][(l+16)]*B[k][j][(l+16)];
            C[i][j][(l+17)]=C[i][j][(l+17)]+A[i][k][(l+17)]*B[k][j][(l+17)];
            C[i][(j+1)][l]=C[i][(j+1)][l]+A[i][k][l]*B[k][(j+1)][l];
            C[i][(j+1)][(l+1)]=C[i][(j+1)][(l+1)]+A[i][k][(l+1)]*B[k][(j+1)][(l+1)];
            C[i][(j+1)][(l+2)]=C[i][(j+1)][(l+2)]+A[i][k][(l+2)]*B[k][(j+1)][(l+2)];
            C[i][(j+1)][(l+3)]=C[i][(j+1)][(l+3)]+A[i][k][(l+3)]*B[k][(j+1)][(l+3)];
            C[i][(j+1)][(l+4)]=C[i][(j+1)][(l+4)]+A[i][k][(l+4)]*B[k][(j+1)][(l+4)];
            C[i][(j+1)][(l+5)]=C[i][(j+1)][(l+5)]+A[i][k][(l+5)]*B[k][(j+1)][(l+5)];
            C[i][(j+1)][(l+6)]=C[i][(j+1)][(l+6)]+A[i][k][(l+6)]*B[k][(j+1)][(l+6)];
            C[i][(j+1)][(l+7)]=C[i][(j+1)][(l+7)]+A[i][k][(l+7)]*B[k][(j+1)][(l+7)];
            C[i][(j+1)][(l+8)]=C[i][(j+1)][(l+8)]+A[i][k][(l+8)]*B[k][(j+1)][(l+8)];
            C[i][(j+1)][(l+9)]=C[i][(j+1)][(l+9)]+A[i][k][(l+9)]*B[k][(j+1)][(l+9)];
            C[i][(j+1)][(l+10)]=C[i][(j+1)][(l+10)]+A[i][k][(l+10)]*B[k][(j+1)][(l+10)];
            C[i][(j+1)][(l+11)]=C[i][(j+1)][(l+11)]+A[i][k][(l+11)]*B[k][(j+1)][(l+11)];
            C[i][(j+1)][(l+12)]=C[i][(j+1)][(l+12)]+A[i][k][(l+12)]*B[k][(j+1)][(l+12)];
            C[i][(j+1)][(l+13)]=C[i][(j+1)][(l+13)]+A[i][k][(l+13)]*B[k][(j+1)][(l+13)];
            C[i][(j+1)][(l+14)]=C[i][(j+1)][(l+14)]+A[i][k][(l+14)]*B[k][(j+1)][(l+14)];
            C[i][(j+1)][(l+15)]=C[i][(j+1)][(l+15)]+A[i][k][(l+15)]*B[k][(j+1)][(l+15)];
            C[i][(j+1)][(l+16)]=C[i][(j+1)][(l+16)]+A[i][k][(l+16)]*B[k][(j+1)][(l+16)];
            C[i][(j+1)][(l+17)]=C[i][(j+1)][(l+17)]+A[i][k][(l+17)]*B[k][(j+1)][(l+17)];
          }
          for (l=(min(num_mats-1,ll+2047))-(((min(num_mats-1,ll+2047))-(ll)+1)%18)+1; l<=min(num_mats-1,ll+2047); l=l+1) {
            C[i][j][l]=C[i][j][l]+A[i][k][l]*B[k][j][l];
            C[i][(j+1)][l]=C[i][(j+1)][l]+A[i][k][l]*B[k][(j+1)][l];
          }
        }
      }
    }
    for (j=cols_b-((cols_b-(0))%2); j<=cols_b-1; j=j+1) {
      for (ll=0; ll<=num_mats-1; ll=ll+2048) {
        int l;
        for (l=ll; l<=min(num_mats-1,ll+2047)-17; l=l+18) {
          C[i][j][l]=0;
          C[i][j][(l+1)]=0;
          C[i][j][(l+2)]=0;
          C[i][j][(l+3)]=0;
          C[i][j][(l+4)]=0;
          C[i][j][(l+5)]=0;
          C[i][j][(l+6)]=0;
          C[i][j][(l+7)]=0;
          C[i][j][(l+8)]=0;
          C[i][j][(l+9)]=0;
          C[i][j][(l+10)]=0;
          C[i][j][(l+11)]=0;
          C[i][j][(l+12)]=0;
          C[i][j][(l+13)]=0;
          C[i][j][(l+14)]=0;
          C[i][j][(l+15)]=0;
          C[i][j][(l+16)]=0;
          C[i][j][(l+17)]=0;
        }
        for (l=(min(num_mats-1,ll+2047))-(((min(num_mats-1,ll+2047))-(ll)+1)%18)+1; l<=min(num_mats-1,ll+2047); l=l+1) 
          C[i][j][l]=0;
      }
      for (k=0; k<=cols_a-1; k++ ) {
        /*#pragma ivdep*/
        for (ll=0; ll<=num_mats-1; ll=ll+2048) {
          int l;
          for (l=ll; l<=min(num_mats-1,ll+2047)-17; l=l+18) {
            C[i][j][l]=C[i][j][l]+A[i][k][l]*B[k][j][l];
            C[i][j][(l+1)]=C[i][j][(l+1)]+A[i][k][(l+1)]*B[k][j][(l+1)];
            C[i][j][(l+2)]=C[i][j][(l+2)]+A[i][k][(l+2)]*B[k][j][(l+2)];
            C[i][j][(l+3)]=C[i][j][(l+3)]+A[i][k][(l+3)]*B[k][j][(l+3)];
            C[i][j][(l+4)]=C[i][j][(l+4)]+A[i][k][(l+4)]*B[k][j][(l+4)];
            C[i][j][(l+5)]=C[i][j][(l+5)]+A[i][k][(l+5)]*B[k][j][(l+5)];
            C[i][j][(l+6)]=C[i][j][(l+6)]+A[i][k][(l+6)]*B[k][j][(l+6)];
            C[i][j][(l+7)]=C[i][j][(l+7)]+A[i][k][(l+7)]*B[k][j][(l+7)];
            C[i][j][(l+8)]=C[i][j][(l+8)]+A[i][k][(l+8)]*B[k][j][(l+8)];
            C[i][j][(l+9)]=C[i][j][(l+9)]+A[i][k][(l+9)]*B[k][j][(l+9)];
            C[i][j][(l+10)]=C[i][j][(l+10)]+A[i][k][(l+10)]*B[k][j][(l+10)];
            C[i][j][(l+11)]=C[i][j][(l+11)]+A[i][k][(l+11)]*B[k][j][(l+11)];
            C[i][j][(l+12)]=C[i][j][(l+12)]+A[i][k][(l+12)]*B[k][j][(l+12)];
            C[i][j][(l+13)]=C[i][j][(l+13)]+A[i][k][(l+13)]*B[k][j][(l+13)];
            C[i][j][(l+14)]=C[i][j][(l+14)]+A[i][k][(l+14)]*B[k][j][(l+14)];
            C[i][j][(l+15)]=C[i][j][(l+15)]+A[i][k][(l+15)]*B[k][j][(l+15)];
            C[i][j][(l+16)]=C[i][j][(l+16)]+A[i][k][(l+16)]*B[k][j][(l+16)];
            C[i][j][(l+17)]=C[i][j][(l+17)]+A[i][k][(l+17)]*B[k][j][(l+17)];
          }
          for (l=(min(num_mats-1,ll+2047))-(((min(num_mats-1,ll+2047))-(ll)+1)%18)+1; l<=min(num_mats-1,ll+2047); l=l+1) 
            C[i][j][l]=C[i][j][l]+A[i][k][l]*B[k][j][l];
        }
      }
    }
  }
}
/*@ end @*/
/*@ end @*/
} 